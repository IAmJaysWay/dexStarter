!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react"),require("proxy-compare"),require("use-sync-external-store/shim"),require("valtio/vanilla")):"function"==typeof define&&define.amd?define(["exports","react","proxy-compare","use-sync-external-store/shim","valtio/vanilla"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self).valtio={},e.React,e.proxyCompare,e.useSyncExternalStoreExports,e.valtioVanilla)}(this,(function(e,r,n,t,a){"use strict";var u=r.use,o=t.useSyncExternalStore;e.useSnapshot=function(e,t){var s=null==t?void 0:t.sync,i=r.useRef(),c=r.useRef(),f=!0,l=o(r.useCallback((function(r){var n=a.subscribe(e,r,s);return r(),n}),[e,s]),(function(){var r=a.snapshot(e,u);try{if(!f&&i.current&&c.current&&!n.isChanged(i.current,r,c.current,new WeakMap))return i.current}catch(e){}return r}),(function(){return a.snapshot(e,u)}));f=!1;var p=new WeakMap;r.useEffect((function(){i.current=l,c.current=p}));var y=r.useMemo((function(){return new WeakMap}),[]);return n.createProxy(l,p,y)}}));
