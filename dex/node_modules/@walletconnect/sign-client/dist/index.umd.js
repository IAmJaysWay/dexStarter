(function(Te,tt){typeof exports=="object"&&typeof module<"u"?tt(exports):typeof define=="function"&&define.amd?define(["exports"],tt):(Te=typeof globalThis<"u"?globalThis:Te||self,tt(Te["@walletconnect/sign-client"]={}))})(this,function(Te){"use strict";var tt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}function Yc(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var kc=Xc;function Xc(t,e,r){var n=r&&r.stringify||Yc,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var o=new Array(s);o[0]=n(t);for(var a=1;a<s;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof t!="string")return t;var f=e.length;if(f===0)return t;for(var h="",l=1-i,w=-1,_=t&&t.length||0,v=0;v<_;){if(t.charCodeAt(v)===37&&v+1<_){switch(w=w>-1?w:0,t.charCodeAt(v+1)){case 100:case 102:if(l>=f||e[l]==null)break;w<v&&(h+=t.slice(w,v)),h+=Number(e[l]),w=v+2,v++;break;case 105:if(l>=f||e[l]==null)break;w<v&&(h+=t.slice(w,v)),h+=Math.floor(Number(e[l])),w=v+2,v++;break;case 79:case 111:case 106:if(l>=f||e[l]===void 0)break;w<v&&(h+=t.slice(w,v));var S=typeof e[l];if(S==="string"){h+="'"+e[l]+"'",w=v+2,v++;break}if(S==="function"){h+=e[l].name||"<anonymous>",w=v+2,v++;break}h+=n(e[l]),w=v+2,v++;break;case 115:if(l>=f)break;w<v&&(h+=t.slice(w,v)),h+=String(e[l]),w=v+2,v++;break;case 37:w<v&&(h+=t.slice(w,v)),h+="%",w=v+2,v++,l--;break}++l}++v}return w===-1?t:(w<_&&(h+=t.slice(w)),h)}const es=kc;var Wr=Ot;const vr=ou().console||{},Jc={mapHttpRequest:kr,mapHttpResponse:kr,wrapRequestSerializer:Un,wrapResponseSerializer:Un,wrapErrorSerializer:Un,req:kr,res:kr,err:ru};function Zc(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Ot(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||vr;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=Zc(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",f=Object.create(r);f.log||(f.log=br),Object.defineProperty(f,"levelVal",{get:l}),Object.defineProperty(f,"level",{get:w,set:_});const h={transmit:e,serialize:i,asObject:t.browser.asObject,levels:o,timestamp:nu(t)};f.levels=Ot.levels,f.level=a,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=br,f.serializers=n,f._serialize=i,f._stdErrSerialize=s,f.child=v,e&&(f._logEvent=$n());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function _(S){if(S!=="silent"&&!this.levels.values[S])throw Error("unknown level "+S);this._level=S,or(h,f,"error","log"),or(h,f,"fatal","error"),or(h,f,"warn","error"),or(h,f,"info","log"),or(h,f,"debug","log"),or(h,f,"trace","log")}function v(S,R){if(!S)throw new Error("missing bindings for child Pino");R=R||{},i&&S.serializers&&(R.serializers=S.serializers);const A=R.serializers;if(i&&A){var U=Object.assign({},n,A),E=t.browser.serialize===!0?Object.keys(U):i;delete S.serializers,Yr([S],E,U,this._stdErrSerialize)}function O(g){this._childLevel=(g._childLevel|0)+1,this.error=ar(g,S,"error"),this.fatal=ar(g,S,"fatal"),this.warn=ar(g,S,"warn"),this.info=ar(g,S,"info"),this.debug=ar(g,S,"debug"),this.trace=ar(g,S,"trace"),U&&(this.serializers=U,this._serialize=E),e&&(this._logEvent=$n([].concat(g._logEvent.bindings,S)))}return O.prototype=this,new O(this)}return f}Ot.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Ot.stdSerializers=Jc,Ot.stdTimeFunctions=Object.assign({},{nullTime:ts,epochTime:rs,unixTime:iu,isoTime:su});function or(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?br:i[r]?i[r]:vr[r]||vr[n]||br,Qc(t,e,r)}function Qc(t,e,r){!t.transmit&&e[r]===br||(e[r]=function(n){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===vr?vr:this;for(var f=0;f<o.length;f++)o[f]=arguments[f];if(t.serialize&&!t.asObject&&Yr(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(a,eu(this,r,o,s)):n.apply(a,o),t.transmit){const h=t.transmit.level||e.level,l=Ot.levels.values[h],w=Ot.levels.values[r];if(w<l)return;tu(this,{ts:s,methodLevel:r,methodValue:w,transmitLevel:h,transmitValue:Ot.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function eu(t,e,r,n){t._serialize&&Yr(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const o={};n&&(o.time=n),o.level=Ot.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof i[0]=="object";)Object.assign(o,i.shift());s=i.length?es(i.shift(),i):void 0}else typeof s=="string"&&(s=es(i.shift(),i));return s!==void 0&&(o.msg=s),o}function Yr(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=Ot.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function ar(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function tu(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,f=t._logEvent.bindings;Yr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(h){return f.indexOf(h)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,n(s,t._logEvent,a),t._logEvent=$n(f)}function $n(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function ru(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function nu(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?ts:rs}function kr(){return{}}function Un(t){return t}function br(){}function ts(){return!1}function rs(){return Date.now()}function iu(){return Math.round(Date.now()/1e3)}function su(){return new Date(Date.now()).toISOString()}function ou(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var Ct={exports:{}},cr=typeof Reflect=="object"?Reflect:null,ns=cr&&typeof cr.apply=="function"?cr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Xr;cr&&typeof cr.ownKeys=="function"?Xr=cr.ownKeys:Object.getOwnPropertySymbols?Xr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Xr=function(e){return Object.getOwnPropertyNames(e)};function au(t){console&&console.warn&&console.warn(t)}var is=Number.isNaN||function(e){return e!==e};function De(){De.init.call(this)}Ct.exports=De,Ct.exports.once=hu,De.EventEmitter=De,De.prototype._events=void 0,De.prototype._eventsCount=0,De.prototype._maxListeners=void 0;var ss=10;function Jr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(De,"defaultMaxListeners",{enumerable:!0,get:function(){return ss},set:function(t){if(typeof t!="number"||t<0||is(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ss=t}}),De.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},De.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||is(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function os(t){return t._maxListeners===void 0?De.defaultMaxListeners:t._maxListeners}De.prototype.getMaxListeners=function(){return os(this)},De.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")ns(f,this,r);else for(var h=f.length,l=hs(f,h),n=0;n<h;++n)ns(l[n],this,r);return!0};function as(t,e,r,n){var i,s,o;if(Jr(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=os(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,au(a)}return t}De.prototype.addListener=function(e,r){return as(this,e,r,!1)},De.prototype.on=De.prototype.addListener,De.prototype.prependListener=function(e,r){return as(this,e,r,!0)};function cu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function cs(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=cu.bind(n);return i.listener=r,n.wrapFn=i,i}De.prototype.once=function(e,r){return Jr(r),this.on(e,cs(this,e,r)),this},De.prototype.prependOnceListener=function(e,r){return Jr(r),this.prependListener(e,cs(this,e,r)),this},De.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Jr(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():uu(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},De.prototype.off=De.prototype.removeListener,De.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function us(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?fu(i):hs(i,i.length)}De.prototype.listeners=function(e){return us(this,e,!0)},De.prototype.rawListeners=function(e){return us(this,e,!1)},De.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):fs.call(t,e)},De.prototype.listenerCount=fs;function fs(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}De.prototype.eventNames=function(){return this._eventsCount>0?Xr(this._events):[]};function hs(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function uu(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function fu(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function hu(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}ls(t,e,s,{once:!0}),e!=="error"&&lu(t,i,{once:!0})})}function lu(t,e,r){typeof t.on=="function"&&ls(t,"error",e,r)}function ls(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Zr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Mn=function(t,e){return Mn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Mn(t,e)};function du(t,e){Mn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var jn=function(){return jn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},jn.apply(this,arguments)};function pu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function gu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function _u(t,e){return function(r,n){e(r,n,t)}}function yu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function vu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(w){o(w)}}function f(l){try{h(n.throw(l))}catch(w){o(w)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function bu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function wu(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function mu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function zn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ds(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Eu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ds(arguments[e]));return t}function Su(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function wr(t){return this instanceof wr?(this.v=t,this):new wr(t)}function Du(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(_){n[_]&&(i[_]=function(v){return new Promise(function(S,R){s.push([_,v,S,R])>1||a(_,v)})})}function a(_,v){try{f(n[_](v))}catch(S){w(s[0][3],S)}}function f(_){_.value instanceof wr?Promise.resolve(_.value.v).then(h,l):w(s[0][2],_)}function h(_){a("next",_)}function l(_){a("throw",_)}function w(_,v){_(v),s.shift(),s.length&&a(s[0][0],s[0][1])}}function xu(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:wr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Ou(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof zn=="function"?zn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function Iu(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Lu(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Nu(t){return t&&t.__esModule?t:{default:t}}function Tu(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Au(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Ru=Object.freeze({__proto__:null,__extends:du,get __assign(){return jn},__rest:pu,__decorate:gu,__param:_u,__metadata:yu,__awaiter:vu,__generator:bu,__createBinding:wu,__exportStar:mu,__values:zn,__read:ds,__spread:Eu,__spreadArrays:Su,__await:wr,__asyncGenerator:Du,__asyncDelegator:xu,__asyncValues:Ou,__makeTemplateObject:Iu,__importStar:Lu,__importDefault:Nu,__classPrivateFieldGet:Tu,__classPrivateFieldSet:Au}),ps=Wt(Ru),mr={};Object.defineProperty(mr,"__esModule",{value:!0});function Cu(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}mr.safeJsonParse=Cu;function Pu(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}mr.safeJsonStringify=Pu;var Er={exports:{}},gs;function Fu(){return gs||(gs=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof tt<"u"&&tt.localStorage?Er.exports=tt.localStorage:typeof window<"u"&&window.localStorage?Er.exports=window.localStorage:Er.exports=new e}()),Er.exports}var Bn={},Sr={},_s;function $u(){if(_s)return Sr;_s=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.IKeyValueStorage=void 0;class t{}return Sr.IKeyValueStorage=t,Sr}var Dr={},ys;function Uu(){if(ys)return Dr;ys=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.parseEntry=void 0;const t=mr;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return Dr.parseEntry=e,Dr}var vs;function Mu(){return vs||(vs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ps;e.__exportStar($u(),t),e.__exportStar(Uu(),t)}(Bn)),Bn}Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.KeyValueStorage=void 0;const ur=ps,bs=mr,ju=ur.__importDefault(Fu()),zu=Mu();class ws{constructor(){this.localStorage=ju.default}getKeys(){return ur.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return ur.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(zu.parseEntry)})}getItem(e){return ur.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return bs.safeJsonParse(r)})}setItem(e,r){return ur.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,bs.safeJsonStringify(r))})}removeItem(e){return ur.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}Zr.KeyValueStorage=ws;var Bu=Zr.default=ws,xr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Kn=function(t,e){return Kn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Kn(t,e)};function Ku(t,e){Kn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var qn=function(){return qn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},qn.apply(this,arguments)};function qu(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Hu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Vu(t,e){return function(r,n){e(r,n,t)}}function Gu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Wu(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(w){o(w)}}function f(l){try{h(n.throw(l))}catch(w){o(w)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function Yu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function ku(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Xu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Hn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ms(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Ju(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(ms(arguments[e]));return t}function Zu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Or(t){return this instanceof Or?(this.v=t,this):new Or(t)}function Qu(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(_){n[_]&&(i[_]=function(v){return new Promise(function(S,R){s.push([_,v,S,R])>1||a(_,v)})})}function a(_,v){try{f(n[_](v))}catch(S){w(s[0][3],S)}}function f(_){_.value instanceof Or?Promise.resolve(_.value.v).then(h,l):w(s[0][2],_)}function h(_){a("next",_)}function l(_){a("throw",_)}function w(_,v){_(v),s.shift(),s.length&&a(s[0][0],s[0][1])}}function ef(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Or(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function tf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Hn=="function"?Hn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function rf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function nf(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function sf(t){return t&&t.__esModule?t:{default:t}}function of(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function af(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var cf=Object.freeze({__proto__:null,__extends:Ku,get __assign(){return qn},__rest:qu,__decorate:Hu,__param:Vu,__metadata:Gu,__awaiter:Wu,__generator:Yu,__createBinding:ku,__exportStar:Xu,__values:Hn,__read:ms,__spread:Ju,__spreadArrays:Zu,__await:Or,__asyncGenerator:Qu,__asyncDelegator:ef,__asyncValues:tf,__makeTemplateObject:rf,__importStar:nf,__importDefault:sf,__classPrivateFieldGet:of,__classPrivateFieldSet:af}),Qr=Wt(cf),Ir={},Vn,Es;function Ss(){if(Es)return Vn;Es=1;function t(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}Vn=t,t.EventEmitter=t,t.prototype._events=void 0,t.prototype._maxListeners=void 0,t.defaultMaxListeners=10,t.prototype.setMaxListeners=function(s){if(!r(s)||s<0||isNaN(s))throw TypeError("n must be a positive number");return this._maxListeners=s,this},t.prototype.emit=function(s){var o,a,f,h,l,w;if(this._events||(this._events={}),s==="error"&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(o=arguments[1],o instanceof Error)throw o;var _=new Error('Uncaught, unspecified "error" event. ('+o+")");throw _.context=o,_}if(a=this._events[s],i(a))return!1;if(e(a))switch(arguments.length){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:h=Array.prototype.slice.call(arguments,1),a.apply(this,h)}else if(n(a))for(h=Array.prototype.slice.call(arguments,1),w=a.slice(),f=w.length,l=0;l<f;l++)w[l].apply(this,h);return!0},t.prototype.addListener=function(s,o){var a;if(!e(o))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,e(o.listener)?o.listener:o),this._events[s]?n(this._events[s])?this._events[s].push(o):this._events[s]=[this._events[s],o]:this._events[s]=o,n(this._events[s])&&!this._events[s].warned&&(i(this._maxListeners)?a=t.defaultMaxListeners:a=this._maxListeners,a&&a>0&&this._events[s].length>a&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),typeof console.trace=="function"&&console.trace())),this},t.prototype.on=t.prototype.addListener,t.prototype.once=function(s,o){if(!e(o))throw TypeError("listener must be a function");var a=!1;function f(){this.removeListener(s,f),a||(a=!0,o.apply(this,arguments))}return f.listener=o,this.on(s,f),this},t.prototype.removeListener=function(s,o){var a,f,h,l;if(!e(o))throw TypeError("listener must be a function");if(!this._events||!this._events[s])return this;if(a=this._events[s],h=a.length,f=-1,a===o||e(a.listener)&&a.listener===o)delete this._events[s],this._events.removeListener&&this.emit("removeListener",s,o);else if(n(a)){for(l=h;l-- >0;)if(a[l]===o||a[l].listener&&a[l].listener===o){f=l;break}if(f<0)return this;a.length===1?(a.length=0,delete this._events[s]):a.splice(f,1),this._events.removeListener&&this.emit("removeListener",s,o)}return this},t.prototype.removeAllListeners=function(s){var o,a;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[s]&&delete this._events[s],this;if(arguments.length===0){for(o in this._events)o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events={},this}if(a=this._events[s],e(a))this.removeListener(s,a);else if(a)for(;a.length;)this.removeListener(s,a[a.length-1]);return delete this._events[s],this},t.prototype.listeners=function(s){var o;return!this._events||!this._events[s]?o=[]:e(this._events[s])?o=[this._events[s]]:o=this._events[s].slice(),o},t.prototype.listenerCount=function(s){if(this._events){var o=this._events[s];if(e(o))return 1;if(o)return o.length}return 0},t.listenerCount=function(s,o){return s.listenerCount(o)};function e(s){return typeof s=="function"}function r(s){return typeof s=="number"}function n(s){return typeof s=="object"&&s!==null}function i(s){return s===void 0}return Vn}var Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Gn=function(t,e){return Gn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Gn(t,e)};function uf(t,e){Gn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wn=function(){return Wn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Wn.apply(this,arguments)};function ff(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function hf(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function lf(t,e){return function(r,n){e(r,n,t)}}function df(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function pf(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(w){o(w)}}function f(l){try{h(n.throw(l))}catch(w){o(w)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function gf(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function _f(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function yf(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Yn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ds(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function vf(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ds(arguments[e]));return t}function bf(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Lr(t){return this instanceof Lr?(this.v=t,this):new Lr(t)}function wf(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(_){n[_]&&(i[_]=function(v){return new Promise(function(S,R){s.push([_,v,S,R])>1||a(_,v)})})}function a(_,v){try{f(n[_](v))}catch(S){w(s[0][3],S)}}function f(_){_.value instanceof Lr?Promise.resolve(_.value.v).then(h,l):w(s[0][2],_)}function h(_){a("next",_)}function l(_){a("throw",_)}function w(_,v){_(v),s.shift(),s.length&&a(s[0][0],s[0][1])}}function mf(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Lr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Ef(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Yn=="function"?Yn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function Sf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Df(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function xf(t){return t&&t.__esModule?t:{default:t}}function Of(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function If(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Lf=Object.freeze({__proto__:null,__extends:uf,get __assign(){return Wn},__rest:ff,__decorate:hf,__param:lf,__metadata:df,__awaiter:pf,__generator:gf,__createBinding:_f,__exportStar:yf,__values:Yn,__read:Ds,__spread:vf,__spreadArrays:bf,__await:Lr,__asyncGenerator:wf,__asyncDelegator:mf,__asyncValues:Ef,__makeTemplateObject:Sf,__importStar:Df,__importDefault:xf,__classPrivateFieldGet:Of,__classPrivateFieldSet:If}),en=Wt(Lf),kn={},Nr={},xs;function Nf(){if(xs)return Nr;xs=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return Nr.delay=t,Nr}var Yt={},Xn={},kt={},Os;function Tf(){return Os||(Os=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.ONE_THOUSAND=kt.ONE_HUNDRED=void 0,kt.ONE_HUNDRED=100,kt.ONE_THOUSAND=1e3),kt}var Jn={},Is;function Af(){return Is||(Is=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Jn)),Jn}var Ls;function Ns(){return Ls||(Ls=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=en;e.__exportStar(Tf(),t),e.__exportStar(Af(),t)}(Xn)),Xn}var Ts;function Rf(){if(Ts)return Yt;Ts=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.fromMiliseconds=Yt.toMiliseconds=void 0;const t=Ns();function e(n){return n*t.ONE_THOUSAND}Yt.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Yt.fromMiliseconds=r,Yt}var As;function Cf(){return As||(As=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=en;e.__exportStar(Nf(),t),e.__exportStar(Rf(),t)}(kn)),kn}var fr={},Rs;function Pf(){if(Rs)return fr;Rs=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return fr.Watch=t,fr.default=t,fr}var Zn={},Tr={},Cs;function Ff(){if(Cs)return Tr;Cs=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.IWatch=void 0;class t{}return Tr.IWatch=t,Tr}var Ps;function $f(){return Ps||(Ps=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),en.__exportStar(Ff(),t)}(Zn)),Zn}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=en;e.__exportStar(Cf(),t),e.__exportStar(Pf(),t),e.__exportStar($f(),t),e.__exportStar(Ns(),t)})(Z);var Qn={},Ar={};class Xt{}var Uf=Object.freeze({__proto__:null,IEvents:Xt}),Mf=Wt(Uf),Fs;function jf(){if(Fs)return Ar;Fs=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.IHeartBeat=void 0;const t=Mf;class e extends t.IEvents{constructor(n){super()}}return Ar.IHeartBeat=e,Ar}var $s;function Us(){return $s||($s=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Qr.__exportStar(jf(),t)}(Qn)),Qn}var ei={},Jt={},Ms;function zf(){if(Ms)return Jt;Ms=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.HEARTBEAT_EVENTS=Jt.HEARTBEAT_INTERVAL=void 0;const t=Z;return Jt.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Jt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Jt}var js;function zs(){return js||(js=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Qr.__exportStar(zf(),t)}(ei)),ei}var Bs;function Bf(){if(Bs)return Ir;Bs=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.HeartBeat=void 0;const t=Qr,e=Ss(),r=Z,n=Us(),i=zs();class s extends n.IHeartBeat{constructor(a){super(a),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=a?.interval||i.HEARTBEAT_INTERVAL}static init(a){return t.__awaiter(this,void 0,void 0,function*(){const f=new s(a);return yield f.init(),f})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}on(a,f){this.events.on(a,f)}once(a,f){this.events.once(a,f)}off(a,f){this.events.off(a,f)}removeListener(a,f){this.events.removeListener(a,f)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return Ir.HeartBeat=s,Ir}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Qr;e.__exportStar(Bf(),t),e.__exportStar(Us(),t),e.__exportStar(zs(),t)})(xr);var xe={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ti=function(t,e){return ti=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ti(t,e)};function Kf(t,e){ti(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ri=function(){return ri=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ri.apply(this,arguments)};function qf(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Hf(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Vf(t,e){return function(r,n){e(r,n,t)}}function Gf(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Wf(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(w){o(w)}}function f(l){try{h(n.throw(l))}catch(w){o(w)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function Yf(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function kf(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Xf(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ni(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ks(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Jf(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ks(arguments[e]));return t}function Zf(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Rr(t){return this instanceof Rr?(this.v=t,this):new Rr(t)}function Qf(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(_){n[_]&&(i[_]=function(v){return new Promise(function(S,R){s.push([_,v,S,R])>1||a(_,v)})})}function a(_,v){try{f(n[_](v))}catch(S){w(s[0][3],S)}}function f(_){_.value instanceof Rr?Promise.resolve(_.value.v).then(h,l):w(s[0][2],_)}function h(_){a("next",_)}function l(_){a("throw",_)}function w(_,v){_(v),s.shift(),s.length&&a(s[0][0],s[0][1])}}function eh(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Rr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function th(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ni=="function"?ni(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function rh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function nh(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function ih(t){return t&&t.__esModule?t:{default:t}}function sh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function oh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var ah=Object.freeze({__proto__:null,__extends:Kf,get __assign(){return ri},__rest:qf,__decorate:Hf,__param:Vf,__metadata:Gf,__awaiter:Wf,__generator:Yf,__createBinding:kf,__exportStar:Xf,__values:ni,__read:Ks,__spread:Jf,__spreadArrays:Zf,__await:Rr,__asyncGenerator:Qf,__asyncDelegator:eh,__asyncValues:th,__makeTemplateObject:rh,__importStar:nh,__importDefault:ih,__classPrivateFieldGet:sh,__classPrivateFieldSet:oh}),ch=Wt(ah),Zt={},qs;function Hs(){return qs||(qs=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.PINO_CUSTOM_CONTEXT_KEY=Zt.PINO_LOGGER_DEFAULTS=void 0,Zt.PINO_LOGGER_DEFAULTS={level:"info"},Zt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Zt}var ct={},Vs;function uh(){if(Vs)return ct;Vs=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.generateChildLogger=ct.formatChildLoggerContext=ct.getLoggerContext=ct.setBrowserLoggerContext=ct.getBrowserLoggerContext=ct.getDefaultLoggerOptions=void 0;const t=Hs();function e(a){return Object.assign(Object.assign({},a),{level:a?.level||t.PINO_LOGGER_DEFAULTS.level})}ct.getDefaultLoggerOptions=e;function r(a,f=t.PINO_CUSTOM_CONTEXT_KEY){return a[f]||""}ct.getBrowserLoggerContext=r;function n(a,f,h=t.PINO_CUSTOM_CONTEXT_KEY){return a[h]=f,a}ct.setBrowserLoggerContext=n;function i(a,f=t.PINO_CUSTOM_CONTEXT_KEY){let h="";return typeof a.bindings>"u"?h=r(a,f):h=a.bindings().context||"",h}ct.getLoggerContext=i;function s(a,f,h=t.PINO_CUSTOM_CONTEXT_KEY){const l=i(a,h);return l.trim()?`${l}/${f}`:f}ct.formatChildLoggerContext=s;function o(a,f,h=t.PINO_CUSTOM_CONTEXT_KEY){const l=s(a,f,h),w=a.child({context:l});return n(w,l,h)}return ct.generateChildLogger=o,ct}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=ch,r=e.__importDefault(Wr);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Hs(),t),e.__exportStar(uh(),t)})(xe);var Gs={exports:{}},hr=typeof Reflect=="object"?Reflect:null,Ws=hr&&typeof hr.apply=="function"?hr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},tn;hr&&typeof hr.ownKeys=="function"?tn=hr.ownKeys:Object.getOwnPropertySymbols?tn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:tn=function(e){return Object.getOwnPropertyNames(e)};function fh(t){console&&console.warn&&console.warn(t)}var Ys=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}Gs.exports=Oe,Gs.exports.once=ph,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var ks=10;function rn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return ks},set:function(t){if(typeof t!="number"||t<0||Ys(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ks=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Ys(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Xs(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return Xs(this)},Oe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")Ws(f,this,r);else for(var h=f.length,l=to(f,h),n=0;n<h;++n)Ws(l[n],this,r);return!0};function Js(t,e,r,n){var i,s,o;if(rn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Xs(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,fh(a)}return t}Oe.prototype.addListener=function(e,r){return Js(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return Js(this,e,r,!0)};function hh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zs(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=hh.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(e,r){return rn(r),this.on(e,Zs(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return rn(r),this.prependListener(e,Zs(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var n,i,s,o,a;if(rn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():lh(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Qs(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?dh(i):to(i,i.length)}Oe.prototype.listeners=function(e){return Qs(this,e,!0)},Oe.prototype.rawListeners=function(e){return Qs(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):eo.call(t,e)},Oe.prototype.listenerCount=eo;function eo(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?tn(this._events):[]};function to(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function lh(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function dh(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function ph(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}ro(t,e,s,{once:!0}),e!=="error"&&gh(t,i,{once:!0})})}function gh(t,e,r){typeof t.on=="function"&&ro(t,"error",e,r)}function ro(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}class _h extends Xt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class yh extends Xt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class vh{constructor(e,r){this.logger=e,this.core=r}}class bh extends Xt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class wh extends Xt{constructor(e){super()}}class mh{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class Eh extends Xt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Sh extends Xt{constructor(e,r){super(),this.core=e,this.logger=r}}class Dh{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class xh{constructor(e){this.client=e}}function no(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function ii(t){return typeof t=="string"?t:JSON.stringify(t)}var si={},lr={},nn={},sn={};Object.defineProperty(sn,"__esModule",{value:!0}),sn.BrowserRandomSource=void 0;const io=65536;class Oh{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=io)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,io)));return r}}sn.BrowserRandomSource=Oh;function Ih(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var on={},_t={};Object.defineProperty(_t,"__esModule",{value:!0});function Lh(t){for(var e=0;e<t.length;e++)t[e]=0;return t}_t.wipe=Lh;var Nh={},Th=Object.freeze({__proto__:null,default:Nh}),Ah=Wt(Th);Object.defineProperty(on,"__esModule",{value:!0}),on.NodeRandomSource=void 0;const Rh=_t;class Ch{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Ih<"u"){const e=Ah;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Rh.wipe)(r),n}}on.NodeRandomSource=Ch,Object.defineProperty(nn,"__esModule",{value:!0}),nn.SystemRandomSource=void 0;const Ph=sn,Fh=on;class $h{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Ph.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Fh.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}nn.SystemRandomSource=$h;var te={},so={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(a,f){var h=a>>>16&65535,l=a&65535,w=f>>>16&65535,_=f&65535;return l*_+(h*_+l*w<<16>>>0)|0}t.mul=Math.imul||e;function r(a,f){return a+f|0}t.add=r;function n(a,f){return a-f|0}t.sub=n;function i(a,f){return a<<f|a>>>32-f}t.rotl=i;function s(a,f){return a<<32-f|a>>>f}t.rotr=s;function o(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a}t.isInteger=Number.isInteger||o,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(a){return t.isInteger(a)&&a>=-t.MAX_SAFE_INTEGER&&a<=t.MAX_SAFE_INTEGER}})(so),Object.defineProperty(te,"__esModule",{value:!0});var oo=so;function Uh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}te.readInt16BE=Uh;function Mh(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}te.readUint16BE=Mh;function jh(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}te.readInt16LE=jh;function zh(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}te.readUint16LE=zh;function ao(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}te.writeUint16BE=ao,te.writeInt16BE=ao;function co(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}te.writeUint16LE=co,te.writeInt16LE=co;function oi(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}te.readInt32BE=oi;function ai(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}te.readUint32BE=ai;function ci(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}te.readInt32LE=ci;function ui(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}te.readUint32LE=ui;function an(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}te.writeUint32BE=an,te.writeInt32BE=an;function cn(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}te.writeUint32LE=cn,te.writeInt32LE=cn;function Bh(t,e){e===void 0&&(e=0);var r=oi(t,e),n=oi(t,e+4);return r*4294967296+n-(n>>31)*4294967296}te.readInt64BE=Bh;function Kh(t,e){e===void 0&&(e=0);var r=ai(t,e),n=ai(t,e+4);return r*4294967296+n}te.readUint64BE=Kh;function qh(t,e){e===void 0&&(e=0);var r=ci(t,e),n=ci(t,e+4);return n*4294967296+r-(r>>31)*4294967296}te.readInt64LE=qh;function Hh(t,e){e===void 0&&(e=0);var r=ui(t,e),n=ui(t,e+4);return n*4294967296+r}te.readUint64LE=Hh;function uo(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),an(t/4294967296>>>0,e,r),an(t>>>0,e,r+4),e}te.writeUint64BE=uo,te.writeInt64BE=uo;function fo(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),cn(t>>>0,e,r),cn(t/4294967296>>>0,e,r+4),e}te.writeUint64LE=fo,te.writeInt64LE=fo;function Vh(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}te.readUintBE=Vh;function Gh(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}te.readUintLE=Gh;function Wh(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!oo.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}te.writeUintBE=Wh;function Yh(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!oo.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}te.writeUintLE=Yh;function kh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}te.readFloat32BE=kh;function Xh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}te.readFloat32LE=Xh;function Jh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}te.readFloat64BE=Jh;function Zh(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}te.readFloat64LE=Zh;function Qh(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}te.writeFloat32BE=Qh;function el(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}te.writeFloat32LE=el;function tl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}te.writeFloat64BE=tl;function rl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}te.writeFloat64LE=rl,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=nn,r=te,n=_t;t.defaultRandomSource=new e.SystemRandomSource;function i(h,l=t.defaultRandomSource){return l.randomBytes(h)}t.randomBytes=i;function s(h=t.defaultRandomSource){const l=i(4,h),w=(0,r.readUint32LE)(l);return(0,n.wipe)(l),w}t.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function a(h,l=o,w=t.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let _="";const v=l.length,S=256-256%v;for(;h>0;){const R=i(Math.ceil(h*256/S),w);for(let A=0;A<R.length&&h>0;A++){const U=R[A];U<S&&(_+=l.charAt(U%v),h--)}(0,n.wipe)(R)}return _}t.randomString=a;function f(h,l=o,w=t.defaultRandomSource){const _=Math.ceil(h/(Math.log(l.length)/Math.LN2));return a(_,l,w)}t.randomStringForEntropy=f}(lr);var ho={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=_t;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},a.prototype.update=function(f,h){if(h===void 0&&(h=f.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&h>0;)this._buffer[this._bufferLength++]=f[l++],h--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,f,l,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=f[l++],h--;return this},a.prototype.finish=function(f){if(!this._finished){var h=this._bytesHashed,l=this._bufferLength,w=h/536870912|0,_=h<<3,v=h%128<112?128:256;this._buffer[l]=128;for(var S=l+1;S<v-8;S++)this._buffer[S]=0;e.writeUint32BE(w,this._buffer,v-8),e.writeUint32BE(_,this._buffer,v-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,v),this._finished=!0}for(var S=0;S<this.digestLength/8;S++)e.writeUint32BE(this._stateHi[S],f,S*8),e.writeUint32BE(this._stateLo[S],f,S*8+4);return this},a.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(f){return this._stateHi.set(f.stateHi),this._stateLo.set(f.stateLo),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(f){r.wipe(f.stateHi),r.wipe(f.stateLo),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},a}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(a,f,h,l,w,_,v){for(var S=h[0],R=h[1],A=h[2],U=h[3],E=h[4],O=h[5],g=h[6],m=h[7],b=l[0],c=l[1],p=l[2],F=l[3],z=l[4],k=l[5],X=l[6],J=l[7],T,N,W,j,P,$,M,B;v>=128;){for(var ne=0;ne<16;ne++){var K=8*ne+_;a[ne]=e.readUint32BE(w,K),f[ne]=e.readUint32BE(w,K+4)}for(var ne=0;ne<80;ne++){var Q=S,Y=R,ae=A,L=U,I=E,D=O,u=g,y=m,q=b,V=c,he=p,ye=F,de=z,we=k,je=X,Pe=J;if(T=m,N=J,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=(E>>>14|z<<32-14)^(E>>>18|z<<32-18)^(z>>>41-32|E<<32-(41-32)),N=(z>>>14|E<<32-14)^(z>>>18|E<<32-18)^(E>>>41-32|z<<32-(41-32)),P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,T=E&O^~E&g,N=z&k^~z&X,P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,T=i[ne*2],N=i[ne*2+1],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,T=a[ne%16],N=f[ne%16],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,W=M&65535|B<<16,j=P&65535|$<<16,T=W,N=j,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=(S>>>28|b<<32-28)^(b>>>34-32|S<<32-(34-32))^(b>>>39-32|S<<32-(39-32)),N=(b>>>28|S<<32-28)^(S>>>34-32|b<<32-(34-32))^(S>>>39-32|b<<32-(39-32)),P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,T=S&R^S&A^R&A,N=b&c^b&p^c&p,P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,y=M&65535|B<<16,Pe=P&65535|$<<16,T=L,N=ye,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=W,N=j,P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,L=M&65535|B<<16,ye=P&65535|$<<16,R=Q,A=Y,U=ae,E=L,O=I,g=D,m=u,S=y,c=q,p=V,F=he,z=ye,k=de,X=we,J=je,b=Pe,ne%16===15)for(var K=0;K<16;K++)T=a[K],N=f[K],P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=a[(K+9)%16],N=f[(K+9)%16],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,W=a[(K+1)%16],j=f[(K+1)%16],T=(W>>>1|j<<32-1)^(W>>>8|j<<32-8)^W>>>7,N=(j>>>1|W<<32-1)^(j>>>8|W<<32-8)^(j>>>7|W<<32-7),P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,W=a[(K+14)%16],j=f[(K+14)%16],T=(W>>>19|j<<32-19)^(j>>>61-32|W<<32-(61-32))^W>>>6,N=(j>>>19|W<<32-19)^(W>>>61-32|j<<32-(61-32))^(j>>>6|W<<32-6),P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,a[K]=M&65535|B<<16,f[K]=P&65535|$<<16}T=S,N=b,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=h[0],N=l[0],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,h[0]=S=M&65535|B<<16,l[0]=b=P&65535|$<<16,T=R,N=c,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=h[1],N=l[1],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,h[1]=R=M&65535|B<<16,l[1]=c=P&65535|$<<16,T=A,N=p,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=h[2],N=l[2],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,h[2]=A=M&65535|B<<16,l[2]=p=P&65535|$<<16,T=U,N=F,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=h[3],N=l[3],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,h[3]=U=M&65535|B<<16,l[3]=F=P&65535|$<<16,T=E,N=z,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=h[4],N=l[4],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,h[4]=E=M&65535|B<<16,l[4]=z=P&65535|$<<16,T=O,N=k,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=h[5],N=l[5],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,h[5]=O=M&65535|B<<16,l[5]=k=P&65535|$<<16,T=g,N=X,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=h[6],N=l[6],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,h[6]=g=M&65535|B<<16,l[6]=X=P&65535|$<<16,T=m,N=J,P=N&65535,$=N>>>16,M=T&65535,B=T>>>16,T=h[7],N=l[7],P+=N&65535,$+=N>>>16,M+=T&65535,B+=T>>>16,$+=P>>>16,M+=$>>>16,B+=M>>>16,h[7]=m=M&65535|B<<16,l[7]=J=P&65535|$<<16,_+=128,v-=128}return _}function o(a){var f=new n;f.update(a);var h=f.digest();return f.clean(),h}t.hash=o})(ho),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=lr,r=ho,n=_t;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(L){const I=new Float64Array(16);if(L)for(let D=0;D<L.length;D++)I[D]=L[D];return I}const s=new Uint8Array(32);s[0]=9;const o=i(),a=i([1]),f=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),_=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function v(L,I){for(let D=0;D<16;D++)L[D]=I[D]|0}function S(L){let I=1;for(let D=0;D<16;D++){let u=L[D]+I+65535;I=Math.floor(u/65536),L[D]=u-I*65536}L[0]+=I-1+37*(I-1)}function R(L,I,D){const u=~(D-1);for(let y=0;y<16;y++){const q=u&(L[y]^I[y]);L[y]^=q,I[y]^=q}}function A(L,I){const D=i(),u=i();for(let y=0;y<16;y++)u[y]=I[y];S(u),S(u),S(u);for(let y=0;y<2;y++){D[0]=u[0]-65517;for(let V=1;V<15;V++)D[V]=u[V]-65535-(D[V-1]>>16&1),D[V-1]&=65535;D[15]=u[15]-32767-(D[14]>>16&1);const q=D[15]>>16&1;D[14]&=65535,R(u,D,1-q)}for(let y=0;y<16;y++)L[2*y]=u[y]&255,L[2*y+1]=u[y]>>8}function U(L,I){let D=0;for(let u=0;u<32;u++)D|=L[u]^I[u];return(1&D-1>>>8)-1}function E(L,I){const D=new Uint8Array(32),u=new Uint8Array(32);return A(D,L),A(u,I),U(D,u)}function O(L){const I=new Uint8Array(32);return A(I,L),I[0]&1}function g(L,I){for(let D=0;D<16;D++)L[D]=I[2*D]+(I[2*D+1]<<8);L[15]&=32767}function m(L,I,D){for(let u=0;u<16;u++)L[u]=I[u]+D[u]}function b(L,I,D){for(let u=0;u<16;u++)L[u]=I[u]-D[u]}function c(L,I,D){let u,y,q=0,V=0,he=0,ye=0,de=0,we=0,je=0,Pe=0,_e=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,ee=0,fe=0,ge=0,re=0,ve=0,be=0,Ee=0,Se=0,me=0,Dt=0,Rt=0,qt=0,vt=0,rr=0,Hr=0,Nn=0,ze=D[0],Fe=D[1],Be=D[2],Ke=D[3],qe=D[4],$e=D[5],We=D[6],Ye=D[7],ke=D[8],Xe=D[9],Je=D[10],Ve=D[11],He=D[12],Re=D[13],Ze=D[14],Qe=D[15];u=I[0],q+=u*ze,V+=u*Fe,he+=u*Be,ye+=u*Ke,de+=u*qe,we+=u*$e,je+=u*We,Pe+=u*Ye,_e+=u*ke,pe+=u*Xe,le+=u*Je,ue+=u*Ve,ce+=u*He,oe+=u*Re,se+=u*Ze,ee+=u*Qe,u=I[1],V+=u*ze,he+=u*Fe,ye+=u*Be,de+=u*Ke,we+=u*qe,je+=u*$e,Pe+=u*We,_e+=u*Ye,pe+=u*ke,le+=u*Xe,ue+=u*Je,ce+=u*Ve,oe+=u*He,se+=u*Re,ee+=u*Ze,fe+=u*Qe,u=I[2],he+=u*ze,ye+=u*Fe,de+=u*Be,we+=u*Ke,je+=u*qe,Pe+=u*$e,_e+=u*We,pe+=u*Ye,le+=u*ke,ue+=u*Xe,ce+=u*Je,oe+=u*Ve,se+=u*He,ee+=u*Re,fe+=u*Ze,ge+=u*Qe,u=I[3],ye+=u*ze,de+=u*Fe,we+=u*Be,je+=u*Ke,Pe+=u*qe,_e+=u*$e,pe+=u*We,le+=u*Ye,ue+=u*ke,ce+=u*Xe,oe+=u*Je,se+=u*Ve,ee+=u*He,fe+=u*Re,ge+=u*Ze,re+=u*Qe,u=I[4],de+=u*ze,we+=u*Fe,je+=u*Be,Pe+=u*Ke,_e+=u*qe,pe+=u*$e,le+=u*We,ue+=u*Ye,ce+=u*ke,oe+=u*Xe,se+=u*Je,ee+=u*Ve,fe+=u*He,ge+=u*Re,re+=u*Ze,ve+=u*Qe,u=I[5],we+=u*ze,je+=u*Fe,Pe+=u*Be,_e+=u*Ke,pe+=u*qe,le+=u*$e,ue+=u*We,ce+=u*Ye,oe+=u*ke,se+=u*Xe,ee+=u*Je,fe+=u*Ve,ge+=u*He,re+=u*Re,ve+=u*Ze,be+=u*Qe,u=I[6],je+=u*ze,Pe+=u*Fe,_e+=u*Be,pe+=u*Ke,le+=u*qe,ue+=u*$e,ce+=u*We,oe+=u*Ye,se+=u*ke,ee+=u*Xe,fe+=u*Je,ge+=u*Ve,re+=u*He,ve+=u*Re,be+=u*Ze,Ee+=u*Qe,u=I[7],Pe+=u*ze,_e+=u*Fe,pe+=u*Be,le+=u*Ke,ue+=u*qe,ce+=u*$e,oe+=u*We,se+=u*Ye,ee+=u*ke,fe+=u*Xe,ge+=u*Je,re+=u*Ve,ve+=u*He,be+=u*Re,Ee+=u*Ze,Se+=u*Qe,u=I[8],_e+=u*ze,pe+=u*Fe,le+=u*Be,ue+=u*Ke,ce+=u*qe,oe+=u*$e,se+=u*We,ee+=u*Ye,fe+=u*ke,ge+=u*Xe,re+=u*Je,ve+=u*Ve,be+=u*He,Ee+=u*Re,Se+=u*Ze,me+=u*Qe,u=I[9],pe+=u*ze,le+=u*Fe,ue+=u*Be,ce+=u*Ke,oe+=u*qe,se+=u*$e,ee+=u*We,fe+=u*Ye,ge+=u*ke,re+=u*Xe,ve+=u*Je,be+=u*Ve,Ee+=u*He,Se+=u*Re,me+=u*Ze,Dt+=u*Qe,u=I[10],le+=u*ze,ue+=u*Fe,ce+=u*Be,oe+=u*Ke,se+=u*qe,ee+=u*$e,fe+=u*We,ge+=u*Ye,re+=u*ke,ve+=u*Xe,be+=u*Je,Ee+=u*Ve,Se+=u*He,me+=u*Re,Dt+=u*Ze,Rt+=u*Qe,u=I[11],ue+=u*ze,ce+=u*Fe,oe+=u*Be,se+=u*Ke,ee+=u*qe,fe+=u*$e,ge+=u*We,re+=u*Ye,ve+=u*ke,be+=u*Xe,Ee+=u*Je,Se+=u*Ve,me+=u*He,Dt+=u*Re,Rt+=u*Ze,qt+=u*Qe,u=I[12],ce+=u*ze,oe+=u*Fe,se+=u*Be,ee+=u*Ke,fe+=u*qe,ge+=u*$e,re+=u*We,ve+=u*Ye,be+=u*ke,Ee+=u*Xe,Se+=u*Je,me+=u*Ve,Dt+=u*He,Rt+=u*Re,qt+=u*Ze,vt+=u*Qe,u=I[13],oe+=u*ze,se+=u*Fe,ee+=u*Be,fe+=u*Ke,ge+=u*qe,re+=u*$e,ve+=u*We,be+=u*Ye,Ee+=u*ke,Se+=u*Xe,me+=u*Je,Dt+=u*Ve,Rt+=u*He,qt+=u*Re,vt+=u*Ze,rr+=u*Qe,u=I[14],se+=u*ze,ee+=u*Fe,fe+=u*Be,ge+=u*Ke,re+=u*qe,ve+=u*$e,be+=u*We,Ee+=u*Ye,Se+=u*ke,me+=u*Xe,Dt+=u*Je,Rt+=u*Ve,qt+=u*He,vt+=u*Re,rr+=u*Ze,Hr+=u*Qe,u=I[15],ee+=u*ze,fe+=u*Fe,ge+=u*Be,re+=u*Ke,ve+=u*qe,be+=u*$e,Ee+=u*We,Se+=u*Ye,me+=u*ke,Dt+=u*Xe,Rt+=u*Je,qt+=u*Ve,vt+=u*He,rr+=u*Re,Hr+=u*Ze,Nn+=u*Qe,q+=38*fe,V+=38*ge,he+=38*re,ye+=38*ve,de+=38*be,we+=38*Ee,je+=38*Se,Pe+=38*me,_e+=38*Dt,pe+=38*Rt,le+=38*qt,ue+=38*vt,ce+=38*rr,oe+=38*Hr,se+=38*Nn,y=1,u=q+y+65535,y=Math.floor(u/65536),q=u-y*65536,u=V+y+65535,y=Math.floor(u/65536),V=u-y*65536,u=he+y+65535,y=Math.floor(u/65536),he=u-y*65536,u=ye+y+65535,y=Math.floor(u/65536),ye=u-y*65536,u=de+y+65535,y=Math.floor(u/65536),de=u-y*65536,u=we+y+65535,y=Math.floor(u/65536),we=u-y*65536,u=je+y+65535,y=Math.floor(u/65536),je=u-y*65536,u=Pe+y+65535,y=Math.floor(u/65536),Pe=u-y*65536,u=_e+y+65535,y=Math.floor(u/65536),_e=u-y*65536,u=pe+y+65535,y=Math.floor(u/65536),pe=u-y*65536,u=le+y+65535,y=Math.floor(u/65536),le=u-y*65536,u=ue+y+65535,y=Math.floor(u/65536),ue=u-y*65536,u=ce+y+65535,y=Math.floor(u/65536),ce=u-y*65536,u=oe+y+65535,y=Math.floor(u/65536),oe=u-y*65536,u=se+y+65535,y=Math.floor(u/65536),se=u-y*65536,u=ee+y+65535,y=Math.floor(u/65536),ee=u-y*65536,q+=y-1+37*(y-1),y=1,u=q+y+65535,y=Math.floor(u/65536),q=u-y*65536,u=V+y+65535,y=Math.floor(u/65536),V=u-y*65536,u=he+y+65535,y=Math.floor(u/65536),he=u-y*65536,u=ye+y+65535,y=Math.floor(u/65536),ye=u-y*65536,u=de+y+65535,y=Math.floor(u/65536),de=u-y*65536,u=we+y+65535,y=Math.floor(u/65536),we=u-y*65536,u=je+y+65535,y=Math.floor(u/65536),je=u-y*65536,u=Pe+y+65535,y=Math.floor(u/65536),Pe=u-y*65536,u=_e+y+65535,y=Math.floor(u/65536),_e=u-y*65536,u=pe+y+65535,y=Math.floor(u/65536),pe=u-y*65536,u=le+y+65535,y=Math.floor(u/65536),le=u-y*65536,u=ue+y+65535,y=Math.floor(u/65536),ue=u-y*65536,u=ce+y+65535,y=Math.floor(u/65536),ce=u-y*65536,u=oe+y+65535,y=Math.floor(u/65536),oe=u-y*65536,u=se+y+65535,y=Math.floor(u/65536),se=u-y*65536,u=ee+y+65535,y=Math.floor(u/65536),ee=u-y*65536,q+=y-1+37*(y-1),L[0]=q,L[1]=V,L[2]=he,L[3]=ye,L[4]=de,L[5]=we,L[6]=je,L[7]=Pe,L[8]=_e,L[9]=pe,L[10]=le,L[11]=ue,L[12]=ce,L[13]=oe,L[14]=se,L[15]=ee}function p(L,I){c(L,I,I)}function F(L,I){const D=i();let u;for(u=0;u<16;u++)D[u]=I[u];for(u=253;u>=0;u--)p(D,D),u!==2&&u!==4&&c(D,D,I);for(u=0;u<16;u++)L[u]=D[u]}function z(L,I){const D=i();let u;for(u=0;u<16;u++)D[u]=I[u];for(u=250;u>=0;u--)p(D,D),u!==1&&c(D,D,I);for(u=0;u<16;u++)L[u]=D[u]}function k(L,I){const D=i(),u=i(),y=i(),q=i(),V=i(),he=i(),ye=i(),de=i(),we=i();b(D,L[1],L[0]),b(we,I[1],I[0]),c(D,D,we),m(u,L[0],L[1]),m(we,I[0],I[1]),c(u,u,we),c(y,L[3],I[3]),c(y,y,h),c(q,L[2],I[2]),m(q,q,q),b(V,u,D),b(he,q,y),m(ye,q,y),m(de,u,D),c(L[0],V,he),c(L[1],de,ye),c(L[2],ye,he),c(L[3],V,de)}function X(L,I,D){for(let u=0;u<4;u++)R(L[u],I[u],D)}function J(L,I){const D=i(),u=i(),y=i();F(y,I[2]),c(D,I[0],y),c(u,I[1],y),A(L,u),L[31]^=O(D)<<7}function T(L,I,D){v(L[0],o),v(L[1],a),v(L[2],a),v(L[3],o);for(let u=255;u>=0;--u){const y=D[u/8|0]>>(u&7)&1;X(L,I,y),k(I,L),k(L,L),X(L,I,y)}}function N(L,I){const D=[i(),i(),i(),i()];v(D[0],l),v(D[1],w),v(D[2],a),c(D[3],l,w),T(L,D,I)}function W(L){if(L.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const I=(0,r.hash)(L);I[0]&=248,I[31]&=127,I[31]|=64;const D=new Uint8Array(32),u=[i(),i(),i(),i()];N(u,I),J(D,u);const y=new Uint8Array(64);return y.set(L),y.set(D,32),{publicKey:D,secretKey:y}}t.generateKeyPairFromSeed=W;function j(L){const I=(0,e.randomBytes)(32,L),D=W(I);return(0,n.wipe)(I),D}t.generateKeyPair=j;function P(L){if(L.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}t.extractPublicKeyFromSecretKey=P;const $=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(L,I){let D,u,y,q;for(u=63;u>=32;--u){for(D=0,y=u-32,q=u-12;y<q;++y)I[y]+=D-16*I[u]*$[y-(u-32)],D=Math.floor((I[y]+128)/256),I[y]-=D*256;I[y]+=D,I[u]=0}for(D=0,y=0;y<32;y++)I[y]+=D-(I[31]>>4)*$[y],D=I[y]>>8,I[y]&=255;for(y=0;y<32;y++)I[y]-=D*$[y];for(u=0;u<32;u++)I[u+1]+=I[u]>>8,L[u]=I[u]&255}function B(L){const I=new Float64Array(64);for(let D=0;D<64;D++)I[D]=L[D];for(let D=0;D<64;D++)L[D]=0;M(L,I)}function ne(L,I){const D=new Float64Array(64),u=[i(),i(),i(),i()],y=(0,r.hash)(L.subarray(0,32));y[0]&=248,y[31]&=127,y[31]|=64;const q=new Uint8Array(64);q.set(y.subarray(32),32);const V=new r.SHA512;V.update(q.subarray(32)),V.update(I);const he=V.digest();V.clean(),B(he),N(u,he),J(q,u),V.reset(),V.update(q.subarray(0,32)),V.update(L.subarray(32)),V.update(I);const ye=V.digest();B(ye);for(let de=0;de<32;de++)D[de]=he[de];for(let de=0;de<32;de++)for(let we=0;we<32;we++)D[de+we]+=ye[de]*y[we];return M(q.subarray(32),D),q}t.sign=ne;function K(L,I){const D=i(),u=i(),y=i(),q=i(),V=i(),he=i(),ye=i();return v(L[2],a),g(L[1],I),p(y,L[1]),c(q,y,f),b(y,y,L[2]),m(q,L[2],q),p(V,q),p(he,V),c(ye,he,V),c(D,ye,y),c(D,D,q),z(D,D),c(D,D,y),c(D,D,q),c(D,D,q),c(L[0],D,q),p(u,L[0]),c(u,u,q),E(u,y)&&c(L[0],L[0],_),p(u,L[0]),c(u,u,q),E(u,y)?-1:(O(L[0])===I[31]>>7&&b(L[0],o,L[0]),c(L[3],L[0],L[1]),0)}function Q(L,I,D){const u=new Uint8Array(32),y=[i(),i(),i(),i()],q=[i(),i(),i(),i()];if(D.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(K(q,L))return!1;const V=new r.SHA512;V.update(D.subarray(0,32)),V.update(L),V.update(I);const he=V.digest();return B(he),T(y,q,he),N(q,D.subarray(32)),k(y,q),J(u,y),!U(D,u)}t.verify=Q;function Y(L){let I=[i(),i(),i(),i()];if(K(I,L))throw new Error("Ed25519: invalid public key");let D=i(),u=i(),y=I[1];m(D,a,y),b(u,a,y),F(u,u),c(D,D,u);let q=new Uint8Array(32);return A(q,D),q}t.convertPublicKeyToX25519=Y;function ae(L){const I=(0,r.hash)(L.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const D=new Uint8Array(I.subarray(0,32));return(0,n.wipe)(I),D}t.convertSecretKeyToX25519=ae}(si);const nl="EdDSA",il="JWT",lo=".",po="base64url",sl="utf8",ol="utf8",al=":",cl="did",ul="key",go="base58btc",fl="z",hl="K36",ll=32;function _o(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function fi(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=_o(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function dl(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,f=t.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function w(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var R=0,A=0,U=0,E=S.length;U!==E&&S[U]===0;)U++,R++;for(var O=(E-U)*l+1>>>0,g=new Uint8Array(O);U!==E;){for(var m=S[U],b=0,c=O-1;(m!==0||b<A)&&c!==-1;c--,b++)m+=256*g[c]>>>0,g[c]=m%a>>>0,m=m/a>>>0;if(m!==0)throw new Error("Non-zero carry");A=b,U++}for(var p=O-A;p!==O&&g[p]===0;)p++;for(var F=f.repeat(R);p<O;++p)F+=t.charAt(g[p]);return F}function _(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var R=0;if(S[R]!==" "){for(var A=0,U=0;S[R]===f;)A++,R++;for(var E=(S.length-R)*h+1>>>0,O=new Uint8Array(E);S[R];){var g=r[S.charCodeAt(R)];if(g===255)return;for(var m=0,b=E-1;(g!==0||m<U)&&b!==-1;b--,m++)g+=a*O[b]>>>0,O[b]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");U=m,R++}if(S[R]!==" "){for(var c=E-U;c!==E&&O[c]===0;)c++;for(var p=new Uint8Array(A+(E-c)),F=A;c!==E;)p[F++]=O[c++];return p}}}function v(S){var R=_(S);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:_,decode:v}}var pl=dl,gl=pl;const yo=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},_l=t=>new TextEncoder().encode(t),yl=t=>new TextDecoder().decode(t);class vl{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class bl{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return vo(this,e)}}class wl{constructor(e){this.decoders=e}or(e){return vo(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const vo=(t,e)=>new wl({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class ml{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new vl(e,r,n),this.decoder=new bl(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const un=({name:t,prefix:e,encode:r,decode:n})=>new ml(t,e,r,n),Cr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=gl(r,e);return un({prefix:t,name:e,encode:n,decode:s=>yo(i(s))})},El=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,f=0,h=0;for(let l=0;l<s;++l){const w=i[t[l]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|w,a+=r,a>=8&&(a-=8,o[h++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},Sl=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},rt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>un({prefix:e,name:t,encode(i){return Sl(i,n,r)},decode(i){return El(i,n,r,t)}}),Dl=un({prefix:"\0",name:"identity",encode:t=>yl(t),decode:t=>_l(t)});var xl=Object.freeze({__proto__:null,identity:Dl});const Ol=rt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Il=Object.freeze({__proto__:null,base2:Ol});const Ll=rt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Nl=Object.freeze({__proto__:null,base8:Ll});const Tl=Cr({prefix:"9",name:"base10",alphabet:"0123456789"});var Al=Object.freeze({__proto__:null,base10:Tl});const Rl=rt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Cl=rt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Pl=Object.freeze({__proto__:null,base16:Rl,base16upper:Cl});const Fl=rt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$l=rt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ul=rt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ml=rt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),jl=rt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zl=rt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Bl=rt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Kl=rt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ql=rt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Hl=Object.freeze({__proto__:null,base32:Fl,base32upper:$l,base32pad:Ul,base32padupper:Ml,base32hex:jl,base32hexupper:zl,base32hexpad:Bl,base32hexpadupper:Kl,base32z:ql});const Vl=Cr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Gl=Cr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Wl=Object.freeze({__proto__:null,base36:Vl,base36upper:Gl});const Yl=Cr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),kl=Cr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Xl=Object.freeze({__proto__:null,base58btc:Yl,base58flickr:kl});const Jl=rt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Zl=rt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ql=rt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ed=rt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var td=Object.freeze({__proto__:null,base64:Jl,base64pad:Zl,base64url:Ql,base64urlpad:ed});const bo=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),rd=bo.reduce((t,e,r)=>(t[r]=e,t),[]),nd=bo.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function id(t){return t.reduce((e,r)=>(e+=rd[r],e),"")}function sd(t){const e=[];for(const r of t){const n=nd[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const od=un({prefix:"\u{1F680}",name:"base256emoji",encode:id,decode:sd});var ad=Object.freeze({__proto__:null,base256emoji:od}),cd=mo,wo=128,ud=127,fd=~ud,hd=Math.pow(2,31);function mo(t,e,r){e=e||[],r=r||0;for(var n=r;t>=hd;)e[r++]=t&255|wo,t/=128;for(;t&fd;)e[r++]=t&255|wo,t>>>=7;return e[r]=t|0,mo.bytes=r-n+1,e}var ld=hi,dd=128,Eo=127;function hi(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw hi.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Eo)<<i:(o&Eo)*Math.pow(2,i),i+=7}while(o>=dd);return hi.bytes=s-n,r}var pd=Math.pow(2,7),gd=Math.pow(2,14),_d=Math.pow(2,21),yd=Math.pow(2,28),vd=Math.pow(2,35),bd=Math.pow(2,42),wd=Math.pow(2,49),md=Math.pow(2,56),Ed=Math.pow(2,63),Sd=function(t){return t<pd?1:t<gd?2:t<_d?3:t<yd?4:t<vd?5:t<bd?6:t<wd?7:t<md?8:t<Ed?9:10},Dd={encode:cd,decode:ld,encodingLength:Sd},So=Dd;const Do=(t,e,r=0)=>(So.encode(t,e,r),e),xo=t=>So.encodingLength(t),li=(t,e)=>{const r=e.byteLength,n=xo(t),i=n+xo(r),s=new Uint8Array(i+r);return Do(t,s,0),Do(r,s,n),s.set(e,i),new xd(t,r,e,s)};class xd{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const Oo=({name:t,code:e,encode:r})=>new Od(t,e,r);class Od{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?li(this.code,r):r.then(n=>li(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Io=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Id=Oo({name:"sha2-256",code:18,encode:Io("SHA-256")}),Ld=Oo({name:"sha2-512",code:19,encode:Io("SHA-512")});var Nd=Object.freeze({__proto__:null,sha256:Id,sha512:Ld});const Lo=0,Td="identity",No=yo;var Ad=Object.freeze({__proto__:null,identity:{code:Lo,name:Td,encode:No,digest:t=>li(Lo,No(t))}});new TextEncoder,new TextDecoder;const To={...xl,...Il,...Nl,...Al,...Pl,...Hl,...Wl,...Xl,...td,...ad};({...Nd,...Ad});function Ao(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Ro=Ao("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),di=Ao("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=_o(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Co={utf8:Ro,"utf-8":Ro,hex:To.base16,latin1:di,ascii:di,binary:di,...To};function ht(t,e="utf8"){const r=Co[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function lt(t,e="utf8"){const r=Co[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function fn(t){return ht(lt(ii(t),sl),po)}function Po(t){const e=lt(hl,go),r=fl+ht(fi([e,t]),go);return[cl,ul,r].join(al)}function Rd(t){return ht(t,po)}function Cd(t){return lt([fn(t.header),fn(t.payload)].join(lo),ol)}function Pd(t){return[fn(t.header),fn(t.payload),Rd(t.signature)].join(lo)}function Fo(t=lr.randomBytes(ll)){return si.generateKeyPairFromSeed(t)}async function Fd(t,e,r,n,i=Z.fromMiliseconds(Date.now())){const s={alg:nl,typ:il},o=Po(n.publicKey),a=i+r,f={iss:o,sub:t,aud:e,iat:i,exp:a},h=Cd({header:s,payload:f}),l=si.sign(n.secretKey,h);return Pd({header:s,payload:f,signature:l})}var pi={},hn={};Object.defineProperty(hn,"__esModule",{value:!0});var ot=te,gi=_t,$d=20;function Ud(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],w=r[19]<<24|r[18]<<16|r[17]<<8|r[16],_=r[23]<<24|r[22]<<16|r[21]<<8|r[20],v=r[27]<<24|r[26]<<16|r[25]<<8|r[24],S=r[31]<<24|r[30]<<16|r[29]<<8|r[28],R=e[3]<<24|e[2]<<16|e[1]<<8|e[0],A=e[7]<<24|e[6]<<16|e[5]<<8|e[4],U=e[11]<<24|e[10]<<16|e[9]<<8|e[8],E=e[15]<<24|e[14]<<16|e[13]<<8|e[12],O=n,g=i,m=s,b=o,c=a,p=f,F=h,z=l,k=w,X=_,J=v,T=S,N=R,W=A,j=U,P=E,$=0;$<$d;$+=2)O=O+c|0,N^=O,N=N>>>32-16|N<<16,k=k+N|0,c^=k,c=c>>>32-12|c<<12,g=g+p|0,W^=g,W=W>>>32-16|W<<16,X=X+W|0,p^=X,p=p>>>32-12|p<<12,m=m+F|0,j^=m,j=j>>>32-16|j<<16,J=J+j|0,F^=J,F=F>>>32-12|F<<12,b=b+z|0,P^=b,P=P>>>32-16|P<<16,T=T+P|0,z^=T,z=z>>>32-12|z<<12,m=m+F|0,j^=m,j=j>>>32-8|j<<8,J=J+j|0,F^=J,F=F>>>32-7|F<<7,b=b+z|0,P^=b,P=P>>>32-8|P<<8,T=T+P|0,z^=T,z=z>>>32-7|z<<7,g=g+p|0,W^=g,W=W>>>32-8|W<<8,X=X+W|0,p^=X,p=p>>>32-7|p<<7,O=O+c|0,N^=O,N=N>>>32-8|N<<8,k=k+N|0,c^=k,c=c>>>32-7|c<<7,O=O+p|0,P^=O,P=P>>>32-16|P<<16,J=J+P|0,p^=J,p=p>>>32-12|p<<12,g=g+F|0,N^=g,N=N>>>32-16|N<<16,T=T+N|0,F^=T,F=F>>>32-12|F<<12,m=m+z|0,W^=m,W=W>>>32-16|W<<16,k=k+W|0,z^=k,z=z>>>32-12|z<<12,b=b+c|0,j^=b,j=j>>>32-16|j<<16,X=X+j|0,c^=X,c=c>>>32-12|c<<12,m=m+z|0,W^=m,W=W>>>32-8|W<<8,k=k+W|0,z^=k,z=z>>>32-7|z<<7,b=b+c|0,j^=b,j=j>>>32-8|j<<8,X=X+j|0,c^=X,c=c>>>32-7|c<<7,g=g+F|0,N^=g,N=N>>>32-8|N<<8,T=T+N|0,F^=T,F=F>>>32-7|F<<7,O=O+p|0,P^=O,P=P>>>32-8|P<<8,J=J+P|0,p^=J,p=p>>>32-7|p<<7;ot.writeUint32LE(O+n|0,t,0),ot.writeUint32LE(g+i|0,t,4),ot.writeUint32LE(m+s|0,t,8),ot.writeUint32LE(b+o|0,t,12),ot.writeUint32LE(c+a|0,t,16),ot.writeUint32LE(p+f|0,t,20),ot.writeUint32LE(F+h|0,t,24),ot.writeUint32LE(z+l|0,t,28),ot.writeUint32LE(k+w|0,t,32),ot.writeUint32LE(X+_|0,t,36),ot.writeUint32LE(J+v|0,t,40),ot.writeUint32LE(T+S|0,t,44),ot.writeUint32LE(N+R|0,t,48),ot.writeUint32LE(W+A|0,t,52),ot.writeUint32LE(j+U|0,t,56),ot.writeUint32LE(P+E|0,t,60)}function $o(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=i}for(var a=new Uint8Array(64),f=0;f<r.length;f+=64){Ud(a,s,t);for(var h=f;h<f+64&&h<r.length;h++)n[h]=r[h]^a[h-f];jd(s,0,o)}return gi.wipe(a),i===0&&gi.wipe(s),n}hn.streamXOR=$o;function Md(t,e,r,n){return n===void 0&&(n=0),gi.wipe(r),$o(t,e,r,r,n)}hn.stream=Md;function jd(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var Uo={},zt={};Object.defineProperty(zt,"__esModule",{value:!0});function zd(t,e,r){return~(t-1)&e|t-1&r}zt.select=zd;function Bd(t,e){return(t|0)-(e|0)-1>>>31&1}zt.lessOrEqual=Bd;function Mo(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}zt.compare=Mo;function Kd(t,e){return t.length===0||e.length===0?!1:Mo(t,e)!==0}zt.equal=Kd,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=zt,r=_t;t.DIGEST_LENGTH=16;var n=function(){function o(a){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var f=a[0]|a[1]<<8;this._r[0]=f&8191;var h=a[2]|a[3]<<8;this._r[1]=(f>>>13|h<<3)&8191;var l=a[4]|a[5]<<8;this._r[2]=(h>>>10|l<<6)&7939;var w=a[6]|a[7]<<8;this._r[3]=(l>>>7|w<<9)&8191;var _=a[8]|a[9]<<8;this._r[4]=(w>>>4|_<<12)&255,this._r[5]=_>>>1&8190;var v=a[10]|a[11]<<8;this._r[6]=(_>>>14|v<<2)&8191;var S=a[12]|a[13]<<8;this._r[7]=(v>>>11|S<<5)&8065;var R=a[14]|a[15]<<8;this._r[8]=(S>>>8|R<<8)&8191,this._r[9]=R>>>5&127,this._pad[0]=a[16]|a[17]<<8,this._pad[1]=a[18]|a[19]<<8,this._pad[2]=a[20]|a[21]<<8,this._pad[3]=a[22]|a[23]<<8,this._pad[4]=a[24]|a[25]<<8,this._pad[5]=a[26]|a[27]<<8,this._pad[6]=a[28]|a[29]<<8,this._pad[7]=a[30]|a[31]<<8}return o.prototype._blocks=function(a,f,h){for(var l=this._fin?0:2048,w=this._h[0],_=this._h[1],v=this._h[2],S=this._h[3],R=this._h[4],A=this._h[5],U=this._h[6],E=this._h[7],O=this._h[8],g=this._h[9],m=this._r[0],b=this._r[1],c=this._r[2],p=this._r[3],F=this._r[4],z=this._r[5],k=this._r[6],X=this._r[7],J=this._r[8],T=this._r[9];h>=16;){var N=a[f+0]|a[f+1]<<8;w+=N&8191;var W=a[f+2]|a[f+3]<<8;_+=(N>>>13|W<<3)&8191;var j=a[f+4]|a[f+5]<<8;v+=(W>>>10|j<<6)&8191;var P=a[f+6]|a[f+7]<<8;S+=(j>>>7|P<<9)&8191;var $=a[f+8]|a[f+9]<<8;R+=(P>>>4|$<<12)&8191,A+=$>>>1&8191;var M=a[f+10]|a[f+11]<<8;U+=($>>>14|M<<2)&8191;var B=a[f+12]|a[f+13]<<8;E+=(M>>>11|B<<5)&8191;var ne=a[f+14]|a[f+15]<<8;O+=(B>>>8|ne<<8)&8191,g+=ne>>>5|l;var K=0,Q=K;Q+=w*m,Q+=_*(5*T),Q+=v*(5*J),Q+=S*(5*X),Q+=R*(5*k),K=Q>>>13,Q&=8191,Q+=A*(5*z),Q+=U*(5*F),Q+=E*(5*p),Q+=O*(5*c),Q+=g*(5*b),K+=Q>>>13,Q&=8191;var Y=K;Y+=w*b,Y+=_*m,Y+=v*(5*T),Y+=S*(5*J),Y+=R*(5*X),K=Y>>>13,Y&=8191,Y+=A*(5*k),Y+=U*(5*z),Y+=E*(5*F),Y+=O*(5*p),Y+=g*(5*c),K+=Y>>>13,Y&=8191;var ae=K;ae+=w*c,ae+=_*b,ae+=v*m,ae+=S*(5*T),ae+=R*(5*J),K=ae>>>13,ae&=8191,ae+=A*(5*X),ae+=U*(5*k),ae+=E*(5*z),ae+=O*(5*F),ae+=g*(5*p),K+=ae>>>13,ae&=8191;var L=K;L+=w*p,L+=_*c,L+=v*b,L+=S*m,L+=R*(5*T),K=L>>>13,L&=8191,L+=A*(5*J),L+=U*(5*X),L+=E*(5*k),L+=O*(5*z),L+=g*(5*F),K+=L>>>13,L&=8191;var I=K;I+=w*F,I+=_*p,I+=v*c,I+=S*b,I+=R*m,K=I>>>13,I&=8191,I+=A*(5*T),I+=U*(5*J),I+=E*(5*X),I+=O*(5*k),I+=g*(5*z),K+=I>>>13,I&=8191;var D=K;D+=w*z,D+=_*F,D+=v*p,D+=S*c,D+=R*b,K=D>>>13,D&=8191,D+=A*m,D+=U*(5*T),D+=E*(5*J),D+=O*(5*X),D+=g*(5*k),K+=D>>>13,D&=8191;var u=K;u+=w*k,u+=_*z,u+=v*F,u+=S*p,u+=R*c,K=u>>>13,u&=8191,u+=A*b,u+=U*m,u+=E*(5*T),u+=O*(5*J),u+=g*(5*X),K+=u>>>13,u&=8191;var y=K;y+=w*X,y+=_*k,y+=v*z,y+=S*F,y+=R*p,K=y>>>13,y&=8191,y+=A*c,y+=U*b,y+=E*m,y+=O*(5*T),y+=g*(5*J),K+=y>>>13,y&=8191;var q=K;q+=w*J,q+=_*X,q+=v*k,q+=S*z,q+=R*F,K=q>>>13,q&=8191,q+=A*p,q+=U*c,q+=E*b,q+=O*m,q+=g*(5*T),K+=q>>>13,q&=8191;var V=K;V+=w*T,V+=_*J,V+=v*X,V+=S*k,V+=R*z,K=V>>>13,V&=8191,V+=A*F,V+=U*p,V+=E*c,V+=O*b,V+=g*m,K+=V>>>13,V&=8191,K=(K<<2)+K|0,K=K+Q|0,Q=K&8191,K=K>>>13,Y+=K,w=Q,_=Y,v=ae,S=L,R=I,A=D,U=u,E=y,O=q,g=V,f+=16,h-=16}this._h[0]=w,this._h[1]=_,this._h[2]=v,this._h[3]=S,this._h[4]=R,this._h[5]=A,this._h[6]=U,this._h[7]=E,this._h[8]=O,this._h[9]=g},o.prototype.finish=function(a,f){f===void 0&&(f=0);var h=new Uint16Array(10),l,w,_,v;if(this._leftover){for(v=this._leftover,this._buffer[v++]=1;v<16;v++)this._buffer[v]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,v=2;v<10;v++)this._h[v]+=l,l=this._h[v]>>>13,this._h[v]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,h[0]=this._h[0]+5,l=h[0]>>>13,h[0]&=8191,v=1;v<10;v++)h[v]=this._h[v]+l,l=h[v]>>>13,h[v]&=8191;for(h[9]-=1<<13,w=(l^1)-1,v=0;v<10;v++)h[v]&=w;for(w=~w,v=0;v<10;v++)this._h[v]=this._h[v]&w|h[v];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,_=this._h[0]+this._pad[0],this._h[0]=_&65535,v=1;v<8;v++)_=(this._h[v]+this._pad[v]|0)+(_>>>16)|0,this._h[v]=_&65535;return a[f+0]=this._h[0]>>>0,a[f+1]=this._h[0]>>>8,a[f+2]=this._h[1]>>>0,a[f+3]=this._h[1]>>>8,a[f+4]=this._h[2]>>>0,a[f+5]=this._h[2]>>>8,a[f+6]=this._h[3]>>>0,a[f+7]=this._h[3]>>>8,a[f+8]=this._h[4]>>>0,a[f+9]=this._h[4]>>>8,a[f+10]=this._h[5]>>>0,a[f+11]=this._h[5]>>>8,a[f+12]=this._h[6]>>>0,a[f+13]=this._h[6]>>>8,a[f+14]=this._h[7]>>>0,a[f+15]=this._h[7]>>>8,this._finished=!0,this},o.prototype.update=function(a){var f=0,h=a.length,l;if(this._leftover){l=16-this._leftover,l>h&&(l=h);for(var w=0;w<l;w++)this._buffer[this._leftover+w]=a[f+w];if(h-=l,f+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(h>=16&&(l=h-h%16,this._blocks(a,f,l),f+=l,h-=l),h){for(var w=0;w<h;w++)this._buffer[this._leftover+w]=a[f+w];this._leftover+=h}return this},o.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var a=new Uint8Array(16);return this.finish(a),a},o.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},o}();t.Poly1305=n;function i(o,a){var f=new n(o);f.update(a);var h=f.digest();return f.clean(),h}t.oneTimeAuth=i;function s(o,a){return o.length!==t.DIGEST_LENGTH||a.length!==t.DIGEST_LENGTH?!1:e.equal(o,a)}t.equal=s}(Uo),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=hn,r=Uo,n=_t,i=te,s=zt;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var o=new Uint8Array(16),a=function(){function f(h){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,h.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(h)}return f.prototype.seal=function(h,l,w,_){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var v=new Uint8Array(16);v.set(h,v.length-h.length);var S=new Uint8Array(32);e.stream(this._key,v,S,4);var R=l.length+this.tagLength,A;if(_){if(_.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");A=_}else A=new Uint8Array(R);return e.streamXOR(this._key,v,l,A,4),this._authenticate(A.subarray(A.length-this.tagLength,A.length),S,A.subarray(0,A.length-this.tagLength),w),n.wipe(v),A},f.prototype.open=function(h,l,w,_){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var v=new Uint8Array(16);v.set(h,v.length-h.length);var S=new Uint8Array(32);e.stream(this._key,v,S,4);var R=new Uint8Array(this.tagLength);if(this._authenticate(R,S,l.subarray(0,l.length-this.tagLength),w),!s.equal(R,l.subarray(l.length-this.tagLength,l.length)))return null;var A=l.length-this.tagLength,U;if(_){if(_.length!==A)throw new Error("ChaCha20Poly1305: incorrect destination length");U=_}else U=new Uint8Array(A);return e.streamXOR(this._key,v,l.subarray(0,l.length-this.tagLength),U,4),n.wipe(v),U},f.prototype.clean=function(){return n.wipe(this._key),this},f.prototype._authenticate=function(h,l,w,_){var v=new r.Poly1305(l);_&&(v.update(_),_.length%16>0&&v.update(o.subarray(_.length%16))),v.update(w),w.length%16>0&&v.update(o.subarray(w.length%16));var S=new Uint8Array(8);_&&i.writeUint64LE(_.length,S),v.update(S),i.writeUint64LE(w.length,S),v.update(S);for(var R=v.digest(),A=0;A<R.length;A++)h[A]=R[A];v.clean(),n.wipe(R),n.wipe(S)},f}();t.ChaCha20Poly1305=a}(pi);var jo={},Pr={},_i={};Object.defineProperty(_i,"__esModule",{value:!0});function qd(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}_i.isSerializableHash=qd,Object.defineProperty(Pr,"__esModule",{value:!0});var It=_i,Hd=zt,Vd=_t,zo=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),It.isSerializableHash(this._inner)&&It.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Vd.wipe(n)}return t.prototype.reset=function(){if(!It.isSerializableHash(this._inner)||!It.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){It.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),It.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!It.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!It.isSerializableHash(this._inner)||!It.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!It.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Pr.HMAC=zo;function Gd(t,e,r){var n=new zo(t,e);n.update(r);var i=n.digest();return n.clean(),i}Pr.hmac=Gd,Pr.equal=Hd.equal,Object.defineProperty(jo,"__esModule",{value:!0});var Bo=Pr,Ko=_t,Wd=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=Bo.hmac(this._hash,n,r);this._hmac=new Bo.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Ko.wipe(this._buffer),Ko.wipe(this._counter),this._bufpos=0},t}(),Yd=jo.HKDF=Wd,ln={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=_t;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},a.prototype.update=function(f,h){if(h===void 0&&(h=f.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&h>0;)this._buffer[this._bufferLength++]=f[l++],h--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(l=s(this._temp,this._state,f,l,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=f[l++],h--;return this},a.prototype.finish=function(f){if(!this._finished){var h=this._bytesHashed,l=this._bufferLength,w=h/536870912|0,_=h<<3,v=h%64<56?64:128;this._buffer[l]=128;for(var S=l+1;S<v-8;S++)this._buffer[S]=0;e.writeUint32BE(w,this._buffer,v-8),e.writeUint32BE(_,this._buffer,v-4),s(this._temp,this._state,this._buffer,0,v),this._finished=!0}for(var S=0;S<this.digestLength/4;S++)e.writeUint32BE(this._state[S],f,S*4);return this},a.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(f){return this._state.set(f.state),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(f){r.wipe(f.state),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},a}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(a,f,h,l,w){for(;w>=64;){for(var _=f[0],v=f[1],S=f[2],R=f[3],A=f[4],U=f[5],E=f[6],O=f[7],g=0;g<16;g++){var m=l+g*4;a[g]=e.readUint32BE(h,m)}for(var g=16;g<64;g++){var b=a[g-2],c=(b>>>17|b<<32-17)^(b>>>19|b<<32-19)^b>>>10;b=a[g-15];var p=(b>>>7|b<<32-7)^(b>>>18|b<<32-18)^b>>>3;a[g]=(c+a[g-7]|0)+(p+a[g-16]|0)}for(var g=0;g<64;g++){var c=(((A>>>6|A<<26)^(A>>>11|A<<21)^(A>>>25|A<<7))+(A&U^~A&E)|0)+(O+(i[g]+a[g]|0)|0)|0,p=((_>>>2|_<<32-2)^(_>>>13|_<<32-13)^(_>>>22|_<<32-22))+(_&v^_&S^v&S)|0;O=E,E=U,U=A,A=R+c|0,R=S,S=v,v=_,_=c+p|0}f[0]+=_,f[1]+=v,f[2]+=S,f[3]+=R,f[4]+=A,f[5]+=U,f[6]+=E,f[7]+=O,l+=64,w-=64}return l}function o(a){var f=new n;f.update(a);var h=f.digest();return f.clean(),h}t.hash=o})(ln);var yi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=lr,r=_t;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(g){const m=new Float64Array(16);if(g)for(let b=0;b<g.length;b++)m[b]=g[b];return m}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function o(g){let m=1;for(let b=0;b<16;b++){let c=g[b]+m+65535;m=Math.floor(c/65536),g[b]=c-m*65536}g[0]+=m-1+37*(m-1)}function a(g,m,b){const c=~(b-1);for(let p=0;p<16;p++){const F=c&(g[p]^m[p]);g[p]^=F,m[p]^=F}}function f(g,m){const b=n(),c=n();for(let p=0;p<16;p++)c[p]=m[p];o(c),o(c),o(c);for(let p=0;p<2;p++){b[0]=c[0]-65517;for(let z=1;z<15;z++)b[z]=c[z]-65535-(b[z-1]>>16&1),b[z-1]&=65535;b[15]=c[15]-32767-(b[14]>>16&1);const F=b[15]>>16&1;b[14]&=65535,a(c,b,1-F)}for(let p=0;p<16;p++)g[2*p]=c[p]&255,g[2*p+1]=c[p]>>8}function h(g,m){for(let b=0;b<16;b++)g[b]=m[2*b]+(m[2*b+1]<<8);g[15]&=32767}function l(g,m,b){for(let c=0;c<16;c++)g[c]=m[c]+b[c]}function w(g,m,b){for(let c=0;c<16;c++)g[c]=m[c]-b[c]}function _(g,m,b){let c,p,F=0,z=0,k=0,X=0,J=0,T=0,N=0,W=0,j=0,P=0,$=0,M=0,B=0,ne=0,K=0,Q=0,Y=0,ae=0,L=0,I=0,D=0,u=0,y=0,q=0,V=0,he=0,ye=0,de=0,we=0,je=0,Pe=0,_e=b[0],pe=b[1],le=b[2],ue=b[3],ce=b[4],oe=b[5],se=b[6],ee=b[7],fe=b[8],ge=b[9],re=b[10],ve=b[11],be=b[12],Ee=b[13],Se=b[14],me=b[15];c=m[0],F+=c*_e,z+=c*pe,k+=c*le,X+=c*ue,J+=c*ce,T+=c*oe,N+=c*se,W+=c*ee,j+=c*fe,P+=c*ge,$+=c*re,M+=c*ve,B+=c*be,ne+=c*Ee,K+=c*Se,Q+=c*me,c=m[1],z+=c*_e,k+=c*pe,X+=c*le,J+=c*ue,T+=c*ce,N+=c*oe,W+=c*se,j+=c*ee,P+=c*fe,$+=c*ge,M+=c*re,B+=c*ve,ne+=c*be,K+=c*Ee,Q+=c*Se,Y+=c*me,c=m[2],k+=c*_e,X+=c*pe,J+=c*le,T+=c*ue,N+=c*ce,W+=c*oe,j+=c*se,P+=c*ee,$+=c*fe,M+=c*ge,B+=c*re,ne+=c*ve,K+=c*be,Q+=c*Ee,Y+=c*Se,ae+=c*me,c=m[3],X+=c*_e,J+=c*pe,T+=c*le,N+=c*ue,W+=c*ce,j+=c*oe,P+=c*se,$+=c*ee,M+=c*fe,B+=c*ge,ne+=c*re,K+=c*ve,Q+=c*be,Y+=c*Ee,ae+=c*Se,L+=c*me,c=m[4],J+=c*_e,T+=c*pe,N+=c*le,W+=c*ue,j+=c*ce,P+=c*oe,$+=c*se,M+=c*ee,B+=c*fe,ne+=c*ge,K+=c*re,Q+=c*ve,Y+=c*be,ae+=c*Ee,L+=c*Se,I+=c*me,c=m[5],T+=c*_e,N+=c*pe,W+=c*le,j+=c*ue,P+=c*ce,$+=c*oe,M+=c*se,B+=c*ee,ne+=c*fe,K+=c*ge,Q+=c*re,Y+=c*ve,ae+=c*be,L+=c*Ee,I+=c*Se,D+=c*me,c=m[6],N+=c*_e,W+=c*pe,j+=c*le,P+=c*ue,$+=c*ce,M+=c*oe,B+=c*se,ne+=c*ee,K+=c*fe,Q+=c*ge,Y+=c*re,ae+=c*ve,L+=c*be,I+=c*Ee,D+=c*Se,u+=c*me,c=m[7],W+=c*_e,j+=c*pe,P+=c*le,$+=c*ue,M+=c*ce,B+=c*oe,ne+=c*se,K+=c*ee,Q+=c*fe,Y+=c*ge,ae+=c*re,L+=c*ve,I+=c*be,D+=c*Ee,u+=c*Se,y+=c*me,c=m[8],j+=c*_e,P+=c*pe,$+=c*le,M+=c*ue,B+=c*ce,ne+=c*oe,K+=c*se,Q+=c*ee,Y+=c*fe,ae+=c*ge,L+=c*re,I+=c*ve,D+=c*be,u+=c*Ee,y+=c*Se,q+=c*me,c=m[9],P+=c*_e,$+=c*pe,M+=c*le,B+=c*ue,ne+=c*ce,K+=c*oe,Q+=c*se,Y+=c*ee,ae+=c*fe,L+=c*ge,I+=c*re,D+=c*ve,u+=c*be,y+=c*Ee,q+=c*Se,V+=c*me,c=m[10],$+=c*_e,M+=c*pe,B+=c*le,ne+=c*ue,K+=c*ce,Q+=c*oe,Y+=c*se,ae+=c*ee,L+=c*fe,I+=c*ge,D+=c*re,u+=c*ve,y+=c*be,q+=c*Ee,V+=c*Se,he+=c*me,c=m[11],M+=c*_e,B+=c*pe,ne+=c*le,K+=c*ue,Q+=c*ce,Y+=c*oe,ae+=c*se,L+=c*ee,I+=c*fe,D+=c*ge,u+=c*re,y+=c*ve,q+=c*be,V+=c*Ee,he+=c*Se,ye+=c*me,c=m[12],B+=c*_e,ne+=c*pe,K+=c*le,Q+=c*ue,Y+=c*ce,ae+=c*oe,L+=c*se,I+=c*ee,D+=c*fe,u+=c*ge,y+=c*re,q+=c*ve,V+=c*be,he+=c*Ee,ye+=c*Se,de+=c*me,c=m[13],ne+=c*_e,K+=c*pe,Q+=c*le,Y+=c*ue,ae+=c*ce,L+=c*oe,I+=c*se,D+=c*ee,u+=c*fe,y+=c*ge,q+=c*re,V+=c*ve,he+=c*be,ye+=c*Ee,de+=c*Se,we+=c*me,c=m[14],K+=c*_e,Q+=c*pe,Y+=c*le,ae+=c*ue,L+=c*ce,I+=c*oe,D+=c*se,u+=c*ee,y+=c*fe,q+=c*ge,V+=c*re,he+=c*ve,ye+=c*be,de+=c*Ee,we+=c*Se,je+=c*me,c=m[15],Q+=c*_e,Y+=c*pe,ae+=c*le,L+=c*ue,I+=c*ce,D+=c*oe,u+=c*se,y+=c*ee,q+=c*fe,V+=c*ge,he+=c*re,ye+=c*ve,de+=c*be,we+=c*Ee,je+=c*Se,Pe+=c*me,F+=38*Y,z+=38*ae,k+=38*L,X+=38*I,J+=38*D,T+=38*u,N+=38*y,W+=38*q,j+=38*V,P+=38*he,$+=38*ye,M+=38*de,B+=38*we,ne+=38*je,K+=38*Pe,p=1,c=F+p+65535,p=Math.floor(c/65536),F=c-p*65536,c=z+p+65535,p=Math.floor(c/65536),z=c-p*65536,c=k+p+65535,p=Math.floor(c/65536),k=c-p*65536,c=X+p+65535,p=Math.floor(c/65536),X=c-p*65536,c=J+p+65535,p=Math.floor(c/65536),J=c-p*65536,c=T+p+65535,p=Math.floor(c/65536),T=c-p*65536,c=N+p+65535,p=Math.floor(c/65536),N=c-p*65536,c=W+p+65535,p=Math.floor(c/65536),W=c-p*65536,c=j+p+65535,p=Math.floor(c/65536),j=c-p*65536,c=P+p+65535,p=Math.floor(c/65536),P=c-p*65536,c=$+p+65535,p=Math.floor(c/65536),$=c-p*65536,c=M+p+65535,p=Math.floor(c/65536),M=c-p*65536,c=B+p+65535,p=Math.floor(c/65536),B=c-p*65536,c=ne+p+65535,p=Math.floor(c/65536),ne=c-p*65536,c=K+p+65535,p=Math.floor(c/65536),K=c-p*65536,c=Q+p+65535,p=Math.floor(c/65536),Q=c-p*65536,F+=p-1+37*(p-1),p=1,c=F+p+65535,p=Math.floor(c/65536),F=c-p*65536,c=z+p+65535,p=Math.floor(c/65536),z=c-p*65536,c=k+p+65535,p=Math.floor(c/65536),k=c-p*65536,c=X+p+65535,p=Math.floor(c/65536),X=c-p*65536,c=J+p+65535,p=Math.floor(c/65536),J=c-p*65536,c=T+p+65535,p=Math.floor(c/65536),T=c-p*65536,c=N+p+65535,p=Math.floor(c/65536),N=c-p*65536,c=W+p+65535,p=Math.floor(c/65536),W=c-p*65536,c=j+p+65535,p=Math.floor(c/65536),j=c-p*65536,c=P+p+65535,p=Math.floor(c/65536),P=c-p*65536,c=$+p+65535,p=Math.floor(c/65536),$=c-p*65536,c=M+p+65535,p=Math.floor(c/65536),M=c-p*65536,c=B+p+65535,p=Math.floor(c/65536),B=c-p*65536,c=ne+p+65535,p=Math.floor(c/65536),ne=c-p*65536,c=K+p+65535,p=Math.floor(c/65536),K=c-p*65536,c=Q+p+65535,p=Math.floor(c/65536),Q=c-p*65536,F+=p-1+37*(p-1),g[0]=F,g[1]=z,g[2]=k,g[3]=X,g[4]=J,g[5]=T,g[6]=N,g[7]=W,g[8]=j,g[9]=P,g[10]=$,g[11]=M,g[12]=B,g[13]=ne,g[14]=K,g[15]=Q}function v(g,m){_(g,m,m)}function S(g,m){const b=n();for(let c=0;c<16;c++)b[c]=m[c];for(let c=253;c>=0;c--)v(b,b),c!==2&&c!==4&&_(b,b,m);for(let c=0;c<16;c++)g[c]=b[c]}function R(g,m){const b=new Uint8Array(32),c=new Float64Array(80),p=n(),F=n(),z=n(),k=n(),X=n(),J=n();for(let j=0;j<31;j++)b[j]=g[j];b[31]=g[31]&127|64,b[0]&=248,h(c,m);for(let j=0;j<16;j++)F[j]=c[j];p[0]=k[0]=1;for(let j=254;j>=0;--j){const P=b[j>>>3]>>>(j&7)&1;a(p,F,P),a(z,k,P),l(X,p,z),w(p,p,z),l(z,F,k),w(F,F,k),v(k,X),v(J,p),_(p,z,p),_(z,F,X),l(X,p,z),w(p,p,z),v(F,p),w(z,k,J),_(p,z,s),l(p,p,k),_(z,z,p),_(p,k,J),_(k,F,c),v(F,X),a(p,F,P),a(z,k,P)}for(let j=0;j<16;j++)c[j+16]=p[j],c[j+32]=z[j],c[j+48]=F[j],c[j+64]=k[j];const T=c.subarray(32),N=c.subarray(16);S(T,T),_(N,N,T);const W=new Uint8Array(32);return f(W,N),W}t.scalarMult=R;function A(g){return R(g,i)}t.scalarMultBase=A;function U(g){if(g.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const m=new Uint8Array(g);return{publicKey:A(m),secretKey:m}}t.generateKeyPairFromSeed=U;function E(g){const m=(0,e.randomBytes)(32,g),b=U(m);return(0,r.wipe)(m),b}t.generateKeyPair=E;function O(g,m,b=!1){if(g.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(m.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=R(g,m);if(b){let p=0;for(let F=0;F<c.length;F++)p|=c[F];if(p===0)throw new Error("X25519: invalid shared key")}return c}t.sharedKey=O})(yi);var qo=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},kd=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),Xd=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Jd=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),Zd=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Qd=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),ep=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,tp=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ho=3,rp=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",ep]],Vo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function np(t){return t?Go(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Qd:typeof navigator<"u"?Go(navigator.userAgent):op()}function ip(t){return t!==""&&rp.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function Go(t){var e=ip(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new Zd;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Ho&&(i=qo(qo([],i,!0),ap(Ho-i.length),!0)):i=[];var s=i.join("."),o=sp(t),a=tp.exec(t);return a&&a[1]?new Jd(r,s,o,a[1]):new kd(r,s,o)}function sp(t){for(var e=0,r=Vo.length;e<r;e++){var n=Vo[e],i=n[0],s=n[1],o=s.exec(t);if(o)return i}return null}function op(){var t=typeof process<"u"&&process.version;return t?new Xd(process.version.slice(1)):null}function ap(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.getLocalStorage=Ne.getLocalStorageOrThrow=Ne.getCrypto=Ne.getCryptoOrThrow=Yo=Ne.getLocation=Ne.getLocationOrThrow=vi=Ne.getNavigator=Ne.getNavigatorOrThrow=Wo=Ne.getDocument=Ne.getDocumentOrThrow=Ne.getFromWindowOrThrow=Ne.getFromWindow=void 0;function Qt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ne.getFromWindow=Qt;function dr(t){const e=Qt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ne.getFromWindowOrThrow=dr;function cp(){return dr("document")}Ne.getDocumentOrThrow=cp;function up(){return Qt("document")}var Wo=Ne.getDocument=up;function fp(){return dr("navigator")}Ne.getNavigatorOrThrow=fp;function hp(){return Qt("navigator")}var vi=Ne.getNavigator=hp;function lp(){return dr("location")}Ne.getLocationOrThrow=lp;function dp(){return Qt("location")}var Yo=Ne.getLocation=dp;function pp(){return dr("crypto")}Ne.getCryptoOrThrow=pp;function gp(){return Qt("crypto")}Ne.getCrypto=gp;function _p(){return dr("localStorage")}Ne.getLocalStorageOrThrow=_p;function yp(){return Qt("localStorage")}Ne.getLocalStorage=yp;var bi={};Object.defineProperty(bi,"__esModule",{value:!0});var ko=bi.getWindowMetadata=void 0;const Xo=Ne;function vp(){let t,e;try{t=Xo.getDocumentOrThrow(),e=Xo.getLocationOrThrow()}catch{return null}function r(){const w=t.getElementsByTagName("link"),_=[];for(let v=0;v<w.length;v++){const S=w[v],R=S.getAttribute("rel");if(R&&R.toLowerCase().indexOf("icon")>-1){const A=S.getAttribute("href");if(A)if(A.toLowerCase().indexOf("https:")===-1&&A.toLowerCase().indexOf("http:")===-1&&A.indexOf("//")!==0){let U=e.protocol+"//"+e.host;if(A.indexOf("/")===0)U+=A;else{const E=e.pathname.split("/");E.pop();const O=E.join("/");U+=O+"/"+A}_.push(U)}else if(A.indexOf("//")===0){const U=e.protocol+A;_.push(U)}else _.push(A)}}return _}function n(...w){const _=t.getElementsByTagName("meta");for(let v=0;v<_.length;v++){const S=_[v],R=["itemprop","property","name"].map(A=>S.getAttribute(A)).filter(A=>A?w.includes(A):!1);if(R.length&&R){const A=S.getAttribute("content");if(A)return A}}return""}function i(){let w=n("name","og:site_name","og:title","twitter:title");return w||(w=t.title),w}function s(){return n("description","og:description","twitter:description","keywords")}const o=i(),a=s(),f=e.origin,h=r();return{description:a,url:f,icons:h,name:o}}ko=bi.getWindowMetadata=vp;var Fr={},bp=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Jo="%[a-f0-9]{2}",Zo=new RegExp(Jo,"gi"),Qo=new RegExp("("+Jo+")+","gi");function wi(t,e){try{return decodeURIComponent(t.join(""))}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],wi(r),wi(n))}function wp(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Zo),r=1;r<e.length;r++)t=wi(e,r).join(""),e=t.match(Zo);return t}}function mp(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Qo.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=wp(r[0]);n!==r[0]&&(e[r[0]]=n)}r=Qo.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var o=i[s];t=t.replace(new RegExp(o,"g"),e[o])}return t}var Ep=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return mp(t)}},Sp=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},Dp=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var o=n[s],a=t[o];(i?e.indexOf(o)!==-1:e(o,a,t))&&(r[o]=a)}return r};(function(t){const e=bp,r=Ep,n=Sp,i=Dp,s=E=>E==null,o=Symbol("encodeFragmentIdentifier");function a(E){switch(E.arrayFormat){case"index":return O=>(g,m)=>{const b=g.length;return m===void 0||E.skipNull&&m===null||E.skipEmptyString&&m===""?g:m===null?[...g,[l(O,E),"[",b,"]"].join("")]:[...g,[l(O,E),"[",l(b,E),"]=",l(m,E)].join("")]};case"bracket":return O=>(g,m)=>m===void 0||E.skipNull&&m===null||E.skipEmptyString&&m===""?g:m===null?[...g,[l(O,E),"[]"].join("")]:[...g,[l(O,E),"[]=",l(m,E)].join("")];case"colon-list-separator":return O=>(g,m)=>m===void 0||E.skipNull&&m===null||E.skipEmptyString&&m===""?g:m===null?[...g,[l(O,E),":list="].join("")]:[...g,[l(O,E),":list=",l(m,E)].join("")];case"comma":case"separator":case"bracket-separator":{const O=E.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(m,b)=>b===void 0||E.skipNull&&b===null||E.skipEmptyString&&b===""?m:(b=b===null?"":b,m.length===0?[[l(g,E),O,l(b,E)].join("")]:[[m,l(b,E)].join(E.arrayFormatSeparator)])}default:return O=>(g,m)=>m===void 0||E.skipNull&&m===null||E.skipEmptyString&&m===""?g:m===null?[...g,l(O,E)]:[...g,[l(O,E),"=",l(m,E)].join("")]}}function f(E){let O;switch(E.arrayFormat){case"index":return(g,m,b)=>{if(O=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!O){b[g]=m;return}b[g]===void 0&&(b[g]={}),b[g][O[1]]=m};case"bracket":return(g,m,b)=>{if(O=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!O){b[g]=m;return}if(b[g]===void 0){b[g]=[m];return}b[g]=[].concat(b[g],m)};case"colon-list-separator":return(g,m,b)=>{if(O=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!O){b[g]=m;return}if(b[g]===void 0){b[g]=[m];return}b[g]=[].concat(b[g],m)};case"comma":case"separator":return(g,m,b)=>{const c=typeof m=="string"&&m.includes(E.arrayFormatSeparator),p=typeof m=="string"&&!c&&w(m,E).includes(E.arrayFormatSeparator);m=p?w(m,E):m;const F=c||p?m.split(E.arrayFormatSeparator).map(z=>w(z,E)):m===null?m:w(m,E);b[g]=F};case"bracket-separator":return(g,m,b)=>{const c=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!c){b[g]=m&&w(m,E);return}const p=m===null?[]:m.split(E.arrayFormatSeparator).map(F=>w(F,E));if(b[g]===void 0){b[g]=p;return}b[g]=[].concat(b[g],p)};default:return(g,m,b)=>{if(b[g]===void 0){b[g]=m;return}b[g]=[].concat(b[g],m)}}}function h(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(E,O){return O.encode?O.strict?e(E):encodeURIComponent(E):E}function w(E,O){return O.decode?r(E):E}function _(E){return Array.isArray(E)?E.sort():typeof E=="object"?_(Object.keys(E)).sort((O,g)=>Number(O)-Number(g)).map(O=>E[O]):E}function v(E){const O=E.indexOf("#");return O!==-1&&(E=E.slice(0,O)),E}function S(E){let O="";const g=E.indexOf("#");return g!==-1&&(O=E.slice(g)),O}function R(E){E=v(E);const O=E.indexOf("?");return O===-1?"":E.slice(O+1)}function A(E,O){return O.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):O.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function U(E,O){O=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},O),h(O.arrayFormatSeparator);const g=f(O),m=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return m;for(const b of E.split("&")){if(b==="")continue;let[c,p]=n(O.decode?b.replace(/\+/g," "):b,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(O.arrayFormat)?p:w(p,O),g(w(c,O),p,m)}for(const b of Object.keys(m)){const c=m[b];if(typeof c=="object"&&c!==null)for(const p of Object.keys(c))c[p]=A(c[p],O);else m[b]=A(c,O)}return O.sort===!1?m:(O.sort===!0?Object.keys(m).sort():Object.keys(m).sort(O.sort)).reduce((b,c)=>{const p=m[c];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?b[c]=_(p):b[c]=p,b},Object.create(null))}t.extract=R,t.parse=U,t.stringify=(E,O)=>{if(!E)return"";O=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},O),h(O.arrayFormatSeparator);const g=p=>O.skipNull&&s(E[p])||O.skipEmptyString&&E[p]==="",m=a(O),b={};for(const p of Object.keys(E))g(p)||(b[p]=E[p]);const c=Object.keys(b);return O.sort!==!1&&c.sort(O.sort),c.map(p=>{const F=E[p];return F===void 0?"":F===null?l(p,O):Array.isArray(F)?F.length===0&&O.arrayFormat==="bracket-separator"?l(p,O)+"[]":F.reduce(m(p),[]).join("&"):l(p,O)+"="+l(F,O)}).filter(p=>p.length>0).join("&")},t.parseUrl=(E,O)=>{O=Object.assign({decode:!0},O);const[g,m]=n(E,"#");return Object.assign({url:g.split("?")[0]||"",query:U(R(E),O)},O&&O.parseFragmentIdentifier&&m?{fragmentIdentifier:w(m,O)}:{})},t.stringifyUrl=(E,O)=>{O=Object.assign({encode:!0,strict:!0,[o]:!0},O);const g=v(E.url).split("?")[0]||"",m=t.extract(E.url),b=t.parse(m,{sort:!1}),c=Object.assign(b,E.query);let p=t.stringify(c,O);p&&(p=`?${p}`);let F=S(E.url);return E.fragmentIdentifier&&(F=`#${O[o]?l(E.fragmentIdentifier,O):E.fragmentIdentifier}`),`${g}${p}${F}`},t.pick=(E,O,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[o]:!1},g);const{url:m,query:b,fragmentIdentifier:c}=t.parseUrl(E,g);return t.stringifyUrl({url:m,query:i(b,O),fragmentIdentifier:c},g)},t.exclude=(E,O,g)=>{const m=Array.isArray(O)?b=>!O.includes(b):(b,c)=>!O(b,c);return t.pick(E,m,g)}})(Fr);const xp={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},ea="base10",dt="base16",mi="base64pad",Ei="utf8",ta=0,er=1,Op=0,ra=1,Si=12,Di=32;function Ip(){const t=yi.generateKeyPair();return{privateKey:ht(t.secretKey,dt),publicKey:ht(t.publicKey,dt)}}function xi(){const t=lr.randomBytes(Di);return ht(t,dt)}function Lp(t,e){const r=yi.sharedKey(lt(t,dt),lt(e,dt)),n=new Yd(ln.SHA256,r).expand(Di);return ht(n,dt)}function Np(t){const e=ln.hash(lt(t,dt));return ht(e,dt)}function Oi(t){const e=ln.hash(lt(t,Ei));return ht(e,dt)}function Tp(t){return lt(`${t}`,ea)}function $r(t){return Number(ht(t,ea))}function Ap(t){const e=Tp(typeof t.type<"u"?t.type:ta);if($r(e)===er&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?lt(t.senderPublicKey,dt):void 0,n=typeof t.iv<"u"?lt(t.iv,dt):lr.randomBytes(Si),i=new pi.ChaCha20Poly1305(lt(t.symKey,dt)).seal(n,lt(t.message,Ei));return Cp({type:e,sealed:i,iv:n,senderPublicKey:r})}function Rp(t){const e=new pi.ChaCha20Poly1305(lt(t.symKey,dt)),{sealed:r,iv:n}=Ii(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return ht(i,Ei)}function Cp(t){if($r(t.type)===er){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ht(fi([t.type,t.senderPublicKey,t.iv,t.sealed]),mi)}return ht(fi([t.type,t.iv,t.sealed]),mi)}function Ii(t){const e=lt(t,mi),r=e.slice(Op,ra),n=ra;if($r(r)===er){const a=n+Di,f=a+Si,h=e.slice(n,a),l=e.slice(a,f),w=e.slice(f);return{type:r,sealed:w,iv:l,senderPublicKey:h}}const i=n+Si,s=e.slice(n,i),o=e.slice(i);return{type:r,sealed:o,iv:s}}function Pp(t,e){const r=Ii(t);return na({type:$r(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ht(r.senderPublicKey,dt):void 0,receiverPublicKey:e?.receiverPublicKey})}function na(t){const e=t?.type||ta;if(e===er){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function ia(t){return t.type===er&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Fp=Object.defineProperty,sa=Object.getOwnPropertySymbols,$p=Object.prototype.hasOwnProperty,Up=Object.prototype.propertyIsEnumerable,oa=(t,e,r)=>e in t?Fp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,aa=(t,e)=>{for(var r in e||(e={}))$p.call(e,r)&&oa(t,r,e[r]);if(sa)for(var r of sa(e))Up.call(e,r)&&oa(t,r,e[r]);return t};const Mp="ReactNative",Ur={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},jp="js";function ca(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function zp(){return!Wo()&&!!vi()&&navigator.product===Mp}function Bp(){return!ca()&&!!vi()}function Kp(){return zp()?Ur.reactNative:ca()?Ur.node:Bp()?Ur.browser:Ur.unknown}function qp(t,e){let r=Fr.parse(t);return r=aa(aa({},r),e),t=Fr.stringify(r),t}function Hp(){return ko()||{name:"",description:"",url:"",icons:[""]}}function Vp(){const t=np();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Gp(){var t;const e=Kp();return e===Ur.browser?[e,((t=Yo())==null?void 0:t.host)||"unknown"].join(":"):e}function Wp(t,e,r){const n=Vp(),i=Gp();return[[t,e].join("-"),[jp,r].join("-"),n,i].join("/")}function Yp({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const o=r.split("?"),a=Wp(t,e,n),f={auth:i,ua:a,projectId:s},h=qp(o[1]||"",f);return o[0]+"?"+h}function pt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function ua(t){return Object.fromEntries(t.entries())}function fa(t){return new Map(Object.entries(t))}function Lt(t,e){return Z.fromMiliseconds((e||Date.now())+Z.toMiliseconds(t))}function Bt(t){return Z.fromMiliseconds(Date.now())>=Z.toMiliseconds(t)}function tr(t){const e=Z.toMiliseconds(t||Z.FIVE_MINUTES);let r,n,i;return{resolve:s=>{i&&r&&(clearTimeout(i),r(s))},reject:s=>{i&&n&&(clearTimeout(i),n(s))},done:()=>new Promise((s,o)=>{i=setTimeout(o,e),r=s,n=o})}}function ha(t,e){return new Promise(async(r,n)=>{const i=setTimeout(()=>n(),e),s=await t;clearTimeout(i),r(s)})}function la(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function kp(t){return la("topic",t)}function Xp(t){return la("id",t)}function da(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Me(t,e){return`${t}${e?`:${e}`:""}`}const Jp="irn";function Li(t){return t?.relay||{protocol:Jp}}function Ni(t){const e=xp[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Zp=Object.defineProperty,pa=Object.getOwnPropertySymbols,Qp=Object.prototype.hasOwnProperty,eg=Object.prototype.propertyIsEnumerable,ga=(t,e,r)=>e in t?Zp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,tg=(t,e)=>{for(var r in e||(e={}))Qp.call(e,r)&&ga(t,r,e[r]);if(pa)for(var r of pa(e))eg.call(e,r)&&ga(t,r,e[r]);return t};function rg(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=t[i];r[s]=o}}),r}function ng(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=Fr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:o.symKey,relay:rg(o)}}function ig(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function sg(t){return`${t.protocol}:${t.topic}@${t.version}?`+Fr.stringify(tg({symKey:t.symKey},ig(t.relay)))}function Nt(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}function og(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Nt(r.accounts)),r.extension&&r.extension.forEach(n=>{e.push(...Nt(n.accounts))})}),e}function ag(t,e){const r=[];return Object.values(t).forEach(n=>{Nt(n.accounts).includes(e)&&r.push(...n.methods),n.extension&&n.extension.forEach(i=>{Nt(i.accounts).includes(e)&&r.push(...i.methods)})}),r}function cg(t,e){const r=[];return Object.values(t).forEach(n=>{Nt(n.accounts).includes(e)&&r.push(...n.events),n.extension&&n.extension.forEach(i=>{Nt(i.accounts).includes(e)&&r.push(...i.events)})}),r}function ug(t,e){const r=pn(t,e);if(r)throw new Error(r.message);const n={};for(const[i,s]of Object.entries(t))n[i]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return n}const fg={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},hg={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function H(t,e){const{message:r,code:n}=hg[t];return{message:e?`${r} ${e}`:r,code:n}}function Ge(t,e){const{message:r,code:n}=fg[t];return{message:e?`${r} ${e}`:r,code:n}}function Mr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function dn(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function yt(t){return typeof t>"u"}function nt(t,e){return e&&yt(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function Ti(t,e){return e&&yt(t)?!0:typeof t=="number"&&!isNaN(t)}function lg(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let s=!0;return pt(i,n)?(n.forEach(o=>{const{accounts:a,methods:f,events:h,extension:l}=t.namespaces[o],w=Nt(a),_=r[o];(!pt(_.chains,w)||!pt(_.methods,f)||!pt(_.events,h))&&(s=!1),s&&l&&l.forEach(v=>{var S;const{accounts:R,methods:A,events:U}=v,E=Nt(R);(S=_.extension)!=null&&S.find(O=>pt(O.chains,E)&&pt(O.methods,A)&&pt(O.events,U))||(s=!1)})}),s):!1}function Ai(t){return nt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function dg(t){if(nt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Ai(r)}}return!1}function pg(t){if(nt(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function gg(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function _g(t){return t?.topic}function yg(t,e){let r=null;return nt(t?.publicKey,!1)||(r=H("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Ri(t,e){let r=null;return yt(t?.extension)||(!Mr(t.extension)||!t.extension.length)&&(r=H("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function _a(t){let e=!0;return Mr(t)?t.length&&(e=t.every(r=>nt(r,!1))):e=!1,e}function ya(t,e,r){let n=null;return Mr(e)?e.forEach(i=>{n||(!Ai(i)||!i.includes(t))&&(n=Ge("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Ge("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),n}function vg(t,e){let r=null;return Object.entries(t).forEach(([n,i])=>{if(r)return;const s=ya(n,i?.chains,`${e} requiredNamespace`),o=Ri(i,e);s?r=s:o?r=o:i.extension&&i.extension.forEach(a=>{if(r)return;const f=ya(n,a.chains,`${e} extension`);f&&(r=f)})}),r}function va(t,e){let r=null;return Mr(t)?t.forEach(n=>{r||dg(n)||(r=Ge("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Ge("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function bg(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=va(n?.accounts,`${e} namespace`),s=Ri(n,e);i?r=i:s?r=s:n.extension&&n.extension.forEach(o=>{if(r)return;const a=va(o.accounts,`${e} extension`);a&&(r=a)})}),r}function ba(t,e){let r=null;return _a(t?.methods)?_a(t?.events)||(r=Ge("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Ge("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function wa(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=ba(n,`${e}, namespace`),s=Ri(n,e);i?r=i:s?r=s:n.extension&&n.extension.forEach(o=>{if(r)return;const a=ba(o,`${e}, extension`);a&&(r=a)})}),r}function wg(t,e){let r=null;if(t&&dn(t)){const n=wa(t,e);n&&(r=n);const i=vg(t,e);i&&(r=i)}else r=H("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function pn(t,e){let r=null;if(t&&dn(t)){const n=wa(t,e);n&&(r=n);const i=bg(t,e);i&&(r=i)}else r=H("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function ma(t){return nt(t.protocol,!0)}function mg(t,e){let r=!1;return e&&!t?r=!0:t&&Mr(t)&&t.length&&t.forEach(n=>{r=ma(n)}),r}function Eg(t){return typeof t=="number"}function gt(t){return typeof t<"u"&&typeof t!==null}function Sg(t){return!(!t||typeof t!="object"||!t.code||!Ti(t.code,!1)||!t.message||!nt(t.message,!1))}function Dg(t){return!(yt(t)||!nt(t.method,!1))}function xg(t){return!(yt(t)||yt(t.result)&&yt(t.error)||!Ti(t.id,!1)||!nt(t.jsonrpc,!1))}function Og(t){return!(yt(t)||!nt(t.name,!1))}function Ea(t,e){return!(!Ai(e)||!og(t).includes(e))}function Ig(t,e,r){return nt(r,!1)?ag(t,e).includes(r):!1}function Lg(t,e,r){return nt(r,!1)?cg(t,e).includes(r):!1}function Sa(t,e,r){let n=null;const i=Object.keys(t),s=Object.keys(e);return pt(i,s)?i.forEach(o=>{var a;if(n)return;const f=t[o].chains,h=Nt(e[o].accounts);pt(f,h)?pt(t[o].methods,e[o].methods)?pt(t[o].events,e[o].events)?t[o].extension&&!e[o].extension?n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${o}`):t[o].extension&&e[o].extension&&((a=t[o].extension)==null||a.forEach(({methods:l,events:w,chains:_})=>{var v;n||(v=e[o].extension)!=null&&v.find(S=>{const R=Nt(S.accounts);return pt(_,R)&&pt(w,S.events)&&pt(l,S.methods)})||(n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${o}`))})):n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${o}`):n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${o}`):n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${o}`)}):n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),n}function Ng(t,e){return Ti(t,!1)&&t<=e.max&&t>=e.min}var Tg=Ss();const Ag="PARSE_ERROR",Rg="INVALID_REQUEST",Cg="METHOD_NOT_FOUND",Pg="INVALID_PARAMS",Da="INTERNAL_ERROR",Ci="SERVER_ERROR",Fg=[-32700,-32600,-32601,-32602,-32603],jr={[Ag]:{code:-32700,message:"Parse error"},[Rg]:{code:-32600,message:"Invalid Request"},[Cg]:{code:-32601,message:"Method not found"},[Pg]:{code:-32602,message:"Invalid params"},[Da]:{code:-32603,message:"Internal error"},[Ci]:{code:-32e3,message:"Server error"}},xa=Ci;function $g(t){return Fg.includes(t)}function Oa(t){return Object.keys(jr).includes(t)?jr[t]:jr[xa]}function Ug(t){const e=Object.values(jr).find(r=>r.code===t);return e||jr[xa]}function Mg(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Ia={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Pi=function(t,e){return Pi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Pi(t,e)};function jg(t,e){Pi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Fi=function(){return Fi=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fi.apply(this,arguments)};function zg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Bg(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Kg(t,e){return function(r,n){e(r,n,t)}}function qg(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Hg(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(w){o(w)}}function f(l){try{h(n.throw(l))}catch(w){o(w)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function Vg(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Gg(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Wg(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function $i(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function La(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Yg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(La(arguments[e]));return t}function kg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function zr(t){return this instanceof zr?(this.v=t,this):new zr(t)}function Xg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(_){n[_]&&(i[_]=function(v){return new Promise(function(S,R){s.push([_,v,S,R])>1||a(_,v)})})}function a(_,v){try{f(n[_](v))}catch(S){w(s[0][3],S)}}function f(_){_.value instanceof zr?Promise.resolve(_.value.v).then(h,l):w(s[0][2],_)}function h(_){a("next",_)}function l(_){a("throw",_)}function w(_,v){_(v),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Jg(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:zr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Zg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof $i=="function"?$i(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function Qg(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function e_(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function t_(t){return t&&t.__esModule?t:{default:t}}function r_(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function n_(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var i_=Object.freeze({__proto__:null,__extends:jg,get __assign(){return Fi},__rest:zg,__decorate:Bg,__param:Kg,__metadata:qg,__awaiter:Hg,__generator:Vg,__createBinding:Gg,__exportStar:Wg,__values:$i,__read:La,__spread:Yg,__spreadArrays:kg,__await:zr,__asyncGenerator:Xg,__asyncDelegator:Jg,__asyncValues:Zg,__makeTemplateObject:Qg,__importStar:e_,__importDefault:t_,__classPrivateFieldGet:r_,__classPrivateFieldSet:n_}),s_=Wt(i_),Pt={},Na;function o_(){if(Na)return Pt;Na=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.isBrowserCryptoAvailable=Pt.getSubtleCrypto=Pt.getBrowerCrypto=void 0;function t(){return tt?.crypto||tt?.msCrypto||{}}Pt.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Pt.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Pt.isBrowserCryptoAvailable=r,Pt}var Ft={},Ta;function a_(){if(Ta)return Ft;Ta=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.isBrowser=Ft.isNode=Ft.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Ft.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Ft.isNode=e;function r(){return!t()&&!e()}return Ft.isBrowser=r,Ft}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=s_;e.__exportStar(o_(),t),e.__exportStar(a_(),t)})(Ia);function c_(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function gn(t,e,r){return{id:r||c_(),jsonrpc:"2.0",method:t,params:e}}function Ui(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Mi(t,e,r){return{id:t,jsonrpc:"2.0",error:u_(e,r)}}function u_(t,e){return typeof t>"u"?Oa(Da):(typeof t=="string"&&(t=Object.assign(Object.assign({},Oa(Ci)),{message:t})),typeof e<"u"&&(t.data=e),$g(t.code)&&(t=Ug(t.code)),t)}class f_{}class h_ extends f_{constructor(){super()}}class l_ extends h_{constructor(e){super()}}const d_="^wss?:";function p_(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function g_(t,e){const r=p_(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Aa(t){return g_(t,d_)}function __(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Ra(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function ji(t){return Ra(t)&&"method"in t}function zi(t){return Ra(t)&&($t(t)||St(t))}function $t(t){return"result"in t}function St(t){return"error"in t}class y_ extends l_{constructor(e){super(e),this.events=new Tg.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(gn(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{St(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),zi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}var Bi={exports:{}},pr=typeof Reflect=="object"?Reflect:null,Ca=pr&&typeof pr.apply=="function"?pr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},_n;pr&&typeof pr.ownKeys=="function"?_n=pr.ownKeys:Object.getOwnPropertySymbols?_n=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:_n=function(e){return Object.getOwnPropertyNames(e)};function v_(t){console&&console.warn&&console.warn(t)}var Pa=Number.isNaN||function(e){return e!==e};function Ie(){Ie.init.call(this)}Bi.exports=Ie,Bi.exports.once=E_,Ie.EventEmitter=Ie,Ie.prototype._events=void 0,Ie.prototype._eventsCount=0,Ie.prototype._maxListeners=void 0;var Fa=10;function yn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ie,"defaultMaxListeners",{enumerable:!0,get:function(){return Fa},set:function(t){if(typeof t!="number"||t<0||Pa(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Fa=t}}),Ie.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ie.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Pa(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function $a(t){return t._maxListeners===void 0?Ie.defaultMaxListeners:t._maxListeners}Ie.prototype.getMaxListeners=function(){return $a(this)},Ie.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")Ca(f,this,r);else for(var h=f.length,l=Ba(f,h),n=0;n<h;++n)Ca(l[n],this,r);return!0};function Ua(t,e,r,n){var i,s,o;if(yn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=$a(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,v_(a)}return t}Ie.prototype.addListener=function(e,r){return Ua(this,e,r,!1)},Ie.prototype.on=Ie.prototype.addListener,Ie.prototype.prependListener=function(e,r){return Ua(this,e,r,!0)};function b_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ma(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=b_.bind(n);return i.listener=r,n.wrapFn=i,i}Ie.prototype.once=function(e,r){return yn(r),this.on(e,Ma(this,e,r)),this},Ie.prototype.prependOnceListener=function(e,r){return yn(r),this.prependListener(e,Ma(this,e,r)),this},Ie.prototype.removeListener=function(e,r){var n,i,s,o,a;if(yn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():w_(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Ie.prototype.off=Ie.prototype.removeListener,Ie.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function ja(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?m_(i):Ba(i,i.length)}Ie.prototype.listeners=function(e){return ja(this,e,!0)},Ie.prototype.rawListeners=function(e){return ja(this,e,!1)},Ie.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):za.call(t,e)},Ie.prototype.listenerCount=za;function za(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ie.prototype.eventNames=function(){return this._eventsCount>0?_n(this._events):[]};function Ba(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function w_(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function m_(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function E_(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Ka(t,e,s,{once:!0}),e!=="error"&&S_(t,i,{once:!0})})}function S_(t,e,r){typeof t.on=="function"&&Ka(t,"error",e,r)}function Ka(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const qa=10,D_=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),x_=()=>typeof window<"u",O_=D_();class I_{constructor(e){if(this.url=e,this.events=new Bi.exports.EventEmitter,this.registering=!1,!Aa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ii(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!Aa(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Ia.isReactNative()?void 0:{rejectUnauthorized:!__(e)},s=new O_(e,[],i);x_()?s.onerror=o=>{const a=o;n(this.emitError(a.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?no(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=Mi(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return Mg(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>qa&&this.events.setMaxListeners(qa)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Ki={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,a="[object Arguments]",f="[object Array]",h="[object AsyncFunction]",l="[object Boolean]",w="[object Date]",_="[object Error]",v="[object Function]",S="[object GeneratorFunction]",R="[object Map]",A="[object Number]",U="[object Null]",E="[object Object]",O="[object Promise]",g="[object Proxy]",m="[object RegExp]",b="[object Set]",c="[object String]",p="[object Symbol]",F="[object Undefined]",z="[object WeakMap]",k="[object ArrayBuffer]",X="[object DataView]",J="[object Float32Array]",T="[object Float64Array]",N="[object Int8Array]",W="[object Int16Array]",j="[object Int32Array]",P="[object Uint8Array]",$="[object Uint8ClampedArray]",M="[object Uint16Array]",B="[object Uint32Array]",ne=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[T]=Y[N]=Y[W]=Y[j]=Y[P]=Y[$]=Y[M]=Y[B]=!0,Y[a]=Y[f]=Y[k]=Y[l]=Y[X]=Y[w]=Y[_]=Y[v]=Y[R]=Y[A]=Y[E]=Y[m]=Y[b]=Y[c]=Y[z]=!1;var ae=typeof tt=="object"&&tt&&tt.Object===Object&&tt,L=typeof self=="object"&&self&&self.Object===Object&&self,I=ae||L||Function("return this")(),D=e&&!e.nodeType&&e,u=D&&!0&&t&&!t.nodeType&&t,y=u&&u.exports===D,q=y&&ae.process,V=function(){try{return q&&q.binding&&q.binding("util")}catch{}}(),he=V&&V.isTypedArray;function ye(d,x){for(var C=-1,G=d==null?0:d.length,Ae=0,ie=[];++C<G;){var Ue=d[C];x(Ue,C,d)&&(ie[Ae++]=Ue)}return ie}function de(d,x){for(var C=-1,G=x.length,Ae=d.length;++C<G;)d[Ae+C]=x[C];return d}function we(d,x){for(var C=-1,G=d==null?0:d.length;++C<G;)if(x(d[C],C,d))return!0;return!1}function je(d,x){for(var C=-1,G=Array(d);++C<d;)G[C]=x(C);return G}function Pe(d){return function(x){return d(x)}}function _e(d,x){return d.has(x)}function pe(d,x){return d?.[x]}function le(d){var x=-1,C=Array(d.size);return d.forEach(function(G,Ae){C[++x]=[Ae,G]}),C}function ue(d,x){return function(C){return d(x(C))}}function ce(d){var x=-1,C=Array(d.size);return d.forEach(function(G){C[++x]=G}),C}var oe=Array.prototype,se=Function.prototype,ee=Object.prototype,fe=I["__core-js_shared__"],ge=se.toString,re=ee.hasOwnProperty,ve=function(){var d=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),be=ee.toString,Ee=RegExp("^"+ge.call(re).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Se=y?I.Buffer:void 0,me=I.Symbol,Dt=I.Uint8Array,Rt=ee.propertyIsEnumerable,qt=oe.splice,vt=me?me.toStringTag:void 0,rr=Object.getOwnPropertySymbols,Hr=Se?Se.isBuffer:void 0,Nn=ue(Object.keys,Object),ze=yr(I,"DataView"),Fe=yr(I,"Map"),Be=yr(I,"Promise"),Ke=yr(I,"Set"),qe=yr(I,"WeakMap"),$e=yr(Object,"create"),We=ir(ze),Ye=ir(Fe),ke=ir(Be),Xe=ir(Ke),Je=ir(qe),Ve=me?me.prototype:void 0,He=Ve?Ve.valueOf:void 0;function Re(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function Ze(){this.__data__=$e?$e(null):{},this.size=0}function Qe(d){var x=this.has(d)&&delete this.__data__[d];return this.size-=x?1:0,x}function w1(d){var x=this.__data__;if($e){var C=x[d];return C===n?void 0:C}return re.call(x,d)?x[d]:void 0}function m1(d){var x=this.__data__;return $e?x[d]!==void 0:re.call(x,d)}function E1(d,x){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=$e&&x===void 0?n:x,this}Re.prototype.clear=Ze,Re.prototype.delete=Qe,Re.prototype.get=w1,Re.prototype.has=m1,Re.prototype.set=E1;function Mt(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function S1(){this.__data__=[],this.size=0}function D1(d){var x=this.__data__,C=An(x,d);if(C<0)return!1;var G=x.length-1;return C==G?x.pop():qt.call(x,C,1),--this.size,!0}function x1(d){var x=this.__data__,C=An(x,d);return C<0?void 0:x[C][1]}function O1(d){return An(this.__data__,d)>-1}function I1(d,x){var C=this.__data__,G=An(C,d);return G<0?(++this.size,C.push([d,x])):C[G][1]=x,this}Mt.prototype.clear=S1,Mt.prototype.delete=D1,Mt.prototype.get=x1,Mt.prototype.has=O1,Mt.prototype.set=I1;function nr(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function L1(){this.size=0,this.__data__={hash:new Re,map:new(Fe||Mt),string:new Re}}function N1(d){var x=Rn(this,d).delete(d);return this.size-=x?1:0,x}function T1(d){return Rn(this,d).get(d)}function A1(d){return Rn(this,d).has(d)}function R1(d,x){var C=Rn(this,d),G=C.size;return C.set(d,x),this.size+=C.size==G?0:1,this}nr.prototype.clear=L1,nr.prototype.delete=N1,nr.prototype.get=T1,nr.prototype.has=A1,nr.prototype.set=R1;function Tn(d){var x=-1,C=d==null?0:d.length;for(this.__data__=new nr;++x<C;)this.add(d[x])}function C1(d){return this.__data__.set(d,n),this}function P1(d){return this.__data__.has(d)}Tn.prototype.add=Tn.prototype.push=C1,Tn.prototype.has=P1;function Ht(d){var x=this.__data__=new Mt(d);this.size=x.size}function F1(){this.__data__=new Mt,this.size=0}function $1(d){var x=this.__data__,C=x.delete(d);return this.size=x.size,C}function U1(d){return this.__data__.get(d)}function M1(d){return this.__data__.has(d)}function j1(d,x){var C=this.__data__;if(C instanceof Mt){var G=C.__data__;if(!Fe||G.length<r-1)return G.push([d,x]),this.size=++C.size,this;C=this.__data__=new nr(G)}return C.set(d,x),this.size=C.size,this}Ht.prototype.clear=F1,Ht.prototype.delete=$1,Ht.prototype.get=U1,Ht.prototype.has=M1,Ht.prototype.set=j1;function z1(d,x){var C=Cn(d),G=!C&&tv(d),Ae=!C&&!G&&Qi(d),ie=!C&&!G&&!Ae&&Gc(d),Ue=C||G||Ae||ie,et=Ue?je(d.length,String):[],st=et.length;for(var Ce in d)(x||re.call(d,Ce))&&!(Ue&&(Ce=="length"||Ae&&(Ce=="offset"||Ce=="parent")||ie&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||X1(Ce,st)))&&et.push(Ce);return et}function An(d,x){for(var C=d.length;C--;)if(Kc(d[C][0],x))return C;return-1}function B1(d,x,C){var G=x(d);return Cn(d)?G:de(G,C(d))}function Vr(d){return d==null?d===void 0?F:U:vt&&vt in Object(d)?Y1(d):ev(d)}function Mc(d){return Gr(d)&&Vr(d)==a}function jc(d,x,C,G,Ae){return d===x?!0:d==null||x==null||!Gr(d)&&!Gr(x)?d!==d&&x!==x:K1(d,x,C,G,jc,Ae)}function K1(d,x,C,G,Ae,ie){var Ue=Cn(d),et=Cn(x),st=Ue?f:Vt(d),Ce=et?f:Vt(x);st=st==a?E:st,Ce=Ce==a?E:Ce;var bt=st==E,xt=Ce==E,at=st==Ce;if(at&&Qi(d)){if(!Qi(x))return!1;Ue=!0,bt=!1}if(at&&!bt)return ie||(ie=new Ht),Ue||Gc(d)?zc(d,x,C,G,Ae,ie):G1(d,x,st,C,G,Ae,ie);if(!(C&i)){var mt=bt&&re.call(d,"__wrapped__"),Et=xt&&re.call(x,"__wrapped__");if(mt||Et){var Gt=mt?d.value():d,jt=Et?x.value():x;return ie||(ie=new Ht),Ae(Gt,jt,C,G,ie)}}return at?(ie||(ie=new Ht),W1(d,x,C,G,Ae,ie)):!1}function q1(d){if(!Vc(d)||Z1(d))return!1;var x=qc(d)?Ee:K;return x.test(ir(d))}function H1(d){return Gr(d)&&Hc(d.length)&&!!Y[Vr(d)]}function V1(d){if(!Q1(d))return Nn(d);var x=[];for(var C in Object(d))re.call(d,C)&&C!="constructor"&&x.push(C);return x}function zc(d,x,C,G,Ae,ie){var Ue=C&i,et=d.length,st=x.length;if(et!=st&&!(Ue&&st>et))return!1;var Ce=ie.get(d);if(Ce&&ie.get(x))return Ce==x;var bt=-1,xt=!0,at=C&s?new Tn:void 0;for(ie.set(d,x),ie.set(x,d);++bt<et;){var mt=d[bt],Et=x[bt];if(G)var Gt=Ue?G(Et,mt,bt,x,d,ie):G(mt,Et,bt,d,x,ie);if(Gt!==void 0){if(Gt)continue;xt=!1;break}if(at){if(!we(x,function(jt,sr){if(!_e(at,sr)&&(mt===jt||Ae(mt,jt,C,G,ie)))return at.push(sr)})){xt=!1;break}}else if(!(mt===Et||Ae(mt,Et,C,G,ie))){xt=!1;break}}return ie.delete(d),ie.delete(x),xt}function G1(d,x,C,G,Ae,ie,Ue){switch(C){case X:if(d.byteLength!=x.byteLength||d.byteOffset!=x.byteOffset)return!1;d=d.buffer,x=x.buffer;case k:return!(d.byteLength!=x.byteLength||!ie(new Dt(d),new Dt(x)));case l:case w:case A:return Kc(+d,+x);case _:return d.name==x.name&&d.message==x.message;case m:case c:return d==x+"";case R:var et=le;case b:var st=G&i;if(et||(et=ce),d.size!=x.size&&!st)return!1;var Ce=Ue.get(d);if(Ce)return Ce==x;G|=s,Ue.set(d,x);var bt=zc(et(d),et(x),G,Ae,ie,Ue);return Ue.delete(d),bt;case p:if(He)return He.call(d)==He.call(x)}return!1}function W1(d,x,C,G,Ae,ie){var Ue=C&i,et=Bc(d),st=et.length,Ce=Bc(x),bt=Ce.length;if(st!=bt&&!Ue)return!1;for(var xt=st;xt--;){var at=et[xt];if(!(Ue?at in x:re.call(x,at)))return!1}var mt=ie.get(d);if(mt&&ie.get(x))return mt==x;var Et=!0;ie.set(d,x),ie.set(x,d);for(var Gt=Ue;++xt<st;){at=et[xt];var jt=d[at],sr=x[at];if(G)var Wc=Ue?G(sr,jt,at,x,d,ie):G(jt,sr,at,d,x,ie);if(!(Wc===void 0?jt===sr||Ae(jt,sr,C,G,ie):Wc)){Et=!1;break}Gt||(Gt=at=="constructor")}if(Et&&!Gt){var Pn=d.constructor,Fn=x.constructor;Pn!=Fn&&"constructor"in d&&"constructor"in x&&!(typeof Pn=="function"&&Pn instanceof Pn&&typeof Fn=="function"&&Fn instanceof Fn)&&(Et=!1)}return ie.delete(d),ie.delete(x),Et}function Bc(d){return B1(d,iv,k1)}function Rn(d,x){var C=d.__data__;return J1(x)?C[typeof x=="string"?"string":"hash"]:C.map}function yr(d,x){var C=pe(d,x);return q1(C)?C:void 0}function Y1(d){var x=re.call(d,vt),C=d[vt];try{d[vt]=void 0;var G=!0}catch{}var Ae=be.call(d);return G&&(x?d[vt]=C:delete d[vt]),Ae}var k1=rr?function(d){return d==null?[]:(d=Object(d),ye(rr(d),function(x){return Rt.call(d,x)}))}:sv,Vt=Vr;(ze&&Vt(new ze(new ArrayBuffer(1)))!=X||Fe&&Vt(new Fe)!=R||Be&&Vt(Be.resolve())!=O||Ke&&Vt(new Ke)!=b||qe&&Vt(new qe)!=z)&&(Vt=function(d){var x=Vr(d),C=x==E?d.constructor:void 0,G=C?ir(C):"";if(G)switch(G){case We:return X;case Ye:return R;case ke:return O;case Xe:return b;case Je:return z}return x});function X1(d,x){return x=x??o,!!x&&(typeof d=="number"||Q.test(d))&&d>-1&&d%1==0&&d<x}function J1(d){var x=typeof d;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?d!=="__proto__":d===null}function Z1(d){return!!ve&&ve in d}function Q1(d){var x=d&&d.constructor,C=typeof x=="function"&&x.prototype||ee;return d===C}function ev(d){return be.call(d)}function ir(d){if(d!=null){try{return ge.call(d)}catch{}try{return d+""}catch{}}return""}function Kc(d,x){return d===x||d!==d&&x!==x}var tv=Mc(function(){return arguments}())?Mc:function(d){return Gr(d)&&re.call(d,"callee")&&!Rt.call(d,"callee")},Cn=Array.isArray;function rv(d){return d!=null&&Hc(d.length)&&!qc(d)}var Qi=Hr||ov;function nv(d,x){return jc(d,x)}function qc(d){if(!Vc(d))return!1;var x=Vr(d);return x==v||x==S||x==h||x==g}function Hc(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=o}function Vc(d){var x=typeof d;return d!=null&&(x=="object"||x=="function")}function Gr(d){return d!=null&&typeof d=="object"}var Gc=he?Pe(he):H1;function iv(d){return rv(d)?z1(d):V1(d)}function sv(){return[]}function ov(){return!1}t.exports=nv})(Ki,Ki.exports);var L_=Ki.exports,N_=Object.defineProperty,Ha=Object.getOwnPropertySymbols,T_=Object.prototype.hasOwnProperty,A_=Object.prototype.propertyIsEnumerable,Va=(t,e,r)=>e in t?N_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ut=(t,e)=>{for(var r in e||(e={}))T_.call(e,r)&&Va(t,r,e[r]);if(Ha)for(var r of Ha(e))A_.call(e,r)&&Va(t,r,e[r]);return t};function R_(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,f=t.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function w(S){if(S instanceof Uint8Array||(ArrayBuffer.isView(S)?S=new Uint8Array(S.buffer,S.byteOffset,S.byteLength):Array.isArray(S)&&(S=Uint8Array.from(S))),!(S instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(S.length===0)return"";for(var R=0,A=0,U=0,E=S.length;U!==E&&S[U]===0;)U++,R++;for(var O=(E-U)*l+1>>>0,g=new Uint8Array(O);U!==E;){for(var m=S[U],b=0,c=O-1;(m!==0||b<A)&&c!==-1;c--,b++)m+=256*g[c]>>>0,g[c]=m%a>>>0,m=m/a>>>0;if(m!==0)throw new Error("Non-zero carry");A=b,U++}for(var p=O-A;p!==O&&g[p]===0;)p++;for(var F=f.repeat(R);p<O;++p)F+=t.charAt(g[p]);return F}function _(S){if(typeof S!="string")throw new TypeError("Expected String");if(S.length===0)return new Uint8Array;var R=0;if(S[R]!==" "){for(var A=0,U=0;S[R]===f;)A++,R++;for(var E=(S.length-R)*h+1>>>0,O=new Uint8Array(E);S[R];){var g=r[S.charCodeAt(R)];if(g===255)return;for(var m=0,b=E-1;(g!==0||m<U)&&b!==-1;b--,m++)g+=a*O[b]>>>0,O[b]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");U=m,R++}if(S[R]!==" "){for(var c=E-U;c!==E&&O[c]===0;)c++;for(var p=new Uint8Array(A+(E-c)),F=A;c!==E;)p[F++]=O[c++];return p}}}function v(S){var R=_(S);if(R)return R;throw new Error(`Non-${e} character`)}return{encode:w,decodeUnsafe:_,decode:v}}var C_=R_,P_=C_;const Ga=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},F_=t=>new TextEncoder().encode(t),$_=t=>new TextDecoder().decode(t);class U_{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class M_{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Wa(this,e)}}class j_{constructor(e){this.decoders=e}or(e){return Wa(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Wa=(t,e)=>new j_(ut(ut({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class z_{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new U_(e,r,n),this.decoder=new M_(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const vn=({name:t,prefix:e,encode:r,decode:n})=>new z_(t,e,r,n),Br=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=P_(r,e);return vn({prefix:t,name:e,encode:n,decode:s=>Ga(i(s))})},B_=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,f=0,h=0;for(let l=0;l<s;++l){const w=i[t[l]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|w,a+=r,a>=8&&(a-=8,o[h++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},K_=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},it=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>vn({prefix:e,name:t,encode(i){return K_(i,n,r)},decode(i){return B_(i,n,r,t)}}),q_=vn({prefix:"\0",name:"identity",encode:t=>$_(t),decode:t=>F_(t)});var H_=Object.freeze({__proto__:null,identity:q_});const V_=it({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var G_=Object.freeze({__proto__:null,base2:V_});const W_=it({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Y_=Object.freeze({__proto__:null,base8:W_});const k_=Br({prefix:"9",name:"base10",alphabet:"0123456789"});var X_=Object.freeze({__proto__:null,base10:k_});const J_=it({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Z_=it({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Q_=Object.freeze({__proto__:null,base16:J_,base16upper:Z_});const e0=it({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),t0=it({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),r0=it({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),n0=it({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),i0=it({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),s0=it({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),o0=it({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),a0=it({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),c0=it({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var u0=Object.freeze({__proto__:null,base32:e0,base32upper:t0,base32pad:r0,base32padupper:n0,base32hex:i0,base32hexupper:s0,base32hexpad:o0,base32hexpadupper:a0,base32z:c0});const f0=Br({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),h0=Br({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var l0=Object.freeze({__proto__:null,base36:f0,base36upper:h0});const d0=Br({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),p0=Br({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var g0=Object.freeze({__proto__:null,base58btc:d0,base58flickr:p0});const _0=it({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),y0=it({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),v0=it({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),b0=it({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var w0=Object.freeze({__proto__:null,base64:_0,base64pad:y0,base64url:v0,base64urlpad:b0});const Ya=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),m0=Ya.reduce((t,e,r)=>(t[r]=e,t),[]),E0=Ya.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function S0(t){return t.reduce((e,r)=>(e+=m0[r],e),"")}function D0(t){const e=[];for(const r of t){const n=E0[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const x0=vn({prefix:"\u{1F680}",name:"base256emoji",encode:S0,decode:D0});var O0=Object.freeze({__proto__:null,base256emoji:x0}),I0=Xa,ka=128,L0=127,N0=~L0,T0=Math.pow(2,31);function Xa(t,e,r){e=e||[],r=r||0;for(var n=r;t>=T0;)e[r++]=t&255|ka,t/=128;for(;t&N0;)e[r++]=t&255|ka,t>>>=7;return e[r]=t|0,Xa.bytes=r-n+1,e}var A0=qi,R0=128,Ja=127;function qi(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw qi.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Ja)<<i:(o&Ja)*Math.pow(2,i),i+=7}while(o>=R0);return qi.bytes=s-n,r}var C0=Math.pow(2,7),P0=Math.pow(2,14),F0=Math.pow(2,21),$0=Math.pow(2,28),U0=Math.pow(2,35),M0=Math.pow(2,42),j0=Math.pow(2,49),z0=Math.pow(2,56),B0=Math.pow(2,63),K0=function(t){return t<C0?1:t<P0?2:t<F0?3:t<$0?4:t<U0?5:t<M0?6:t<j0?7:t<z0?8:t<B0?9:10},q0={encode:I0,decode:A0,encodingLength:K0},Za=q0;const Qa=(t,e,r=0)=>(Za.encode(t,e,r),e),ec=t=>Za.encodingLength(t),Hi=(t,e)=>{const r=e.byteLength,n=ec(t),i=n+ec(r),s=new Uint8Array(i+r);return Qa(t,s,0),Qa(r,s,n),s.set(e,i),new H0(t,r,e,s)};class H0{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const tc=({name:t,code:e,encode:r})=>new V0(t,e,r);class V0{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Hi(this.code,r):r.then(n=>Hi(this.code,n))}else throw Error("Unknown type, must be binary type")}}const rc=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),G0=tc({name:"sha2-256",code:18,encode:rc("SHA-256")}),W0=tc({name:"sha2-512",code:19,encode:rc("SHA-512")});var Y0=Object.freeze({__proto__:null,sha256:G0,sha512:W0});const nc=0,k0="identity",ic=Ga;var X0=Object.freeze({__proto__:null,identity:{code:nc,name:k0,encode:ic,digest:t=>Hi(nc,ic(t))}});new TextEncoder,new TextDecoder;const sc=ut(ut(ut(ut(ut(ut(ut(ut(ut(ut({},H_),G_),Y_),X_),Q_),u0),l0),g0),w0),O0);ut(ut({},Y0),X0);function J0(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function oc(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const ac=oc("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Vi=oc("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=J0(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Z0=ut({utf8:ac,"utf-8":ac,hex:sc.base16,latin1:Vi,ascii:Vi,binary:Vi},sc);function Q0(t,e="utf8"){const r=Z0[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const cc="wc",ey=2,Gi="core",Kt=`${cc}@${2}:${Gi}:`,ty={name:Gi,logger:"error"},ry={database:":memory:"},ny="crypto",uc="client_ed25519_seed",iy=Z.ONE_DAY,sy="keychain",oy="0.3",ay="messages",cy="0.3",uy=Z.SIX_HOURS,fy="publisher",fc="irn",hy="error",ly="wss://relay.walletconnect.com",dy="relayer",ft={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},py="_subscription",bn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},hc=Z.ONE_SECOND,gy="2.2.1",_y="0.3",Tt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},yy="subscription",vy="0.3",by=Z.FIVE_SECONDS*1e3,wy="pairing",my="0.3",Kr={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},At={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Ey="history",Sy="0.3",Dy="expirer",wt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},xy="0.3";class Oy{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=sy,this.version=oy,this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=H("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ua(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?fa(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Iy{constructor(e,r,n){this.core=e,this.logger=r,this.name=ny,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Fo(i);return Po(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=Ip();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),o=Fo(s),a=xi();return await Fd(a,i,iy,o)},this.generateSharedKey=(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),f=Lp(a,s);return this.setSymKey(f,o)},this.setSymKey=async(i,s)=>{this.isInitialized();const o=s||Np(i);return await this.keychain.set(o,i),o},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,o)=>{this.isInitialized();const a=na(o),f=ii(s);if(ia(a)){const _=a.senderPublicKey,v=a.receiverPublicKey;i=await this.generateSharedKey(_,v)}const h=this.getSymKey(i),{type:l,senderPublicKey:w}=a;return Ap({type:l,symKey:h,message:f,senderPublicKey:w})},this.decode=async(i,s,o)=>{this.isInitialized();const a=Pp(s,o);if(ia(a)){const l=a.receiverPublicKey,w=a.senderPublicKey;i=await this.generateSharedKey(l,w)}const f=this.getSymKey(i),h=Rp({symKey:f,encoded:s});return no(h)},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.keychain=n||new Oy(this.core,this.logger)}get context(){return xe.getLoggerContext(this.logger)}getPayloadType(e){const r=Ii(e);return $r(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(uc)}catch{e=xi(),await this.keychain.set(uc,e)}return Q0(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ly extends vh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=ay,this.version=cy,this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=Oi(i);let o=this.messages.get(n);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=i,this.messages.set(n,o),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),o=Oi(i);return typeof s[o]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=xe.generateChildLogger(e,this.name),this.core=r}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ua(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?fa(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Ny extends bh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new Ct.exports.EventEmitter,this.name=fy,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const o=s?.ttl||uy,a=Li(s),f=s?.prompt||!1,h=s?.tag||0,l={topic:n,message:i,opts:{ttl:o,relay:a,prompt:f,tag:h}},w=Oi(i);this.queue.set(w,l);try{await await ha(this.rpcPublish(n,i,o,a,f,h),this.publishTimeout),this.relayer.events.emit(ft.publish,l)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(ft.connection_stalled);return}this.onPublish(w,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return xe.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,o){var a,f,h,l;const w={method:Ni(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:o}};return yt((a=w.params)==null?void 0:a.prompt)&&((f=w.params)==null||delete f.prompt),yt((h=w.params)==null?void 0:h.tag)&&((l=w.params)==null||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w}),this.relayer.provider.request(w)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(xr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class Ty{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Ay=Object.defineProperty,Ry=Object.defineProperties,Cy=Object.getOwnPropertyDescriptors,lc=Object.getOwnPropertySymbols,Py=Object.prototype.hasOwnProperty,Fy=Object.prototype.propertyIsEnumerable,dc=(t,e,r)=>e in t?Ay(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wn=(t,e)=>{for(var r in e||(e={}))Py.call(e,r)&&dc(t,r,e[r]);if(lc)for(var r of lc(e))Fy.call(e,r)&&dc(t,r,e[r]);return t},Wi=(t,e)=>Ry(t,Cy(e));class $y extends Eh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new Ty,this.events=new Ct.exports.EventEmitter,this.name=yy,this.version=vy,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Kt,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=Li(i),o={topic:n,relay:s};this.pending.set(n,o);const a=await this.rpcSubscribe(n,s);return this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const o=new Z.Watch;o.start(this.pendingSubscriptionWatchLabel);const a=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),i(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=by&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=Li(n);await this.rpcUnsubscribe(e,r,i);const s=Ge("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:Ni(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await ha(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ft.connection_stalled)}return i}rpcUnsubscribe(e,r,n){const i={method:Ni(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(e,r){this.setSubscription(e,Wi(wn({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,Wi(wn({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,wn({},r)),this.topicMap.set(r.topic,e),this.events.emit(Tt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Tt.deleted,Wi(wn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Tt.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(Tt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:n}=e,i={topic:r,relay:n};this.pending.set(i.topic,i);const s=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(s,i)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(xr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(ft.connect,async()=>{await this.onConnect()}),this.relayer.on(ft.disconnect,()=>{this.onDisconnect()}),this.events.on(Tt.created,async e=>{const r=Tt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Tt.deleted,async e=>{const r=Tt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Uy=Object.defineProperty,pc=Object.getOwnPropertySymbols,My=Object.prototype.hasOwnProperty,jy=Object.prototype.propertyIsEnumerable,gc=(t,e,r)=>e in t?Uy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zy=(t,e)=>{for(var r in e||(e={}))My.call(e,r)&&gc(t,r,e[r]);if(pc)for(var r of pc(e))jy.call(e,r)&&gc(t,r,e[r]);return t};class By extends wh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Ct.exports.EventEmitter,this.name=dy,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?xe.generateChildLogger(e.logger,this.name):Wr(xe.getDefaultLoggerOptions({level:e.logger||hy})),this.messages=new Ly(this.logger,e.core),this.subscriber=new $y(this,this.logger),this.publisher=new Ny(this,this.logger),this.relayUrl=e?.relayUrl||ly,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return xe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(Tt.created,s=>{s.topic===e&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(e,r),i()})]),n}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&await this.provider.disconnect(),this.events.emit(ft.transport_closed)}async transportOpen(e){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Tt.resubscribed,()=>{r()})}),await Promise.race([this.provider.connect(),new Promise((r,n)=>this.once(ft.transport_closed,()=>{n()}))])])}catch(r){const n=r;if(!/socket hang up/i.test(n.message))throw new Error(n.message);this.logger.error(n),this.events.emit(ft.transport_closed)}}async restartTransport(e){await this.transportClose(),await new Promise(r=>setTimeout(r,hc)),await this.transportOpen(e)}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new y_(new I_(Yp({sdkVersion:gy,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),ji(e)){if(!e.method.endsWith(py))return;const r=e.params,{topic:n,message:i}=r.data,s={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(zy({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(ft.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Ui(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(bn.payload,e=>this.onProviderPayload(e)),this.provider.on(bn.connect,()=>{this.events.emit(ft.connect)}),this.provider.on(bn.disconnect,()=>{this.events.emit(ft.disconnect),this.attemptToReconnect()}),this.provider.on(bn.error,e=>this.events.emit(ft.error,e)),this.events.on(ft.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},Z.toMiliseconds(hc))}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Ky=Object.defineProperty,_c=Object.getOwnPropertySymbols,qy=Object.prototype.hasOwnProperty,Hy=Object.prototype.propertyIsEnumerable,yc=(t,e,r)=>e in t?Ky(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vc=(t,e)=>{for(var r in e||(e={}))qy.call(e,r)&&yc(t,r,e[r]);if(_c)for(var r of _c(e))Hy.call(e,r)&&yc(t,r,e[r]);return t};class mn extends mh{constructor(e,r,n,i=Kt,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=_y,this.cached=[],this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{gg(o)?this.map.set(o.id,o):_g(o)?this.map.set(o.topic,o):this.getKey&&o!==null&&!yt(o)&&this.map.set(this.getKey(o),o)}),this.cached=[],this.initialized=!0)},this.set=async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(f=>L_(a[f],o[f]))):this.values),this.update=async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const f=vc(vc({},this.getData(o)),a);this.map.set(o,f),await this.persist()},this.delete=async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),await this.persist())},this.logger=xe.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Vy{constructor(e,r){this.core=e,this.logger=r,this.name=wy,this.version=my,this.events=new Ct.exports,this.initialized=!1,this.storagePrefix=Kt,this.ignoredPayloadTypes=[er],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=xi(),i=await this.core.crypto.setSymKey(n),s=Lt(Z.FIVE_MINUTES),o={protocol:fc},a={topic:i,expiry:s,relay:o,active:!1},f=sg({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:o});return await this.pairings.set(i,a),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:f}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:o}=ng(n.uri),a=Lt(Z.FIVE_MINUTES),f={topic:i,relay:o,expiry:a,active:!1};return await this.pairings.set(i,f),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:o}),this.core.expirer.set(i,a),n.activatePairing&&await this.activate({topic:i}),f},this.activate=async({topic:n})=>{this.isInitialized();const i=Lt(Z.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:f}=tr();this.events.once(Me("pairing_ping",s),({error:h})=>{h?f(h):a()}),await o()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ge("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const o=gn(i,s),a=await this.core.crypto.encode(n,o),f=Kr[i].req;return this.core.history.set(n,o),await this.core.relayer.publish(n,a,f),o.id},this.sendResult=async(n,i,s)=>{const o=Ui(n,s),a=await this.core.crypto.encode(i,o),f=await this.core.history.get(i,n),h=Kr[f.request.method].res;await this.core.relayer.publish(i,a,h),await this.core.history.resolve(o)},this.sendError=async(n,i,s)=>{const o=Mi(n,s),a=await this.core.crypto.encode(i,o),f=await this.core.history.get(i,n),h=Kr[f.request.method]?Kr[f.request.method].res:Kr.unregistered_method.res;await this.core.relayer.publish(i,a,h),await this.core.history.resolve(o)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ge("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>Bt(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,o=s.method;if(this.pairings.keys.includes(i))switch(o){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{$t(i)?this.events.emit(Me("pairing_ping",s),{}):St(i)&&this.events.emit(Me("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.sendResult(s,n,!0),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=Ge("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,a),this.logger.error(a)}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ge("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!gt(n)){const{message:i}=H("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!pg(n.uri)){const{message:i}=H("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!gt(n)){const{message:s}=H("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!gt(n)){const{message:s}=H("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!nt(n,!1)){const{message:i}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(Bt(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=H("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.pairings=new mn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ft.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);ji(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):zi(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(wt.expired,async e=>{const{topic:r}=da(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Gy extends yh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new Ct.exports.EventEmitter,this.name=Ey,this.version=Sy,this.cached=[],this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(o.id,o),this.events.emit(At.created,o)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=St(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(At.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(At.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:gn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(At.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(At.created,e=>{const r=At.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(At.updated,e=>{const r=At.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(At.deleted,e=>{const r=At.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Wy extends Sh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new Ct.exports.EventEmitter,this.name=Dy,this.version=xy,this.cached=[],this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(wt.created,{target:s,expiration:o})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(wt.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return kp(e);if(typeof e=="number")return Xp(e);const{message:r}=H("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(wt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;Z.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(wt.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(xr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(wt.created,e=>{const r=wt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(wt.expired,e=>{const r=wt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(wt.deleted,e=>{const r=wt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var Yy=Object.defineProperty,bc=Object.getOwnPropertySymbols,ky=Object.prototype.hasOwnProperty,Xy=Object.prototype.propertyIsEnumerable,wc=(t,e,r)=>e in t?Yy(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mc=(t,e)=>{for(var r in e||(e={}))ky.call(e,r)&&wc(t,r,e[r]);if(bc)for(var r of bc(e))Xy.call(e,r)&&wc(t,r,e[r]);return t};class Yi extends _h{constructor(e){super(e),this.protocol=cc,this.version=ey,this.name=Gi,this.events=new Ct.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Wr(xe.getDefaultLoggerOptions({level:e?.logger||ty.logger}));this.logger=xe.generateChildLogger(r,this.name),this.heartbeat=new xr.HeartBeat,this.crypto=new Iy(this,this.logger,e?.keychain),this.history=new Gy(this,this.logger),this.expirer=new Wy(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new Bu(mc(mc({},ry),e?.storageOptions)),this.relayer=new By({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId}),this.pairing=new Vy(this,this.logger)}static async init(e){const r=new Yi(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const Jy=Yi;var En={exports:{}},gr=typeof Reflect=="object"?Reflect:null,Ec=gr&&typeof gr.apply=="function"?gr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Sn;gr&&typeof gr.ownKeys=="function"?Sn=gr.ownKeys:Object.getOwnPropertySymbols?Sn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Sn=function(e){return Object.getOwnPropertyNames(e)};function Zy(t){console&&console.warn&&console.warn(t)}var Sc=Number.isNaN||function(e){return e!==e};function Le(){Le.init.call(this)}En.exports=Le,En.exports.once=r1,Le.EventEmitter=Le,Le.prototype._events=void 0,Le.prototype._eventsCount=0,Le.prototype._maxListeners=void 0;var Dc=10;function Dn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Le,"defaultMaxListeners",{enumerable:!0,get:function(){return Dc},set:function(t){if(typeof t!="number"||t<0||Sc(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Dc=t}}),Le.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Le.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Sc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function xc(t){return t._maxListeners===void 0?Le.defaultMaxListeners:t._maxListeners}Le.prototype.getMaxListeners=function(){return xc(this)},Le.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")Ec(f,this,r);else for(var h=f.length,l=Tc(f,h),n=0;n<h;++n)Ec(l[n],this,r);return!0};function Oc(t,e,r,n){var i,s,o;if(Dn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=xc(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Zy(a)}return t}Le.prototype.addListener=function(e,r){return Oc(this,e,r,!1)},Le.prototype.on=Le.prototype.addListener,Le.prototype.prependListener=function(e,r){return Oc(this,e,r,!0)};function Qy(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ic(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Qy.bind(n);return i.listener=r,n.wrapFn=i,i}Le.prototype.once=function(e,r){return Dn(r),this.on(e,Ic(this,e,r)),this},Le.prototype.prependOnceListener=function(e,r){return Dn(r),this.prependListener(e,Ic(this,e,r)),this},Le.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Dn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():e1(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Le.prototype.off=Le.prototype.removeListener,Le.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Lc(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?t1(i):Tc(i,i.length)}Le.prototype.listeners=function(e){return Lc(this,e,!0)},Le.prototype.rawListeners=function(e){return Lc(this,e,!1)},Le.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Nc.call(t,e)},Le.prototype.listenerCount=Nc;function Nc(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Le.prototype.eventNames=function(){return this._eventsCount>0?Sn(this._events):[]};function Tc(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function e1(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function t1(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function r1(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Ac(t,e,s,{once:!0}),e!=="error"&&n1(t,i,{once:!0})})}function n1(t,e,r){typeof t.on=="function"&&Ac(t,"error",e,r)}function Ac(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const ki="wc",Xi=2,Ji="client",xn=`${ki}@${Xi}:${Ji}:`,On={name:Ji,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},i1={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_event:"session_event",proposal_expire:"proposal_expire"},s1={database:":memory:"},o1={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},a1="history",c1="0.3",Rc="proposal",u1=Z.THIRTY_DAYS,Cc="session",qr=Z.SEVEN_DAYS,Pc="engine",_r={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}},In={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},Fc="request";var f1=Object.defineProperty,h1=Object.defineProperties,l1=Object.getOwnPropertyDescriptors,$c=Object.getOwnPropertySymbols,d1=Object.prototype.hasOwnProperty,p1=Object.prototype.propertyIsEnumerable,Uc=(t,e,r)=>e in t?f1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ut=(t,e)=>{for(var r in e||(e={}))d1.call(e,r)&&Uc(t,r,e[r]);if($c)for(var r of $c(e))p1.call(e,r)&&Uc(t,r,e[r]);return t},Zi=(t,e)=>h1(t,l1(e));class g1 extends xh{constructor(e){super(e),this.name=Pc,this.events=new En.exports,this.initialized=!1,this.ignoredPayloadTypes=[er],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(_r)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:n,requiredNamespaces:i,relays:s}=r;let o=n,a,f=!1;if(o&&(f=this.client.core.pairing.pairings.get(o).active),!o||!f){const{topic:A,uri:U}=await this.client.core.pairing.create();o=A,a=U}const h=await this.client.core.crypto.generateKeyPair(),l={requiredNamespaces:i,relays:s??[{protocol:fc}],proposer:{publicKey:h,metadata:this.client.metadata}},{reject:w,resolve:_,done:v}=tr();if(this.events.once(Me("session_connect"),async({error:A,session:U})=>{if(A)w(A);else if(U){U.self.publicKey=h;const E=Zi(Ut({},U),{requiredNamespaces:U.requiredNamespaces});await this.client.session.set(U.topic,E),await this.setExpiry(U.topic,U.expiry),o&&await this.client.core.pairing.updateMetadata({topic:o,metadata:U.peer.metadata}),_(E)}}),!o){const{message:A}=H("NO_MATCHING_KEY",`connect() pairing topic: ${o}`);throw new Error(A)}const S=await this.sendRequest(o,"wc_sessionPropose",l),R=Lt(Z.FIVE_MINUTES);return await this.setProposal(S,Ut({id:S,expiry:R},l)),{uri:a,approval:v}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:i,namespaces:s}=r,o=this.client.proposal.get(n);let{pairingTopic:a,proposer:f,requiredNamespaces:h}=o;dn(h)||(h=ug(s,"approve()"),this.client.proposal.set(n,Zi(Ut({},o),{requiredNamespaces:h})));const l=await this.client.core.crypto.generateKeyPair(),w=f.publicKey,_=await this.client.core.crypto.generateSharedKey(l,w),v={relay:{protocol:i??"irn"},namespaces:s,requiredNamespaces:h,controller:{publicKey:l,metadata:this.client.metadata},expiry:Lt(qr)};await this.client.core.relayer.subscribe(_);const S=await this.sendRequest(_,"wc_sessionSettle",v),{done:R,resolve:A,reject:U}=tr();this.events.once(Me("session_approve",S),({error:O})=>{O?U(O):A(this.client.session.get(_))});const E=Zi(Ut({},v),{topic:_,acknowledged:!1,self:v.controller,peer:{publicKey:f.publicKey,metadata:f.metadata},controller:l});return await this.client.session.set(_,E),await this.setExpiry(_,Lt(qr)),a&&await this.client.core.pairing.updateMetadata({topic:a,metadata:E.peer.metadata}),a&&n&&(await this.sendResult(n,a,{relay:{protocol:i??"irn"},responderPublicKey:l}),await this.client.proposal.delete(n,Ge("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:a})),{topic:_,acknowledged:R}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:i}=r,{pairingTopic:s}=this.client.proposal.get(n);s&&(await this.sendError(n,s,i),await this.client.proposal.delete(n,Ge("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:i}=r,s=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:o,resolve:a,reject:f}=tr();return this.events.once(Me("session_update",s),({error:h})=>{h?f(h):a()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:o}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:s,resolve:o,reject:a}=tr();return this.events.once(Me("session_extend",i),({error:f})=>{f?a(f):o()}),await this.setExpiry(n,Lt(qr)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:i,topic:s,expiry:o}=r,a=await this.sendRequest(s,"wc_sessionRequest",{request:i,chainId:n},o),{done:f,resolve:h,reject:l}=tr(o);return this.events.once(Me("session_request",a),({error:w,result:_})=>{w?l(w):h(_)}),await f()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:s}=i;$t(i)?await this.sendResult(s,n,i.result):St(i)&&await this.sendError(s,n,i.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:s,resolve:o,reject:a}=tr();this.events.once(Me("session_ping",i),({error:f})=>{f?a(f):o()}),await s()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",Ge("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>lg(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,n)=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Ge("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Ge("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=_r.wc_sessionRequest.req.ttl,{id:i,topic:s,params:o}=r;await this.client.pendingRequest.set(i,{id:i,topic:s,params:o}),n&&this.client.core.expirer.set(i,Lt(n))},this.sendRequest=async(r,n,i,s)=>{const o=gn(n,i),a=await this.client.core.crypto.encode(r,o),f=_r[n].req;return s&&(f.ttl=s),this.client.core.history.set(r,o),this.client.core.relayer.publish(r,a,f),o.id},this.sendResult=async(r,n,i)=>{const s=Ui(r,i),o=await this.client.core.crypto.encode(n,s),a=await this.client.core.history.get(n,r),f=_r[a.request.method].res;this.client.core.relayer.publish(n,o,f),await this.client.core.history.resolve(s)},this.sendError=async(r,n,i)=>{const s=Mi(r,i),o=await this.client.core.crypto.encode(n,s),a=await this.client.core.history.get(n,r),f=_r[a.request.method].res;this.client.core.relayer.publish(n,o,f),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{Bt(i.expiry)&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{Bt(i.expiry)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=r=>{const{topic:n,payload:i}=r,s=i.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:i}=r,s=(await this.client.core.history.get(n,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidConnect(Ut({},n.params));const o=Lt(Z.FIVE_MINUTES),a=Ut({id:s,pairingTopic:r,expiry:o},i);await this.setProposal(s,a),this.client.events.emit("session_proposal",{id:s,params:a})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionProposeResponse=async(r,n)=>{const{id:i}=n;if($t(n)){const{result:s}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const o=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const a=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});const f=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:f});const h=await this.client.core.crypto.generateSharedKey(a,f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:h});const l=await this.client.core.relayer.subscribe(h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:r})}else St(n)&&(await this.client.proposal.delete(i,Ge("USER_DISCONNECTED")),this.events.emit(Me("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:f,namespaces:h,requiredNamespaces:l}=n.params,w={topic:r,relay:o,expiry:f,namespaces:h,acknowledged:!0,requiredNamespaces:l,controller:a.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}};await this.sendResult(n.id,r,!0),this.events.emit(Me("session_connect"),{session:w})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,n)=>{const{id:i}=n;$t(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Me("session_approve",i),{})):St(n)&&(await this.client.session.delete(r,Ge("USER_DISCONNECTED")),this.events.emit(Me("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidUpdate(Ut({topic:r},i)),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionUpdateResponse=(r,n)=>{const{id:i}=n;$t(n)?this.events.emit(Me("session_update",i),{}):St(n)&&this.events.emit(Me("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Lt(qr)),await this.sendResult(i,r,!0),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,n)=>{const{id:i}=n;$t(n)?this.events.emit(Me("session_extend",i),{}):St(n)&&this.events.emit(Me("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,n)=>{const{id:i}=n;setTimeout(()=>{$t(n)?this.events.emit(Me("session_ping",i),{}):St(n)&&this.events.emit(Me("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await this.sendResult(i,r,!0),await this.deleteSession(r),this.client.events.emit("session_delete",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidRequest(Ut({topic:r},s)),await this.setPendingSessionRequest({id:i,topic:r,params:s}),this.client.events.emit("session_request",{id:i,topic:r,params:s})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.onSessionRequestResponse=(r,n)=>{const{id:i}=n;$t(n)?this.events.emit(Me("session_request",i),{result:n.result}):St(n)&&this.events.emit(Me("session_request",i),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidEmit(Ut({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.isValidConnect=async r=>{if(!gt(r)){const{message:a}=H("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(a)}const{pairingTopic:n,requiredNamespaces:i,relays:s}=r;if(yt(n)||await this.isValidPairingTopic(n),!yt(i)&&dn(i)===0)return;const o=wg(i,"connect()");if(o)throw new Error(o.message);if(!mg(s,!0)){const{message:a}=H("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(a)}},this.isValidApprove=async r=>{if(!gt(r))throw new Error(H("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s}=r;await this.isValidProposalId(n);const o=this.client.proposal.get(n),a=pn(i,"approve()");if(a)throw new Error(a.message);const f=Sa(o.requiredNamespaces,i,"update()");if(f)throw new Error(f.message);if(!nt(s,!0)){const{message:h}=H("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(h)}},this.isValidReject=async r=>{if(!gt(r)){const{message:s}=H("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(await this.isValidProposalId(n),!Sg(i)){const{message:s}=H("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!gt(r)){const{message:h}=H("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(h)}const{relay:n,controller:i,namespaces:s,expiry:o}=r;if(!ma(n)){const{message:h}=H("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(h)}const a=yg(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);const f=pn(s,"onSessionSettleRequest()");if(f)throw new Error(f.message);if(Bt(o)){const{message:h}=H("EXPIRED","onSessionSettleRequest()");throw new Error(h)}},this.isValidUpdate=async r=>{if(!gt(r)){const{message:f}=H("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(f)}const{topic:n,namespaces:i}=r;await this.isValidSessionTopic(n);const s=this.client.session.get(n),o=pn(i,"update()");if(o)throw new Error(o.message);const a=Sa(s.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)},this.isValidExtend=async r=>{if(!gt(r)){const{message:i}=H("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!gt(r)){const{message:f}=H("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(f)}const{topic:n,request:i,chainId:s,expiry:o}=r;await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Ea(a,s)){const{message:f}=H("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(f)}if(!Dg(i)){const{message:f}=H("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(f)}if(!Ig(a,s,i.method)){const{message:f}=H("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(f)}if(o&&!Ng(o,In)){const{message:f}=H("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${In.min} and ${In.max}`);throw new Error(f)}},this.isValidRespond=async r=>{if(!gt(r)){const{message:s}=H("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:n,response:i}=r;if(await this.isValidSessionTopic(n),!xg(i)){const{message:s}=H("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!gt(r)){const{message:i}=H("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!gt(r)){const{message:a}=H("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!Ea(o,s)){const{message:a}=H("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!Og(i)){const{message:a}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!Lg(o,s,i.name)){const{message:a}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}},this.isValidDisconnect=async r=>{if(!gt(r)){const{message:i}=H("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(ft.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(r,n);ji(i)?(this.client.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):zi(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(wt.expired,async e=>{const{topic:r,id:n}=da(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,H("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&await this.deleteProposal(n,!0)})}isValidPairingTopic(e){if(!nt(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Bt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=H("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!nt(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Bt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=H("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(nt(e,!1)){const{message:r}=H("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=H("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Eg(e)){const{message:r}=H("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Bt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=H("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class _1 extends mn{constructor(e,r){super(e,r,Rc,xn),this.core=e,this.logger=r}}class y1 extends mn{constructor(e,r){super(e,r,Cc,xn),this.core=e,this.logger=r}}class v1 extends mn{constructor(e,r){super(e,r,Fc,xn),this.core=e,this.logger=r}}class Ln extends Dh{constructor(e){super(e),this.protocol=ki,this.version=Xi,this.name=On.name,this.events=new En.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=e?.name||On.name,this.metadata=e?.metadata||Hp();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Wr(xe.getDefaultLoggerOptions({level:e?.logger||On.logger}));this.core=e?.core||new Jy(e),this.logger=xe.generateChildLogger(r,this.name),this.session=new y1(this.core,this.logger),this.proposal=new _1(this.core,this.logger),this.pendingRequest=new v1(this.core,this.logger),this.engine=new g1(this)}static async init(e){const r=new Ln(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const b1=Ln;Te.ENGINE_CONTEXT=Pc,Te.ENGINE_RPC_OPTS=_r,Te.HISTORY_CONTEXT=a1,Te.HISTORY_EVENTS=o1,Te.HISTORY_STORAGE_VERSION=c1,Te.PROPOSAL_CONTEXT=Rc,Te.PROPOSAL_EXPIRY=u1,Te.REQUEST_CONTEXT=Fc,Te.SESSION_CONTEXT=Cc,Te.SESSION_EXPIRY=qr,Te.SESSION_REQUEST_EXPIRY_BOUNDARIES=In,Te.SIGN_CLIENT_CONTEXT=Ji,Te.SIGN_CLIENT_DEFAULT=On,Te.SIGN_CLIENT_EVENTS=i1,Te.SIGN_CLIENT_PROTOCOL=ki,Te.SIGN_CLIENT_STORAGE_OPTIONS=s1,Te.SIGN_CLIENT_STORAGE_PREFIX=xn,Te.SIGN_CLIENT_VERSION=Xi,Te.SignClient=b1,Te.default=Ln,Object.defineProperty(Te,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
