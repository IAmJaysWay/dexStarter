(function(X,Ze){typeof exports=="object"&&typeof module<"u"?Ze(exports):typeof define=="function"&&define.amd?define(["exports"],Ze):(X=typeof globalThis<"u"?globalThis:X||self,Ze(X["@walletconnect/core"]={}))})(this,function(X){"use strict";var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ct(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var wt={exports:{}},Kt=typeof Reflect=="object"?Reflect:null,yi=Kt&&typeof Kt.apply=="function"?Kt.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},Lr;Kt&&typeof Kt.ownKeys=="function"?Lr=Kt.ownKeys:Object.getOwnPropertySymbols?Lr=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Lr=function(t){return Object.getOwnPropertyNames(t)};function ou(e){console&&console.warn&&console.warn(e)}var vi=Number.isNaN||function(t){return t!==t};function Se(){Se.init.call(this)}wt.exports=Se,wt.exports.once=fu,Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var bi=10;function Rr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return bi},set:function(e){if(typeof e!="number"||e<0||vi(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");bi=e}}),Se.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||vi(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Ei(e){return e._maxListeners===void 0?Se.defaultMaxListeners:e._maxListeners}Se.prototype.getMaxListeners=function(){return Ei(this)},Se.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")yi(h,this,r);else for(var f=h.length,l=Oi(h,f),n=0;n<f;++n)yi(l[n],this,r);return!0};function wi(e,t,r,n){var i,s,o;if(Rr(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),o===void 0)o=s[t]=r,++e._eventsCount;else if(typeof o=="function"?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Ei(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,ou(c)}return e}Se.prototype.addListener=function(t,r){return wi(this,t,r,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(t,r){return wi(this,t,r,!0)};function au(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function mi(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=au.bind(n);return i.listener=r,n.wrapFn=i,i}Se.prototype.once=function(t,r){return Rr(r),this.on(t,mi(this,t,r)),this},Se.prototype.prependOnceListener=function(t,r){return Rr(r),this.prependListener(t,mi(this,t,r)),this},Se.prototype.removeListener=function(t,r){var n,i,s,o,c;if(Rr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){c=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():uu(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||r)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function Di(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?cu(i):Oi(i,i.length)}Se.prototype.listeners=function(t){return Di(this,t,!0)},Se.prototype.rawListeners=function(t){return Di(this,t,!1)},Se.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Si.call(e,t)},Se.prototype.listenerCount=Si;function Si(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?Lr(this._events):[]};function Oi(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function uu(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function cu(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function fu(e,t){return new Promise(function(r,n){function i(o){e.removeListener(t,s),n(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}xi(e,t,s,{once:!0}),t!=="error"&&hu(e,i,{once:!0})})}function hu(e,t,r){typeof e.on=="function"&&xi(e,"error",t,r)}function xi(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}function lu(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var du=_u;function _u(e,t,r){var n=r&&r.stringify||lu,i=1;if(typeof e=="object"&&e!==null){var s=t.length+i;if(s===1)return e;var o=new Array(s);o[0]=n(e);for(var c=1;c<s;c++)o[c]=n(t[c]);return o.join(" ")}if(typeof e!="string")return e;var h=t.length;if(h===0)return e;for(var f="",l=1-i,w=-1,b=e&&e.length||0,v=0;v<b;){if(e.charCodeAt(v)===37&&v+1<b){switch(w=w>-1?w:0,e.charCodeAt(v+1)){case 100:case 102:if(l>=h||t[l]==null)break;w<v&&(f+=e.slice(w,v)),f+=Number(t[l]),w=v+2,v++;break;case 105:if(l>=h||t[l]==null)break;w<v&&(f+=e.slice(w,v)),f+=Math.floor(Number(t[l])),w=v+2,v++;break;case 79:case 111:case 106:if(l>=h||t[l]===void 0)break;w<v&&(f+=e.slice(w,v));var T=typeof t[l];if(T==="string"){f+="'"+t[l]+"'",w=v+2,v++;break}if(T==="function"){f+=t[l].name||"<anonymous>",w=v+2,v++;break}f+=n(t[l]),w=v+2,v++;break;case 115:if(l>=h)break;w<v&&(f+=e.slice(w,v)),f+=String(t[l]),w=v+2,v++;break;case 37:w<v&&(f+=e.slice(w,v)),f+="%",w=v+2,v++,l--;break}++l}++v}return w===-1?e:(w<b&&(f+=e.slice(w)),f)}const Ti=du;var an=vt;const tr=Su().console||{},gu={mapHttpRequest:Ar,mapHttpResponse:Ar,wrapRequestSerializer:cn,wrapResponseSerializer:cn,wrapErrorSerializer:cn,req:Ar,res:Ar,err:Eu};function pu(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function vt(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=e.browser.write||tr;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=pu(e.browser.serialize,n);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),e.enabled===!1&&(e.level="silent");const c=e.level||"info",h=Object.create(r);h.log||(h.log=rr),Object.defineProperty(h,"levelVal",{get:l}),Object.defineProperty(h,"level",{get:w,set:b});const f={transmit:t,serialize:i,asObject:e.browser.asObject,levels:o,timestamp:wu(e)};h.levels=vt.levels,h.level=c,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=rr,h.serializers=n,h._serialize=i,h._stdErrSerialize=s,h.child=v,t&&(h._logEvent=un());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function w(){return this._level}function b(T){if(T!=="silent"&&!this.levels.values[T])throw Error("unknown level "+T);this._level=T,Gt(f,h,"error","log"),Gt(f,h,"fatal","error"),Gt(f,h,"warn","error"),Gt(f,h,"info","log"),Gt(f,h,"debug","log"),Gt(f,h,"trace","log")}function v(T,U){if(!T)throw new Error("missing bindings for child Pino");U=U||{},i&&T.serializers&&(U.serializers=T.serializers);const P=U.serializers;if(i&&P){var K=Object.assign({},n,P),S=e.browser.serialize===!0?Object.keys(K):i;delete T.serializers,Ir([T],S,K,this._stdErrSerialize)}function L(p){this._childLevel=(p._childLevel|0)+1,this.error=Vt(p,T,"error"),this.fatal=Vt(p,T,"fatal"),this.warn=Vt(p,T,"warn"),this.info=Vt(p,T,"info"),this.debug=Vt(p,T,"debug"),this.trace=Vt(p,T,"trace"),K&&(this.serializers=K,this._serialize=S),t&&(this._logEvent=un([].concat(p._logEvent.bindings,T)))}return L.prototype=this,new L(this)}return h}vt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},vt.stdSerializers=gu,vt.stdTimeFunctions=Object.assign({},{nullTime:Li,epochTime:Ri,unixTime:mu,isoTime:Du});function Gt(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?rr:i[r]?i[r]:tr[r]||tr[n]||rr,yu(e,t,r)}function yu(e,t,r){!e.transmit&&t[r]===rr||(t[r]=function(n){return function(){const s=e.timestamp(),o=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===tr?tr:this;for(var h=0;h<o.length;h++)o[h]=arguments[h];if(e.serialize&&!e.asObject&&Ir(o,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(c,vu(this,r,o,s)):n.apply(c,o),e.transmit){const f=e.transmit.level||t.level,l=vt.levels.values[f],w=vt.levels.values[r];if(w<l)return;bu(this,{ts:s,methodLevel:r,methodValue:w,transmitLevel:f,transmitValue:vt.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},o)}}}(t[r]))}function vu(e,t,r,n){e._serialize&&Ir(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let s=i[0];const o={};n&&(o.time=n),o.level=vt.levels.values[t];let c=(e._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof i[0]=="object";)Object.assign(o,i.shift());s=i.length?Ti(i.shift(),i):void 0}else typeof s=="string"&&(s=Ti(i.shift(),i));return s!==void 0&&(o.msg=s),o}function Ir(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=vt.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i]))for(const s in e[i])t&&t.indexOf(s)>-1&&s in r&&(e[i][s]=r[s](e[i][s]))}function Vt(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function bu(e,t,r){const n=t.send,i=t.ts,s=t.methodLevel,o=t.methodValue,c=t.val,h=e._logEvent.bindings;Ir(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(f){return h.indexOf(f)===-1}),e._logEvent.level.label=s,e._logEvent.level.value=o,n(s,e._logEvent,c),e._logEvent=un(h)}function un(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function Eu(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)t[r]===void 0&&(t[r]=e[r]);return t}function wu(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Li:Ri}function Ar(){return{}}function cn(e){return e}function rr(){}function Li(){return!1}function Ri(){return Date.now()}function mu(){return Math.round(Date.now()/1e3)}function Du(){return new Date(Date.now()).toISOString()}function Su(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}var Cr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var fn=function(e,t){return fn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},fn(e,t)};function Ou(e,t){fn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var hn=function(){return hn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},hn.apply(this,arguments)};function xu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Tu(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Lu(e,t){return function(r,n){t(r,n,e)}}function Ru(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Iu(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function Au(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Cu(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Pu(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function ln(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ii(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Nu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ii(arguments[t]));return e}function Uu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function nr(e){return this instanceof nr?(this.v=e,this):new nr(e)}function Mu(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof nr?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ju(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:nr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function $u(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof ln=="function"?ln(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function Fu(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Bu(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function zu(e){return e&&e.__esModule?e:{default:e}}function Hu(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Ku(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Gu=Object.freeze({__proto__:null,__extends:Ou,get __assign(){return hn},__rest:xu,__decorate:Tu,__param:Lu,__metadata:Ru,__awaiter:Iu,__generator:Au,__createBinding:Cu,__exportStar:Pu,__values:ln,__read:Ii,__spread:Nu,__spreadArrays:Uu,__await:nr,__asyncGenerator:Mu,__asyncDelegator:ju,__asyncValues:$u,__makeTemplateObject:Fu,__importStar:Bu,__importDefault:zu,__classPrivateFieldGet:Hu,__classPrivateFieldSet:Ku}),Ai=Ct(Gu),ir={};Object.defineProperty(ir,"__esModule",{value:!0});function Vu(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}ir.safeJsonParse=Vu;function Wu(e){return typeof e=="string"?e:JSON.stringify(e,(t,r)=>typeof r>"u"?null:r)}ir.safeJsonStringify=Wu;var sr={exports:{}},Ci;function qu(){return Ci||(Ci=1,function(){let e;function t(){}e=t,e.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},e.prototype.setItem=function(r,n){this[r]=String(n)},e.prototype.removeItem=function(r){delete this[r]},e.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},e.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ze<"u"&&Ze.localStorage?sr.exports=Ze.localStorage:typeof window<"u"&&window.localStorage?sr.exports=window.localStorage:sr.exports=new t}()),sr.exports}var dn={},or={},Pi;function Yu(){if(Pi)return or;Pi=1,Object.defineProperty(or,"__esModule",{value:!0}),or.IKeyValueStorage=void 0;class e{}return or.IKeyValueStorage=e,or}var ar={},Ni;function Xu(){if(Ni)return ar;Ni=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.parseEntry=void 0;const e=ir;function t(r){var n;return[r[0],e.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return ar.parseEntry=t,ar}var Ui;function ku(){return Ui||(Ui=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Ai;t.__exportStar(Yu(),e),t.__exportStar(Xu(),e)}(dn)),dn}Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.KeyValueStorage=void 0;const Wt=Ai,Mi=ir,Ju=Wt.__importDefault(qu()),Zu=ku();class ji{constructor(){this.localStorage=Ju.default}getKeys(){return Wt.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return Wt.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Zu.parseEntry)})}getItem(t){return Wt.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return Mi.safeJsonParse(r)})}setItem(t,r){return Wt.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,Mi.safeJsonStringify(r))})}removeItem(t){return Wt.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Cr.KeyValueStorage=ji;var Qu=Cr.default=ji,ur={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var _n=function(e,t){return _n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},_n(e,t)};function ec(e,t){_n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var gn=function(){return gn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},gn.apply(this,arguments)};function tc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function rc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function nc(e,t){return function(r,n){t(r,n,e)}}function ic(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function sc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function oc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function ac(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function uc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function pn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function $i(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function cc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat($i(arguments[t]));return e}function fc(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function cr(e){return this instanceof cr?(this.v=e,this):new cr(e)}function hc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof cr?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function lc(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:cr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function dc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof pn=="function"?pn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function _c(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function gc(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function pc(e){return e&&e.__esModule?e:{default:e}}function yc(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function vc(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var bc=Object.freeze({__proto__:null,__extends:ec,get __assign(){return gn},__rest:tc,__decorate:rc,__param:nc,__metadata:ic,__awaiter:sc,__generator:oc,__createBinding:ac,__exportStar:uc,__values:pn,__read:$i,__spread:cc,__spreadArrays:fc,__await:cr,__asyncGenerator:hc,__asyncDelegator:lc,__asyncValues:dc,__makeTemplateObject:_c,__importStar:gc,__importDefault:pc,__classPrivateFieldGet:yc,__classPrivateFieldSet:vc}),Pr=Ct(bc),fr={},yn,Fi;function Bi(){if(Fi)return yn;Fi=1;function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}yn=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(s){if(!r(s)||s<0||isNaN(s))throw TypeError("n must be a positive number");return this._maxListeners=s,this},e.prototype.emit=function(s){var o,c,h,f,l,w;if(this._events||(this._events={}),s==="error"&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(o=arguments[1],o instanceof Error)throw o;var b=new Error('Uncaught, unspecified "error" event. ('+o+")");throw b.context=o,b}if(c=this._events[s],i(c))return!1;if(t(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(n(c))for(f=Array.prototype.slice.call(arguments,1),w=c.slice(),h=w.length,l=0;l<h;l++)w[l].apply(this,f);return!0},e.prototype.addListener=function(s,o){var c;if(!t(o))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",s,t(o.listener)?o.listener:o),this._events[s]?n(this._events[s])?this._events[s].push(o):this._events[s]=[this._events[s],o]:this._events[s]=o,n(this._events[s])&&!this._events[s].warned&&(i(this._maxListeners)?c=e.defaultMaxListeners:c=this._maxListeners,c&&c>0&&this._events[s].length>c&&(this._events[s].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[s].length),typeof console.trace=="function"&&console.trace())),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(s,o){if(!t(o))throw TypeError("listener must be a function");var c=!1;function h(){this.removeListener(s,h),c||(c=!0,o.apply(this,arguments))}return h.listener=o,this.on(s,h),this},e.prototype.removeListener=function(s,o){var c,h,f,l;if(!t(o))throw TypeError("listener must be a function");if(!this._events||!this._events[s])return this;if(c=this._events[s],f=c.length,h=-1,c===o||t(c.listener)&&c.listener===o)delete this._events[s],this._events.removeListener&&this.emit("removeListener",s,o);else if(n(c)){for(l=f;l-- >0;)if(c[l]===o||c[l].listener&&c[l].listener===o){h=l;break}if(h<0)return this;c.length===1?(c.length=0,delete this._events[s]):c.splice(h,1),this._events.removeListener&&this.emit("removeListener",s,o)}return this},e.prototype.removeAllListeners=function(s){var o,c;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[s]&&delete this._events[s],this;if(arguments.length===0){for(o in this._events)o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[s],t(c))this.removeListener(s,c);else if(c)for(;c.length;)this.removeListener(s,c[c.length-1]);return delete this._events[s],this},e.prototype.listeners=function(s){var o;return!this._events||!this._events[s]?o=[]:t(this._events[s])?o=[this._events[s]]:o=this._events[s].slice(),o},e.prototype.listenerCount=function(s){if(this._events){var o=this._events[s];if(t(o))return 1;if(o)return o.length}return 0},e.listenerCount=function(s,o){return s.listenerCount(o)};function t(s){return typeof s=="function"}function r(s){return typeof s=="number"}function n(s){return typeof s=="object"&&s!==null}function i(s){return s===void 0}return yn}var De={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var vn=function(e,t){return vn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},vn(e,t)};function Ec(e,t){vn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var bn=function(){return bn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},bn.apply(this,arguments)};function wc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function mc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Dc(e,t){return function(r,n){t(r,n,e)}}function Sc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Oc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function xc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Tc(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Lc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function En(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function zi(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Rc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(zi(arguments[t]));return e}function Ic(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function hr(e){return this instanceof hr?(this.v=e,this):new hr(e)}function Ac(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof hr?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Cc(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:hr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function Pc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof En=="function"?En(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function Nc(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Uc(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Mc(e){return e&&e.__esModule?e:{default:e}}function jc(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function $c(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Fc=Object.freeze({__proto__:null,__extends:Ec,get __assign(){return bn},__rest:wc,__decorate:mc,__param:Dc,__metadata:Sc,__awaiter:Oc,__generator:xc,__createBinding:Tc,__exportStar:Lc,__values:En,__read:zi,__spread:Rc,__spreadArrays:Ic,__await:hr,__asyncGenerator:Ac,__asyncDelegator:Cc,__asyncValues:Pc,__makeTemplateObject:Nc,__importStar:Uc,__importDefault:Mc,__classPrivateFieldGet:jc,__classPrivateFieldSet:$c}),Nr=Ct(Fc),wn={},lr={},Hi;function Bc(){if(Hi)return lr;Hi=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.delay=void 0;function e(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return lr.delay=e,lr}var Pt={},mn={},Nt={},Ki;function zc(){return Ki||(Ki=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.ONE_THOUSAND=Nt.ONE_HUNDRED=void 0,Nt.ONE_HUNDRED=100,Nt.ONE_THOUSAND=1e3),Nt}var Dn={},Gi;function Hc(){return Gi||(Gi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}(Dn)),Dn}var Vi;function Wi(){return Vi||(Vi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Nr;t.__exportStar(zc(),e),t.__exportStar(Hc(),e)}(mn)),mn}var qi;function Kc(){if(qi)return Pt;qi=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.fromMiliseconds=Pt.toMiliseconds=void 0;const e=Wi();function t(n){return n*e.ONE_THOUSAND}Pt.toMiliseconds=t;function r(n){return Math.floor(n/e.ONE_THOUSAND)}return Pt.fromMiliseconds=r,Pt}var Yi;function Gc(){return Yi||(Yi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Nr;t.__exportStar(Bc(),e),t.__exportStar(Kc(),e)}(wn)),wn}var qt={},Xi;function Vc(){if(Xi)return qt;Xi=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return qt.Watch=e,qt.default=e,qt}var Sn={},dr={},ki;function Wc(){if(ki)return dr;ki=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.IWatch=void 0;class e{}return dr.IWatch=e,dr}var Ji;function qc(){return Ji||(Ji=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Nr.__exportStar(Wc(),e)}(Sn)),Sn}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Nr;t.__exportStar(Gc(),e),t.__exportStar(Vc(),e),t.__exportStar(qc(),e),t.__exportStar(Wi(),e)})(De);var On={},_r={};class Ut{}var Yc=Object.freeze({__proto__:null,IEvents:Ut}),Xc=Ct(Yc),Zi;function kc(){if(Zi)return _r;Zi=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.IHeartBeat=void 0;const e=Xc;class t extends e.IEvents{constructor(n){super()}}return _r.IHeartBeat=t,_r}var Qi;function es(){return Qi||(Qi=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Pr.__exportStar(kc(),e)}(On)),On}var xn={},Mt={},ts;function Jc(){if(ts)return Mt;ts=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.HEARTBEAT_EVENTS=Mt.HEARTBEAT_INTERVAL=void 0;const e=De;return Mt.HEARTBEAT_INTERVAL=e.FIVE_SECONDS,Mt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Mt}var rs;function ns(){return rs||(rs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Pr.__exportStar(Jc(),e)}(xn)),xn}var is;function Zc(){if(is)return fr;is=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.HeartBeat=void 0;const e=Pr,t=Bi(),r=De,n=es(),i=ns();class s extends n.IHeartBeat{constructor(c){super(c),this.events=new t.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=c?.interval||i.HEARTBEAT_INTERVAL}static init(c){return e.__awaiter(this,void 0,void 0,function*(){const h=new s(c);return yield h.init(),h})}init(){return e.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}on(c,h){this.events.on(c,h)}once(c,h){this.events.once(c,h)}off(c,h){this.events.off(c,h)}removeListener(c,h){this.events.removeListener(c,h)}initialize(){return e.__awaiter(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return fr.HeartBeat=s,fr}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Pr;t.__exportStar(Zc(),e),t.__exportStar(es(),e),t.__exportStar(ns(),e)})(ur);var Re={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Tn=function(e,t){return Tn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Tn(e,t)};function Qc(e,t){Tn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ln=function(){return Ln=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ln.apply(this,arguments)};function ef(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function tf(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function rf(e,t){return function(r,n){t(r,n,e)}}function nf(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function sf(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function of(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function af(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function uf(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Rn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ss(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function cf(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ss(arguments[t]));return e}function ff(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function gr(e){return this instanceof gr?(this.v=e,this):new gr(e)}function hf(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof gr?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function lf(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:gr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function df(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Rn=="function"?Rn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function _f(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function gf(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function pf(e){return e&&e.__esModule?e:{default:e}}function yf(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function vf(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var bf=Object.freeze({__proto__:null,__extends:Qc,get __assign(){return Ln},__rest:ef,__decorate:tf,__param:rf,__metadata:nf,__awaiter:sf,__generator:of,__createBinding:af,__exportStar:uf,__values:Rn,__read:ss,__spread:cf,__spreadArrays:ff,__await:gr,__asyncGenerator:hf,__asyncDelegator:lf,__asyncValues:df,__makeTemplateObject:_f,__importStar:gf,__importDefault:pf,__classPrivateFieldGet:yf,__classPrivateFieldSet:vf}),Ef=Ct(bf),jt={},os;function as(){return os||(os=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.PINO_CUSTOM_CONTEXT_KEY=jt.PINO_LOGGER_DEFAULTS=void 0,jt.PINO_LOGGER_DEFAULTS={level:"info"},jt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),jt}var nt={},us;function wf(){if(us)return nt;us=1,Object.defineProperty(nt,"__esModule",{value:!0}),nt.generateChildLogger=nt.formatChildLoggerContext=nt.getLoggerContext=nt.setBrowserLoggerContext=nt.getBrowserLoggerContext=nt.getDefaultLoggerOptions=void 0;const e=as();function t(c){return Object.assign(Object.assign({},c),{level:c?.level||e.PINO_LOGGER_DEFAULTS.level})}nt.getDefaultLoggerOptions=t;function r(c,h=e.PINO_CUSTOM_CONTEXT_KEY){return c[h]||""}nt.getBrowserLoggerContext=r;function n(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){return c[f]=h,c}nt.setBrowserLoggerContext=n;function i(c,h=e.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof c.bindings>"u"?f=r(c,h):f=c.bindings().context||"",f}nt.getLoggerContext=i;function s(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){const l=i(c,f);return l.trim()?`${l}/${h}`:h}nt.formatChildLoggerContext=s;function o(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){const l=s(c,h,f),w=c.child({context:l});return n(w,l,f)}return nt.generateChildLogger=o,nt}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.pino=void 0;const t=Ef,r=t.__importDefault(an);Object.defineProperty(e,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(as(),e),t.__exportStar(wf(),e)})(Re);var cs={exports:{}},Yt=typeof Reflect=="object"?Reflect:null,fs=Yt&&typeof Yt.apply=="function"?Yt.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},Ur;Yt&&typeof Yt.ownKeys=="function"?Ur=Yt.ownKeys:Object.getOwnPropertySymbols?Ur=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Ur=function(t){return Object.getOwnPropertyNames(t)};function mf(e){console&&console.warn&&console.warn(e)}var hs=Number.isNaN||function(t){return t!==t};function Oe(){Oe.init.call(this)}cs.exports=Oe,cs.exports.once=xf,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var ls=10;function Mr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return ls},set:function(e){if(typeof e!="number"||e<0||hs(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ls=e}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||hs(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function ds(e){return e._maxListeners===void 0?Oe.defaultMaxListeners:e._maxListeners}Oe.prototype.getMaxListeners=function(){return ds(this)},Oe.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")fs(h,this,r);else for(var f=h.length,l=vs(h,f),n=0;n<f;++n)fs(l[n],this,r);return!0};function _s(e,t,r,n){var i,s,o;if(Mr(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),o===void 0)o=s[t]=r,++e._eventsCount;else if(typeof o=="function"?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=ds(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,mf(c)}return e}Oe.prototype.addListener=function(t,r){return _s(this,t,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(t,r){return _s(this,t,r,!0)};function Df(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gs(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=Df.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(t,r){return Mr(r),this.on(t,gs(this,t,r)),this},Oe.prototype.prependOnceListener=function(t,r){return Mr(r),this.prependListener(t,gs(this,t,r)),this},Oe.prototype.removeListener=function(t,r){var n,i,s,o,c;if(Mr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){c=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():Sf(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function ps(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Of(i):vs(i,i.length)}Oe.prototype.listeners=function(t){return ps(this,t,!0)},Oe.prototype.rawListeners=function(t){return ps(this,t,!1)},Oe.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):ys.call(e,t)},Oe.prototype.listenerCount=ys;function ys(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?Ur(this._events):[]};function vs(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Sf(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Of(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function xf(e,t){return new Promise(function(r,n){function i(o){e.removeListener(t,s),n(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}bs(e,t,s,{once:!0}),t!=="error"&&Tf(e,i,{once:!0})})}function Tf(e,t,r){typeof e.on=="function"&&bs(e,"error",t,r)}function bs(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}class Lf extends Ut{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Rf extends Ut{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class If{constructor(t,r){this.logger=t,this.core=r}}class Af extends Ut{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Cf extends Ut{constructor(t){super()}}class Pf{constructor(t,r,n,i){this.core=t,this.logger=r,this.name=n}}class Nf extends Ut{constructor(t,r){super(),this.relayer=t,this.logger=r}}class Uf extends Ut{constructor(t,r){super(),this.core=t,this.logger=r}}function Es(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}function In(e){return typeof e=="string"?e:JSON.stringify(e)}var An={},Xt={},jr={},$r={};Object.defineProperty($r,"__esModule",{value:!0}),$r.BrowserRandomSource=void 0;const ws=65536;class Mf{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let n=0;n<r.length;n+=ws)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,ws)));return r}}$r.BrowserRandomSource=Mf;function jf(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Fr={},ut={};Object.defineProperty(ut,"__esModule",{value:!0});function $f(e){for(var t=0;t<e.length;t++)e[t]=0;return e}ut.wipe=$f;var Ff={},Bf=Object.freeze({__proto__:null,default:Ff}),zf=Ct(Bf);Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.NodeRandomSource=void 0;const Hf=ut;class Kf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof jf<"u"){const t=zf;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(t);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Hf.wipe)(r),n}}Fr.NodeRandomSource=Kf,Object.defineProperty(jr,"__esModule",{value:!0}),jr.SystemRandomSource=void 0;const Gf=$r,Vf=Fr;class Wf{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Gf.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Vf.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}jr.SystemRandomSource=Wf;var ee={},ms={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(c,h){var f=c>>>16&65535,l=c&65535,w=h>>>16&65535,b=h&65535;return l*b+(f*b+l*w<<16>>>0)|0}e.mul=Math.imul||t;function r(c,h){return c+h|0}e.add=r;function n(c,h){return c-h|0}e.sub=n;function i(c,h){return c<<h|c>>>32-h}e.rotl=i;function s(c,h){return c<<32-h|c>>>h}e.rotr=s;function o(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}e.isInteger=Number.isInteger||o,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(c){return e.isInteger(c)&&c>=-e.MAX_SAFE_INTEGER&&c<=e.MAX_SAFE_INTEGER}})(ms),Object.defineProperty(ee,"__esModule",{value:!0});var Ds=ms;function qf(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}ee.readInt16BE=qf;function Yf(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}ee.readUint16BE=Yf;function Xf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}ee.readInt16LE=Xf;function kf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}ee.readUint16LE=kf;function Ss(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}ee.writeUint16BE=Ss,ee.writeInt16BE=Ss;function Os(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}ee.writeUint16LE=Os,ee.writeInt16LE=Os;function Cn(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}ee.readInt32BE=Cn;function Pn(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}ee.readUint32BE=Pn;function Nn(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}ee.readInt32LE=Nn;function Un(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}ee.readUint32LE=Un;function Br(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}ee.writeUint32BE=Br,ee.writeInt32BE=Br;function zr(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}ee.writeUint32LE=zr,ee.writeInt32LE=zr;function Jf(e,t){t===void 0&&(t=0);var r=Cn(e,t),n=Cn(e,t+4);return r*4294967296+n-(n>>31)*4294967296}ee.readInt64BE=Jf;function Zf(e,t){t===void 0&&(t=0);var r=Pn(e,t),n=Pn(e,t+4);return r*4294967296+n}ee.readUint64BE=Zf;function Qf(e,t){t===void 0&&(t=0);var r=Nn(e,t),n=Nn(e,t+4);return n*4294967296+r-(r>>31)*4294967296}ee.readInt64LE=Qf;function eh(e,t){t===void 0&&(t=0);var r=Un(e,t),n=Un(e,t+4);return n*4294967296+r}ee.readUint64LE=eh;function xs(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Br(e/4294967296>>>0,t,r),Br(e>>>0,t,r+4),t}ee.writeUint64BE=xs,ee.writeInt64BE=xs;function Ts(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),zr(e>>>0,t,r),zr(e/4294967296>>>0,t,r+4),t}ee.writeUint64LE=Ts,ee.writeInt64LE=Ts;function th(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}ee.readUintBE=th;function rh(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}ee.readUintLE=rh;function nh(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Ds.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,s=e/8+n-1;s>=n;s--)r[s]=t/i&255,i*=256;return r}ee.writeUintBE=nh;function ih(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Ds.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+e/8;s++)r[s]=t/i&255,i*=256;return r}ee.writeUintLE=ih;function sh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}ee.readFloat32BE=sh;function oh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}ee.readFloat32LE=oh;function ah(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}ee.readFloat64BE=ah;function uh(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}ee.readFloat64LE=uh;function ch(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}ee.writeFloat32BE=ch;function fh(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}ee.writeFloat32LE=fh;function hh(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}ee.writeFloat64BE=hh;function lh(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}ee.writeFloat64LE=lh,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=jr,r=ee,n=ut;e.defaultRandomSource=new t.SystemRandomSource;function i(f,l=e.defaultRandomSource){return l.randomBytes(f)}e.randomBytes=i;function s(f=e.defaultRandomSource){const l=i(4,f),w=(0,r.readUint32LE)(l);return(0,n.wipe)(l),w}e.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(f,l=o,w=e.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let b="";const v=l.length,T=256-256%v;for(;f>0;){const U=i(Math.ceil(f*256/T),w);for(let P=0;P<U.length&&f>0;P++){const K=U[P];K<T&&(b+=l.charAt(K%v),f--)}(0,n.wipe)(U)}return b}e.randomString=c;function h(f,l=o,w=e.defaultRandomSource){const b=Math.ceil(f/(Math.log(l.length)/Math.LN2));return c(b,l,w)}e.randomStringForEntropy=h}(Xt);var Ls={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ee,r=ut;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var n=function(){function c(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,w=f/536870912|0,b=f<<3,v=f%128<112?128:256;this._buffer[l]=128;for(var T=l+1;T<v-8;T++)this._buffer[T]=0;t.writeUint32BE(w,this._buffer,v-8),t.writeUint32BE(b,this._buffer,v-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,v),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)t.writeUint32BE(this._stateHi[T],h,T*8),t.writeUint32BE(this._stateLo[T],h,T*8+4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();e.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,h,f,l,w,b,v){for(var T=f[0],U=f[1],P=f[2],K=f[3],S=f[4],L=f[5],p=f[6],E=f[7],y=l[0],a=l[1],_=l[2],j=l[3],F=l[4],Y=l[5],k=l[6],J=l[7],I,R,W,$,C,N,M,B;v>=128;){for(var re=0;re<16;re++){var z=8*re+b;c[re]=t.readUint32BE(w,z),h[re]=t.readUint32BE(w,z+4)}for(var re=0;re<80;re++){var Z=T,q=U,oe=P,x=K,O=S,m=L,u=p,g=E,H=y,G=a,fe=_,pe=j,le=F,be=Y,je=k,Pe=J;if(I=E,R=J,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=(S>>>14|F<<32-14)^(S>>>18|F<<32-18)^(F>>>41-32|S<<32-(41-32)),R=(F>>>14|S<<32-14)^(F>>>18|S<<32-18)^(S>>>41-32|F<<32-(41-32)),C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,I=S&L^~S&p,R=F&Y^~F&k,C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,I=i[re*2],R=i[re*2+1],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,I=c[re%16],R=h[re%16],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,W=M&65535|B<<16,$=C&65535|N<<16,I=W,R=$,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=(T>>>28|y<<32-28)^(y>>>34-32|T<<32-(34-32))^(y>>>39-32|T<<32-(39-32)),R=(y>>>28|T<<32-28)^(T>>>34-32|y<<32-(34-32))^(T>>>39-32|y<<32-(39-32)),C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,I=T&U^T&P^U&P,R=y&a^y&_^a&_,C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,g=M&65535|B<<16,Pe=C&65535|N<<16,I=x,R=pe,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=W,R=$,C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,x=M&65535|B<<16,pe=C&65535|N<<16,U=Z,P=q,K=oe,S=x,L=O,p=m,E=u,T=g,a=H,_=G,j=fe,F=pe,Y=le,k=be,J=je,y=Pe,re%16===15)for(var z=0;z<16;z++)I=c[z],R=h[z],C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=c[(z+9)%16],R=h[(z+9)%16],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,W=c[(z+1)%16],$=h[(z+1)%16],I=(W>>>1|$<<32-1)^(W>>>8|$<<32-8)^W>>>7,R=($>>>1|W<<32-1)^($>>>8|W<<32-8)^($>>>7|W<<32-7),C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,W=c[(z+14)%16],$=h[(z+14)%16],I=(W>>>19|$<<32-19)^($>>>61-32|W<<32-(61-32))^W>>>6,R=($>>>19|W<<32-19)^(W>>>61-32|$<<32-(61-32))^($>>>6|W<<32-6),C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,c[z]=M&65535|B<<16,h[z]=C&65535|N<<16}I=T,R=y,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=f[0],R=l[0],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[0]=T=M&65535|B<<16,l[0]=y=C&65535|N<<16,I=U,R=a,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=f[1],R=l[1],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[1]=U=M&65535|B<<16,l[1]=a=C&65535|N<<16,I=P,R=_,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=f[2],R=l[2],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[2]=P=M&65535|B<<16,l[2]=_=C&65535|N<<16,I=K,R=j,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=f[3],R=l[3],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[3]=K=M&65535|B<<16,l[3]=j=C&65535|N<<16,I=S,R=F,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=f[4],R=l[4],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[4]=S=M&65535|B<<16,l[4]=F=C&65535|N<<16,I=L,R=Y,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=f[5],R=l[5],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[5]=L=M&65535|B<<16,l[5]=Y=C&65535|N<<16,I=p,R=k,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=f[6],R=l[6],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[6]=p=M&65535|B<<16,l[6]=k=C&65535|N<<16,I=E,R=J,C=R&65535,N=R>>>16,M=I&65535,B=I>>>16,I=f[7],R=l[7],C+=R&65535,N+=R>>>16,M+=I&65535,B+=I>>>16,N+=C>>>16,M+=N>>>16,B+=M>>>16,f[7]=E=M&65535|B<<16,l[7]=J=C&65535|N<<16,b+=128,v-=128}return b}function o(c){var h=new n;h.update(c);var f=h.digest();return h.clean(),f}e.hash=o})(Ls),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=Xt,r=Ls,n=ut;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function i(x){const O=new Float64Array(16);if(x)for(let m=0;m<x.length;m++)O[m]=x[m];return O}const s=new Uint8Array(32);s[0]=9;const o=i(),c=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),w=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function v(x,O){for(let m=0;m<16;m++)x[m]=O[m]|0}function T(x){let O=1;for(let m=0;m<16;m++){let u=x[m]+O+65535;O=Math.floor(u/65536),x[m]=u-O*65536}x[0]+=O-1+37*(O-1)}function U(x,O,m){const u=~(m-1);for(let g=0;g<16;g++){const H=u&(x[g]^O[g]);x[g]^=H,O[g]^=H}}function P(x,O){const m=i(),u=i();for(let g=0;g<16;g++)u[g]=O[g];T(u),T(u),T(u);for(let g=0;g<2;g++){m[0]=u[0]-65517;for(let G=1;G<15;G++)m[G]=u[G]-65535-(m[G-1]>>16&1),m[G-1]&=65535;m[15]=u[15]-32767-(m[14]>>16&1);const H=m[15]>>16&1;m[14]&=65535,U(u,m,1-H)}for(let g=0;g<16;g++)x[2*g]=u[g]&255,x[2*g+1]=u[g]>>8}function K(x,O){let m=0;for(let u=0;u<32;u++)m|=x[u]^O[u];return(1&m-1>>>8)-1}function S(x,O){const m=new Uint8Array(32),u=new Uint8Array(32);return P(m,x),P(u,O),K(m,u)}function L(x){const O=new Uint8Array(32);return P(O,x),O[0]&1}function p(x,O){for(let m=0;m<16;m++)x[m]=O[2*m]+(O[2*m+1]<<8);x[15]&=32767}function E(x,O,m){for(let u=0;u<16;u++)x[u]=O[u]+m[u]}function y(x,O,m){for(let u=0;u<16;u++)x[u]=O[u]-m[u]}function a(x,O,m){let u,g,H=0,G=0,fe=0,pe=0,le=0,be=0,je=0,Pe=0,ge=0,de=0,he=0,ue=0,ae=0,se=0,ie=0,Q=0,ce=0,_e=0,te=0,ye=0,ve=0,we=0,me=0,Ee=0,pt=0,Et=0,Lt=0,ct=0,Ft=0,Or=0,Qr=0,$e=m[0],Ne=m[1],Fe=m[2],Be=m[3],ze=m[4],Ue=m[5],Ge=m[6],Ve=m[7],We=m[8],qe=m[9],Ye=m[10],Ke=m[11],He=m[12],Ae=m[13],Xe=m[14],ke=m[15];u=O[0],H+=u*$e,G+=u*Ne,fe+=u*Fe,pe+=u*Be,le+=u*ze,be+=u*Ue,je+=u*Ge,Pe+=u*Ve,ge+=u*We,de+=u*qe,he+=u*Ye,ue+=u*Ke,ae+=u*He,se+=u*Ae,ie+=u*Xe,Q+=u*ke,u=O[1],G+=u*$e,fe+=u*Ne,pe+=u*Fe,le+=u*Be,be+=u*ze,je+=u*Ue,Pe+=u*Ge,ge+=u*Ve,de+=u*We,he+=u*qe,ue+=u*Ye,ae+=u*Ke,se+=u*He,ie+=u*Ae,Q+=u*Xe,ce+=u*ke,u=O[2],fe+=u*$e,pe+=u*Ne,le+=u*Fe,be+=u*Be,je+=u*ze,Pe+=u*Ue,ge+=u*Ge,de+=u*Ve,he+=u*We,ue+=u*qe,ae+=u*Ye,se+=u*Ke,ie+=u*He,Q+=u*Ae,ce+=u*Xe,_e+=u*ke,u=O[3],pe+=u*$e,le+=u*Ne,be+=u*Fe,je+=u*Be,Pe+=u*ze,ge+=u*Ue,de+=u*Ge,he+=u*Ve,ue+=u*We,ae+=u*qe,se+=u*Ye,ie+=u*Ke,Q+=u*He,ce+=u*Ae,_e+=u*Xe,te+=u*ke,u=O[4],le+=u*$e,be+=u*Ne,je+=u*Fe,Pe+=u*Be,ge+=u*ze,de+=u*Ue,he+=u*Ge,ue+=u*Ve,ae+=u*We,se+=u*qe,ie+=u*Ye,Q+=u*Ke,ce+=u*He,_e+=u*Ae,te+=u*Xe,ye+=u*ke,u=O[5],be+=u*$e,je+=u*Ne,Pe+=u*Fe,ge+=u*Be,de+=u*ze,he+=u*Ue,ue+=u*Ge,ae+=u*Ve,se+=u*We,ie+=u*qe,Q+=u*Ye,ce+=u*Ke,_e+=u*He,te+=u*Ae,ye+=u*Xe,ve+=u*ke,u=O[6],je+=u*$e,Pe+=u*Ne,ge+=u*Fe,de+=u*Be,he+=u*ze,ue+=u*Ue,ae+=u*Ge,se+=u*Ve,ie+=u*We,Q+=u*qe,ce+=u*Ye,_e+=u*Ke,te+=u*He,ye+=u*Ae,ve+=u*Xe,we+=u*ke,u=O[7],Pe+=u*$e,ge+=u*Ne,de+=u*Fe,he+=u*Be,ue+=u*ze,ae+=u*Ue,se+=u*Ge,ie+=u*Ve,Q+=u*We,ce+=u*qe,_e+=u*Ye,te+=u*Ke,ye+=u*He,ve+=u*Ae,we+=u*Xe,me+=u*ke,u=O[8],ge+=u*$e,de+=u*Ne,he+=u*Fe,ue+=u*Be,ae+=u*ze,se+=u*Ue,ie+=u*Ge,Q+=u*Ve,ce+=u*We,_e+=u*qe,te+=u*Ye,ye+=u*Ke,ve+=u*He,we+=u*Ae,me+=u*Xe,Ee+=u*ke,u=O[9],de+=u*$e,he+=u*Ne,ue+=u*Fe,ae+=u*Be,se+=u*ze,ie+=u*Ue,Q+=u*Ge,ce+=u*Ve,_e+=u*We,te+=u*qe,ye+=u*Ye,ve+=u*Ke,we+=u*He,me+=u*Ae,Ee+=u*Xe,pt+=u*ke,u=O[10],he+=u*$e,ue+=u*Ne,ae+=u*Fe,se+=u*Be,ie+=u*ze,Q+=u*Ue,ce+=u*Ge,_e+=u*Ve,te+=u*We,ye+=u*qe,ve+=u*Ye,we+=u*Ke,me+=u*He,Ee+=u*Ae,pt+=u*Xe,Et+=u*ke,u=O[11],ue+=u*$e,ae+=u*Ne,se+=u*Fe,ie+=u*Be,Q+=u*ze,ce+=u*Ue,_e+=u*Ge,te+=u*Ve,ye+=u*We,ve+=u*qe,we+=u*Ye,me+=u*Ke,Ee+=u*He,pt+=u*Ae,Et+=u*Xe,Lt+=u*ke,u=O[12],ae+=u*$e,se+=u*Ne,ie+=u*Fe,Q+=u*Be,ce+=u*ze,_e+=u*Ue,te+=u*Ge,ye+=u*Ve,ve+=u*We,we+=u*qe,me+=u*Ye,Ee+=u*Ke,pt+=u*He,Et+=u*Ae,Lt+=u*Xe,ct+=u*ke,u=O[13],se+=u*$e,ie+=u*Ne,Q+=u*Fe,ce+=u*Be,_e+=u*ze,te+=u*Ue,ye+=u*Ge,ve+=u*Ve,we+=u*We,me+=u*qe,Ee+=u*Ye,pt+=u*Ke,Et+=u*He,Lt+=u*Ae,ct+=u*Xe,Ft+=u*ke,u=O[14],ie+=u*$e,Q+=u*Ne,ce+=u*Fe,_e+=u*Be,te+=u*ze,ye+=u*Ue,ve+=u*Ge,we+=u*Ve,me+=u*We,Ee+=u*qe,pt+=u*Ye,Et+=u*Ke,Lt+=u*He,ct+=u*Ae,Ft+=u*Xe,Or+=u*ke,u=O[15],Q+=u*$e,ce+=u*Ne,_e+=u*Fe,te+=u*Be,ye+=u*ze,ve+=u*Ue,we+=u*Ge,me+=u*Ve,Ee+=u*We,pt+=u*qe,Et+=u*Ye,Lt+=u*Ke,ct+=u*He,Ft+=u*Ae,Or+=u*Xe,Qr+=u*ke,H+=38*ce,G+=38*_e,fe+=38*te,pe+=38*ye,le+=38*ve,be+=38*we,je+=38*me,Pe+=38*Ee,ge+=38*pt,de+=38*Et,he+=38*Lt,ue+=38*ct,ae+=38*Ft,se+=38*Or,ie+=38*Qr,g=1,u=H+g+65535,g=Math.floor(u/65536),H=u-g*65536,u=G+g+65535,g=Math.floor(u/65536),G=u-g*65536,u=fe+g+65535,g=Math.floor(u/65536),fe=u-g*65536,u=pe+g+65535,g=Math.floor(u/65536),pe=u-g*65536,u=le+g+65535,g=Math.floor(u/65536),le=u-g*65536,u=be+g+65535,g=Math.floor(u/65536),be=u-g*65536,u=je+g+65535,g=Math.floor(u/65536),je=u-g*65536,u=Pe+g+65535,g=Math.floor(u/65536),Pe=u-g*65536,u=ge+g+65535,g=Math.floor(u/65536),ge=u-g*65536,u=de+g+65535,g=Math.floor(u/65536),de=u-g*65536,u=he+g+65535,g=Math.floor(u/65536),he=u-g*65536,u=ue+g+65535,g=Math.floor(u/65536),ue=u-g*65536,u=ae+g+65535,g=Math.floor(u/65536),ae=u-g*65536,u=se+g+65535,g=Math.floor(u/65536),se=u-g*65536,u=ie+g+65535,g=Math.floor(u/65536),ie=u-g*65536,u=Q+g+65535,g=Math.floor(u/65536),Q=u-g*65536,H+=g-1+37*(g-1),g=1,u=H+g+65535,g=Math.floor(u/65536),H=u-g*65536,u=G+g+65535,g=Math.floor(u/65536),G=u-g*65536,u=fe+g+65535,g=Math.floor(u/65536),fe=u-g*65536,u=pe+g+65535,g=Math.floor(u/65536),pe=u-g*65536,u=le+g+65535,g=Math.floor(u/65536),le=u-g*65536,u=be+g+65535,g=Math.floor(u/65536),be=u-g*65536,u=je+g+65535,g=Math.floor(u/65536),je=u-g*65536,u=Pe+g+65535,g=Math.floor(u/65536),Pe=u-g*65536,u=ge+g+65535,g=Math.floor(u/65536),ge=u-g*65536,u=de+g+65535,g=Math.floor(u/65536),de=u-g*65536,u=he+g+65535,g=Math.floor(u/65536),he=u-g*65536,u=ue+g+65535,g=Math.floor(u/65536),ue=u-g*65536,u=ae+g+65535,g=Math.floor(u/65536),ae=u-g*65536,u=se+g+65535,g=Math.floor(u/65536),se=u-g*65536,u=ie+g+65535,g=Math.floor(u/65536),ie=u-g*65536,u=Q+g+65535,g=Math.floor(u/65536),Q=u-g*65536,H+=g-1+37*(g-1),x[0]=H,x[1]=G,x[2]=fe,x[3]=pe,x[4]=le,x[5]=be,x[6]=je,x[7]=Pe,x[8]=ge,x[9]=de,x[10]=he,x[11]=ue,x[12]=ae,x[13]=se,x[14]=ie,x[15]=Q}function _(x,O){a(x,O,O)}function j(x,O){const m=i();let u;for(u=0;u<16;u++)m[u]=O[u];for(u=253;u>=0;u--)_(m,m),u!==2&&u!==4&&a(m,m,O);for(u=0;u<16;u++)x[u]=m[u]}function F(x,O){const m=i();let u;for(u=0;u<16;u++)m[u]=O[u];for(u=250;u>=0;u--)_(m,m),u!==1&&a(m,m,O);for(u=0;u<16;u++)x[u]=m[u]}function Y(x,O){const m=i(),u=i(),g=i(),H=i(),G=i(),fe=i(),pe=i(),le=i(),be=i();y(m,x[1],x[0]),y(be,O[1],O[0]),a(m,m,be),E(u,x[0],x[1]),E(be,O[0],O[1]),a(u,u,be),a(g,x[3],O[3]),a(g,g,f),a(H,x[2],O[2]),E(H,H,H),y(G,u,m),y(fe,H,g),E(pe,H,g),E(le,u,m),a(x[0],G,fe),a(x[1],le,pe),a(x[2],pe,fe),a(x[3],G,le)}function k(x,O,m){for(let u=0;u<4;u++)U(x[u],O[u],m)}function J(x,O){const m=i(),u=i(),g=i();j(g,O[2]),a(m,O[0],g),a(u,O[1],g),P(x,u),x[31]^=L(m)<<7}function I(x,O,m){v(x[0],o),v(x[1],c),v(x[2],c),v(x[3],o);for(let u=255;u>=0;--u){const g=m[u/8|0]>>(u&7)&1;k(x,O,g),Y(O,x),Y(x,x),k(x,O,g)}}function R(x,O){const m=[i(),i(),i(),i()];v(m[0],l),v(m[1],w),v(m[2],c),a(m[3],l,w),I(x,m,O)}function W(x){if(x.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const O=(0,r.hash)(x);O[0]&=248,O[31]&=127,O[31]|=64;const m=new Uint8Array(32),u=[i(),i(),i(),i()];R(u,O),J(m,u);const g=new Uint8Array(64);return g.set(x),g.set(m,32),{publicKey:m,secretKey:g}}e.generateKeyPairFromSeed=W;function $(x){const O=(0,t.randomBytes)(32,x),m=W(O);return(0,n.wipe)(O),m}e.generateKeyPair=$;function C(x){if(x.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(x.subarray(32))}e.extractPublicKeyFromSecretKey=C;const N=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(x,O){let m,u,g,H;for(u=63;u>=32;--u){for(m=0,g=u-32,H=u-12;g<H;++g)O[g]+=m-16*O[u]*N[g-(u-32)],m=Math.floor((O[g]+128)/256),O[g]-=m*256;O[g]+=m,O[u]=0}for(m=0,g=0;g<32;g++)O[g]+=m-(O[31]>>4)*N[g],m=O[g]>>8,O[g]&=255;for(g=0;g<32;g++)O[g]-=m*N[g];for(u=0;u<32;u++)O[u+1]+=O[u]>>8,x[u]=O[u]&255}function B(x){const O=new Float64Array(64);for(let m=0;m<64;m++)O[m]=x[m];for(let m=0;m<64;m++)x[m]=0;M(x,O)}function re(x,O){const m=new Float64Array(64),u=[i(),i(),i(),i()],g=(0,r.hash)(x.subarray(0,32));g[0]&=248,g[31]&=127,g[31]|=64;const H=new Uint8Array(64);H.set(g.subarray(32),32);const G=new r.SHA512;G.update(H.subarray(32)),G.update(O);const fe=G.digest();G.clean(),B(fe),R(u,fe),J(H,u),G.reset(),G.update(H.subarray(0,32)),G.update(x.subarray(32)),G.update(O);const pe=G.digest();B(pe);for(let le=0;le<32;le++)m[le]=fe[le];for(let le=0;le<32;le++)for(let be=0;be<32;be++)m[le+be]+=pe[le]*g[be];return M(H.subarray(32),m),H}e.sign=re;function z(x,O){const m=i(),u=i(),g=i(),H=i(),G=i(),fe=i(),pe=i();return v(x[2],c),p(x[1],O),_(g,x[1]),a(H,g,h),y(g,g,x[2]),E(H,x[2],H),_(G,H),_(fe,G),a(pe,fe,G),a(m,pe,g),a(m,m,H),F(m,m),a(m,m,g),a(m,m,H),a(m,m,H),a(x[0],m,H),_(u,x[0]),a(u,u,H),S(u,g)&&a(x[0],x[0],b),_(u,x[0]),a(u,u,H),S(u,g)?-1:(L(x[0])===O[31]>>7&&y(x[0],o,x[0]),a(x[3],x[0],x[1]),0)}function Z(x,O,m){const u=new Uint8Array(32),g=[i(),i(),i(),i()],H=[i(),i(),i(),i()];if(m.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(z(H,x))return!1;const G=new r.SHA512;G.update(m.subarray(0,32)),G.update(x),G.update(O);const fe=G.digest();return B(fe),I(g,H,fe),R(H,m.subarray(32)),Y(g,H),J(u,g),!K(m,u)}e.verify=Z;function q(x){let O=[i(),i(),i(),i()];if(z(O,x))throw new Error("Ed25519: invalid public key");let m=i(),u=i(),g=O[1];E(m,c,g),y(u,c,g),j(u,u),a(m,m,u);let H=new Uint8Array(32);return P(H,m),H}e.convertPublicKeyToX25519=q;function oe(x){const O=(0,r.hash)(x.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const m=new Uint8Array(O.subarray(0,32));return(0,n.wipe)(O),m}e.convertSecretKeyToX25519=oe}(An);const dh="EdDSA",_h="JWT",Rs=".",Is="base64url",gh="utf8",ph="utf8",yh=":",vh="did",bh="key",As="base58btc",Eh="z",wh="K36",mh=32;function Cs(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Mn(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const r=Cs(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return r}function Dh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var c=e.length,h=e.charAt(0),f=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function w(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var U=0,P=0,K=0,S=T.length;K!==S&&T[K]===0;)K++,U++;for(var L=(S-K)*l+1>>>0,p=new Uint8Array(L);K!==S;){for(var E=T[K],y=0,a=L-1;(E!==0||y<P)&&a!==-1;a--,y++)E+=256*p[a]>>>0,p[a]=E%c>>>0,E=E/c>>>0;if(E!==0)throw new Error("Non-zero carry");P=y,K++}for(var _=L-P;_!==L&&p[_]===0;)_++;for(var j=h.repeat(U);_<L;++_)j+=e.charAt(p[_]);return j}function b(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var U=0;if(T[U]!==" "){for(var P=0,K=0;T[U]===h;)P++,U++;for(var S=(T.length-U)*f+1>>>0,L=new Uint8Array(S);T[U];){var p=r[T.charCodeAt(U)];if(p===255)return;for(var E=0,y=S-1;(p!==0||E<K)&&y!==-1;y--,E++)p+=c*L[y]>>>0,L[y]=p%256>>>0,p=p/256>>>0;if(p!==0)throw new Error("Non-zero carry");K=E,U++}if(T[U]!==" "){for(var a=S-K;a!==S&&L[a]===0;)a++;for(var _=new Uint8Array(P+(S-a)),j=P;a!==S;)_[j++]=L[a++];return _}}}function v(T){var U=b(T);if(U)return U;throw new Error(`Non-${t} character`)}return{encode:w,decodeUnsafe:b,decode:v}}var Sh=Dh,Oh=Sh;const Ps=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},xh=e=>new TextEncoder().encode(e),Th=e=>new TextDecoder().decode(e);class Lh{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Rh{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ns(this,t)}}class Ih{constructor(t){this.decoders=t}or(t){return Ns(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ns=(e,t)=>new Ih({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ah{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Lh(t,r,n),this.decoder=new Rh(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Hr=({name:e,prefix:t,encode:r,decode:n})=>new Ah(e,t,r,n),pr=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Oh(r,t);return Hr({prefix:e,name:t,encode:n,decode:s=>Ps(i(s))})},Ch=(e,t,r,n)=>{const i={};for(let l=0;l<t.length;++l)i[t[l]]=l;let s=e.length;for(;e[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let c=0,h=0,f=0;for(let l=0;l<s;++l){const w=i[e[l]];if(w===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|w,c+=r,c>=8&&(c-=8,o[f++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return o},Ph=(e,t,r)=>{const n=t[t.length-1]==="=",i=(1<<r)-1;let s="",o=0,c=0;for(let h=0;h<e.length;++h)for(c=c<<8|e[h],o+=8;o>r;)o-=r,s+=t[i&c>>o];if(o&&(s+=t[i&c<<r-o]),n)for(;s.length*r&7;)s+="=";return s},Qe=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Hr({prefix:t,name:e,encode(i){return Ph(i,n,r)},decode(i){return Ch(i,n,r,e)}}),Nh=Hr({prefix:"\0",name:"identity",encode:e=>Th(e),decode:e=>xh(e)});var Uh=Object.freeze({__proto__:null,identity:Nh});const Mh=Qe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var jh=Object.freeze({__proto__:null,base2:Mh});const $h=Qe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Fh=Object.freeze({__proto__:null,base8:$h});const Bh=pr({prefix:"9",name:"base10",alphabet:"0123456789"});var zh=Object.freeze({__proto__:null,base10:Bh});const Hh=Qe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kh=Qe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Gh=Object.freeze({__proto__:null,base16:Hh,base16upper:Kh});const Vh=Qe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Wh=Qe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),qh=Qe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Yh=Qe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Xh=Qe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kh=Qe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Jh=Qe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zh=Qe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qh=Qe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var el=Object.freeze({__proto__:null,base32:Vh,base32upper:Wh,base32pad:qh,base32padupper:Yh,base32hex:Xh,base32hexupper:kh,base32hexpad:Jh,base32hexpadupper:Zh,base32z:Qh});const tl=pr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rl=pr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var nl=Object.freeze({__proto__:null,base36:tl,base36upper:rl});const il=pr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),sl=pr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ol=Object.freeze({__proto__:null,base58btc:il,base58flickr:sl});const al=Qe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ul=Qe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),cl=Qe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),fl=Qe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var hl=Object.freeze({__proto__:null,base64:al,base64pad:ul,base64url:cl,base64urlpad:fl});const Us=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),ll=Us.reduce((e,t,r)=>(e[r]=t,e),[]),dl=Us.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function _l(e){return e.reduce((t,r)=>(t+=ll[r],t),"")}function gl(e){const t=[];for(const r of e){const n=dl[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const pl=Hr({prefix:"\u{1F680}",name:"base256emoji",encode:_l,decode:gl});var yl=Object.freeze({__proto__:null,base256emoji:pl}),vl=js,Ms=128,bl=127,El=~bl,wl=Math.pow(2,31);function js(e,t,r){t=t||[],r=r||0;for(var n=r;e>=wl;)t[r++]=e&255|Ms,e/=128;for(;e&El;)t[r++]=e&255|Ms,e>>>=7;return t[r]=e|0,js.bytes=r-n+1,t}var ml=jn,Dl=128,$s=127;function jn(e,n){var r=0,n=n||0,i=0,s=n,o,c=e.length;do{if(s>=c)throw jn.bytes=0,new RangeError("Could not decode varint");o=e[s++],r+=i<28?(o&$s)<<i:(o&$s)*Math.pow(2,i),i+=7}while(o>=Dl);return jn.bytes=s-n,r}var Sl=Math.pow(2,7),Ol=Math.pow(2,14),xl=Math.pow(2,21),Tl=Math.pow(2,28),Ll=Math.pow(2,35),Rl=Math.pow(2,42),Il=Math.pow(2,49),Al=Math.pow(2,56),Cl=Math.pow(2,63),Pl=function(e){return e<Sl?1:e<Ol?2:e<xl?3:e<Tl?4:e<Ll?5:e<Rl?6:e<Il?7:e<Al?8:e<Cl?9:10},Nl={encode:vl,decode:ml,encodingLength:Pl},Fs=Nl;const Bs=(e,t,r=0)=>(Fs.encode(e,t,r),t),zs=e=>Fs.encodingLength(e),$n=(e,t)=>{const r=t.byteLength,n=zs(e),i=n+zs(r),s=new Uint8Array(i+r);return Bs(e,s,0),Bs(r,s,n),s.set(t,i),new Ul(e,r,t,s)};class Ul{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}const Hs=({name:e,code:t,encode:r})=>new Ml(e,t,r);class Ml{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?$n(this.code,r):r.then(n=>$n(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Ks=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),jl=Hs({name:"sha2-256",code:18,encode:Ks("SHA-256")}),$l=Hs({name:"sha2-512",code:19,encode:Ks("SHA-512")});var Fl=Object.freeze({__proto__:null,sha256:jl,sha512:$l});const Gs=0,Bl="identity",Vs=Ps;var zl=Object.freeze({__proto__:null,identity:{code:Gs,name:Bl,encode:Vs,digest:e=>$n(Gs,Vs(e))}});new TextEncoder,new TextDecoder;const Ws={...Uh,...jh,...Fh,...zh,...Gh,...el,...nl,...ol,...hl,...yl};({...Fl,...zl});function qs(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Ys=qs("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Fn=qs("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=Cs(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Xs={utf8:Ys,"utf-8":Ys,hex:Ws.base16,latin1:Fn,ascii:Fn,binary:Fn,...Ws};function ot(e,t="utf8"){const r=Xs[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function it(e,t="utf8"){const r=Xs[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}function Kr(e){return ot(it(In(e),gh),Is)}function ks(e){const t=it(wh,As),r=Eh+ot(Mn([t,e]),As);return[vh,bh,r].join(yh)}function Hl(e){return ot(e,Is)}function Kl(e){return it([Kr(e.header),Kr(e.payload)].join(Rs),ph)}function Gl(e){return[Kr(e.header),Kr(e.payload),Hl(e.signature)].join(Rs)}function Js(e=Xt.randomBytes(mh)){return An.generateKeyPairFromSeed(e)}async function Vl(e,t,r,n,i=De.fromMiliseconds(Date.now())){const s={alg:dh,typ:_h},o=ks(n.publicKey),c=i+r,h={iss:o,sub:e,aud:t,iat:i,exp:c},f=Kl({header:s,payload:h}),l=An.sign(n.secretKey,f);return Gl({header:s,payload:h,signature:l})}var Bn={},Gr={};Object.defineProperty(Gr,"__esModule",{value:!0});var tt=ee,zn=ut,Wl=20;function ql(e,t,r){for(var n=1634760805,i=857760878,s=2036477234,o=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],w=r[19]<<24|r[18]<<16|r[17]<<8|r[16],b=r[23]<<24|r[22]<<16|r[21]<<8|r[20],v=r[27]<<24|r[26]<<16|r[25]<<8|r[24],T=r[31]<<24|r[30]<<16|r[29]<<8|r[28],U=t[3]<<24|t[2]<<16|t[1]<<8|t[0],P=t[7]<<24|t[6]<<16|t[5]<<8|t[4],K=t[11]<<24|t[10]<<16|t[9]<<8|t[8],S=t[15]<<24|t[14]<<16|t[13]<<8|t[12],L=n,p=i,E=s,y=o,a=c,_=h,j=f,F=l,Y=w,k=b,J=v,I=T,R=U,W=P,$=K,C=S,N=0;N<Wl;N+=2)L=L+a|0,R^=L,R=R>>>32-16|R<<16,Y=Y+R|0,a^=Y,a=a>>>32-12|a<<12,p=p+_|0,W^=p,W=W>>>32-16|W<<16,k=k+W|0,_^=k,_=_>>>32-12|_<<12,E=E+j|0,$^=E,$=$>>>32-16|$<<16,J=J+$|0,j^=J,j=j>>>32-12|j<<12,y=y+F|0,C^=y,C=C>>>32-16|C<<16,I=I+C|0,F^=I,F=F>>>32-12|F<<12,E=E+j|0,$^=E,$=$>>>32-8|$<<8,J=J+$|0,j^=J,j=j>>>32-7|j<<7,y=y+F|0,C^=y,C=C>>>32-8|C<<8,I=I+C|0,F^=I,F=F>>>32-7|F<<7,p=p+_|0,W^=p,W=W>>>32-8|W<<8,k=k+W|0,_^=k,_=_>>>32-7|_<<7,L=L+a|0,R^=L,R=R>>>32-8|R<<8,Y=Y+R|0,a^=Y,a=a>>>32-7|a<<7,L=L+_|0,C^=L,C=C>>>32-16|C<<16,J=J+C|0,_^=J,_=_>>>32-12|_<<12,p=p+j|0,R^=p,R=R>>>32-16|R<<16,I=I+R|0,j^=I,j=j>>>32-12|j<<12,E=E+F|0,W^=E,W=W>>>32-16|W<<16,Y=Y+W|0,F^=Y,F=F>>>32-12|F<<12,y=y+a|0,$^=y,$=$>>>32-16|$<<16,k=k+$|0,a^=k,a=a>>>32-12|a<<12,E=E+F|0,W^=E,W=W>>>32-8|W<<8,Y=Y+W|0,F^=Y,F=F>>>32-7|F<<7,y=y+a|0,$^=y,$=$>>>32-8|$<<8,k=k+$|0,a^=k,a=a>>>32-7|a<<7,p=p+j|0,R^=p,R=R>>>32-8|R<<8,I=I+R|0,j^=I,j=j>>>32-7|j<<7,L=L+_|0,C^=L,C=C>>>32-8|C<<8,J=J+C|0,_^=J,_=_>>>32-7|_<<7;tt.writeUint32LE(L+n|0,e,0),tt.writeUint32LE(p+i|0,e,4),tt.writeUint32LE(E+s|0,e,8),tt.writeUint32LE(y+o|0,e,12),tt.writeUint32LE(a+c|0,e,16),tt.writeUint32LE(_+h|0,e,20),tt.writeUint32LE(j+f|0,e,24),tt.writeUint32LE(F+l|0,e,28),tt.writeUint32LE(Y+w|0,e,32),tt.writeUint32LE(k+b|0,e,36),tt.writeUint32LE(J+v|0,e,40),tt.writeUint32LE(I+T|0,e,44),tt.writeUint32LE(R+U|0,e,48),tt.writeUint32LE(W+P|0,e,52),tt.writeUint32LE($+K|0,e,56),tt.writeUint32LE(C+S|0,e,60)}function Zs(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-t.length,s.set(t,o)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=t,o=i}for(var c=new Uint8Array(64),h=0;h<r.length;h+=64){ql(c,s,e);for(var f=h;f<h+64&&f<r.length;f++)n[f]=r[f]^c[f-h];Xl(s,0,o)}return zn.wipe(c),i===0&&zn.wipe(s),n}Gr.streamXOR=Zs;function Yl(e,t,r,n){return n===void 0&&(n=0),zn.wipe(r),Zs(e,t,r,r,n)}Gr.stream=Yl;function Xl(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}var Qs={},Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});function kl(e,t,r){return~(e-1)&t|e-1&r}Tt.select=kl;function Jl(e,t){return(e|0)-(t|0)-1>>>31&1}Tt.lessOrEqual=Jl;function eo(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Tt.compare=eo;function Zl(e,t){return e.length===0||t.length===0?!1:eo(e,t)!==0}Tt.equal=Zl,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Tt,r=ut;e.DIGEST_LENGTH=16;var n=function(){function o(c){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=c[0]|c[1]<<8;this._r[0]=h&8191;var f=c[2]|c[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var l=c[4]|c[5]<<8;this._r[2]=(f>>>10|l<<6)&7939;var w=c[6]|c[7]<<8;this._r[3]=(l>>>7|w<<9)&8191;var b=c[8]|c[9]<<8;this._r[4]=(w>>>4|b<<12)&255,this._r[5]=b>>>1&8190;var v=c[10]|c[11]<<8;this._r[6]=(b>>>14|v<<2)&8191;var T=c[12]|c[13]<<8;this._r[7]=(v>>>11|T<<5)&8065;var U=c[14]|c[15]<<8;this._r[8]=(T>>>8|U<<8)&8191,this._r[9]=U>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return o.prototype._blocks=function(c,h,f){for(var l=this._fin?0:2048,w=this._h[0],b=this._h[1],v=this._h[2],T=this._h[3],U=this._h[4],P=this._h[5],K=this._h[6],S=this._h[7],L=this._h[8],p=this._h[9],E=this._r[0],y=this._r[1],a=this._r[2],_=this._r[3],j=this._r[4],F=this._r[5],Y=this._r[6],k=this._r[7],J=this._r[8],I=this._r[9];f>=16;){var R=c[h+0]|c[h+1]<<8;w+=R&8191;var W=c[h+2]|c[h+3]<<8;b+=(R>>>13|W<<3)&8191;var $=c[h+4]|c[h+5]<<8;v+=(W>>>10|$<<6)&8191;var C=c[h+6]|c[h+7]<<8;T+=($>>>7|C<<9)&8191;var N=c[h+8]|c[h+9]<<8;U+=(C>>>4|N<<12)&8191,P+=N>>>1&8191;var M=c[h+10]|c[h+11]<<8;K+=(N>>>14|M<<2)&8191;var B=c[h+12]|c[h+13]<<8;S+=(M>>>11|B<<5)&8191;var re=c[h+14]|c[h+15]<<8;L+=(B>>>8|re<<8)&8191,p+=re>>>5|l;var z=0,Z=z;Z+=w*E,Z+=b*(5*I),Z+=v*(5*J),Z+=T*(5*k),Z+=U*(5*Y),z=Z>>>13,Z&=8191,Z+=P*(5*F),Z+=K*(5*j),Z+=S*(5*_),Z+=L*(5*a),Z+=p*(5*y),z+=Z>>>13,Z&=8191;var q=z;q+=w*y,q+=b*E,q+=v*(5*I),q+=T*(5*J),q+=U*(5*k),z=q>>>13,q&=8191,q+=P*(5*Y),q+=K*(5*F),q+=S*(5*j),q+=L*(5*_),q+=p*(5*a),z+=q>>>13,q&=8191;var oe=z;oe+=w*a,oe+=b*y,oe+=v*E,oe+=T*(5*I),oe+=U*(5*J),z=oe>>>13,oe&=8191,oe+=P*(5*k),oe+=K*(5*Y),oe+=S*(5*F),oe+=L*(5*j),oe+=p*(5*_),z+=oe>>>13,oe&=8191;var x=z;x+=w*_,x+=b*a,x+=v*y,x+=T*E,x+=U*(5*I),z=x>>>13,x&=8191,x+=P*(5*J),x+=K*(5*k),x+=S*(5*Y),x+=L*(5*F),x+=p*(5*j),z+=x>>>13,x&=8191;var O=z;O+=w*j,O+=b*_,O+=v*a,O+=T*y,O+=U*E,z=O>>>13,O&=8191,O+=P*(5*I),O+=K*(5*J),O+=S*(5*k),O+=L*(5*Y),O+=p*(5*F),z+=O>>>13,O&=8191;var m=z;m+=w*F,m+=b*j,m+=v*_,m+=T*a,m+=U*y,z=m>>>13,m&=8191,m+=P*E,m+=K*(5*I),m+=S*(5*J),m+=L*(5*k),m+=p*(5*Y),z+=m>>>13,m&=8191;var u=z;u+=w*Y,u+=b*F,u+=v*j,u+=T*_,u+=U*a,z=u>>>13,u&=8191,u+=P*y,u+=K*E,u+=S*(5*I),u+=L*(5*J),u+=p*(5*k),z+=u>>>13,u&=8191;var g=z;g+=w*k,g+=b*Y,g+=v*F,g+=T*j,g+=U*_,z=g>>>13,g&=8191,g+=P*a,g+=K*y,g+=S*E,g+=L*(5*I),g+=p*(5*J),z+=g>>>13,g&=8191;var H=z;H+=w*J,H+=b*k,H+=v*Y,H+=T*F,H+=U*j,z=H>>>13,H&=8191,H+=P*_,H+=K*a,H+=S*y,H+=L*E,H+=p*(5*I),z+=H>>>13,H&=8191;var G=z;G+=w*I,G+=b*J,G+=v*k,G+=T*Y,G+=U*F,z=G>>>13,G&=8191,G+=P*j,G+=K*_,G+=S*a,G+=L*y,G+=p*E,z+=G>>>13,G&=8191,z=(z<<2)+z|0,z=z+Z|0,Z=z&8191,z=z>>>13,q+=z,w=Z,b=q,v=oe,T=x,U=O,P=m,K=u,S=g,L=H,p=G,h+=16,f-=16}this._h[0]=w,this._h[1]=b,this._h[2]=v,this._h[3]=T,this._h[4]=U,this._h[5]=P,this._h[6]=K,this._h[7]=S,this._h[8]=L,this._h[9]=p},o.prototype.finish=function(c,h){h===void 0&&(h=0);var f=new Uint16Array(10),l,w,b,v;if(this._leftover){for(v=this._leftover,this._buffer[v++]=1;v<16;v++)this._buffer[v]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,v=2;v<10;v++)this._h[v]+=l,l=this._h[v]>>>13,this._h[v]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,f[0]=this._h[0]+5,l=f[0]>>>13,f[0]&=8191,v=1;v<10;v++)f[v]=this._h[v]+l,l=f[v]>>>13,f[v]&=8191;for(f[9]-=1<<13,w=(l^1)-1,v=0;v<10;v++)f[v]&=w;for(w=~w,v=0;v<10;v++)this._h[v]=this._h[v]&w|f[v];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,b=this._h[0]+this._pad[0],this._h[0]=b&65535,v=1;v<8;v++)b=(this._h[v]+this._pad[v]|0)+(b>>>16)|0,this._h[v]=b&65535;return c[h+0]=this._h[0]>>>0,c[h+1]=this._h[0]>>>8,c[h+2]=this._h[1]>>>0,c[h+3]=this._h[1]>>>8,c[h+4]=this._h[2]>>>0,c[h+5]=this._h[2]>>>8,c[h+6]=this._h[3]>>>0,c[h+7]=this._h[3]>>>8,c[h+8]=this._h[4]>>>0,c[h+9]=this._h[4]>>>8,c[h+10]=this._h[5]>>>0,c[h+11]=this._h[5]>>>8,c[h+12]=this._h[6]>>>0,c[h+13]=this._h[6]>>>8,c[h+14]=this._h[7]>>>0,c[h+15]=this._h[7]>>>8,this._finished=!0,this},o.prototype.update=function(c){var h=0,f=c.length,l;if(this._leftover){l=16-this._leftover,l>f&&(l=f);for(var w=0;w<l;w++)this._buffer[this._leftover+w]=c[h+w];if(f-=l,h+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(l=f-f%16,this._blocks(c,h,l),h+=l,f-=l),f){for(var w=0;w<f;w++)this._buffer[this._leftover+w]=c[h+w];this._leftover+=f}return this},o.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},o.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},o}();e.Poly1305=n;function i(o,c){var h=new n(o);h.update(c);var f=h.digest();return h.clean(),f}e.oneTimeAuth=i;function s(o,c){return o.length!==e.DIGEST_LENGTH||c.length!==e.DIGEST_LENGTH?!1:t.equal(o,c)}e.equal=s}(Qs),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Gr,r=Qs,n=ut,i=ee,s=Tt;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var o=new Uint8Array(16),c=function(){function h(f){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,f.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,l,w,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var v=new Uint8Array(16);v.set(f,v.length-f.length);var T=new Uint8Array(32);t.stream(this._key,v,T,4);var U=l.length+this.tagLength,P;if(b){if(b.length!==U)throw new Error("ChaCha20Poly1305: incorrect destination length");P=b}else P=new Uint8Array(U);return t.streamXOR(this._key,v,l,P,4),this._authenticate(P.subarray(P.length-this.tagLength,P.length),T,P.subarray(0,P.length-this.tagLength),w),n.wipe(v),P},h.prototype.open=function(f,l,w,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var v=new Uint8Array(16);v.set(f,v.length-f.length);var T=new Uint8Array(32);t.stream(this._key,v,T,4);var U=new Uint8Array(this.tagLength);if(this._authenticate(U,T,l.subarray(0,l.length-this.tagLength),w),!s.equal(U,l.subarray(l.length-this.tagLength,l.length)))return null;var P=l.length-this.tagLength,K;if(b){if(b.length!==P)throw new Error("ChaCha20Poly1305: incorrect destination length");K=b}else K=new Uint8Array(P);return t.streamXOR(this._key,v,l.subarray(0,l.length-this.tagLength),K,4),n.wipe(v),K},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(f,l,w,b){var v=new r.Poly1305(l);b&&(v.update(b),b.length%16>0&&v.update(o.subarray(b.length%16))),v.update(w),w.length%16>0&&v.update(o.subarray(w.length%16));var T=new Uint8Array(8);b&&i.writeUint64LE(b.length,T),v.update(T),i.writeUint64LE(w.length,T),v.update(T);for(var U=v.digest(),P=0;P<U.length;P++)f[P]=U[P];v.clean(),n.wipe(U),n.wipe(T)},h}();e.ChaCha20Poly1305=c}(Bn);var to={},yr={},Hn={};Object.defineProperty(Hn,"__esModule",{value:!0});function Ql(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}Hn.isSerializableHash=Ql,Object.defineProperty(yr,"__esModule",{value:!0});var bt=Hn,ed=Tt,td=ut,ro=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),bt.isSerializableHash(this._inner)&&bt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),td.wipe(n)}return e.prototype.reset=function(){if(!bt.isSerializableHash(this._inner)||!bt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){bt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),bt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!bt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!bt.isSerializableHash(this._inner)||!bt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!bt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();yr.HMAC=ro;function rd(e,t,r){var n=new ro(e,t);n.update(r);var i=n.digest();return n.clean(),i}yr.hmac=rd,yr.equal=ed.equal,Object.defineProperty(to,"__esModule",{value:!0});var no=yr,io=ut,nd=function(){function e(t,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var s=no.hmac(this._hash,n,r);this._hmac=new no.HMAC(t,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),io.wipe(this._buffer),io.wipe(this._counter),this._bufpos=0},e}(),id=to.HKDF=nd,Vr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ee,r=ut;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var n=function(){function c(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._temp,this._state,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,w=f/536870912|0,b=f<<3,v=f%64<56?64:128;this._buffer[l]=128;for(var T=l+1;T<v-8;T++)this._buffer[T]=0;t.writeUint32BE(w,this._buffer,v-8),t.writeUint32BE(b,this._buffer,v-4),s(this._temp,this._state,this._buffer,0,v),this._finished=!0}for(var T=0;T<this.digestLength/4;T++)t.writeUint32BE(this._state[T],h,T*4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();e.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,h,f,l,w){for(;w>=64;){for(var b=h[0],v=h[1],T=h[2],U=h[3],P=h[4],K=h[5],S=h[6],L=h[7],p=0;p<16;p++){var E=l+p*4;c[p]=t.readUint32BE(f,E)}for(var p=16;p<64;p++){var y=c[p-2],a=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=c[p-15];var _=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;c[p]=(a+c[p-7]|0)+(_+c[p-16]|0)}for(var p=0;p<64;p++){var a=(((P>>>6|P<<26)^(P>>>11|P<<21)^(P>>>25|P<<7))+(P&K^~P&S)|0)+(L+(i[p]+c[p]|0)|0)|0,_=((b>>>2|b<<32-2)^(b>>>13|b<<32-13)^(b>>>22|b<<32-22))+(b&v^b&T^v&T)|0;L=S,S=K,K=P,P=U+a|0,U=T,T=v,v=b,b=a+_|0}h[0]+=b,h[1]+=v,h[2]+=T,h[3]+=U,h[4]+=P,h[5]+=K,h[6]+=S,h[7]+=L,l+=64,w-=64}return l}function o(c){var h=new n;h.update(c);var f=h.digest();return h.clean(),f}e.hash=o})(Vr);var Kn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const t=Xt,r=ut;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function n(p){const E=new Float64Array(16);if(p)for(let y=0;y<p.length;y++)E[y]=p[y];return E}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function o(p){let E=1;for(let y=0;y<16;y++){let a=p[y]+E+65535;E=Math.floor(a/65536),p[y]=a-E*65536}p[0]+=E-1+37*(E-1)}function c(p,E,y){const a=~(y-1);for(let _=0;_<16;_++){const j=a&(p[_]^E[_]);p[_]^=j,E[_]^=j}}function h(p,E){const y=n(),a=n();for(let _=0;_<16;_++)a[_]=E[_];o(a),o(a),o(a);for(let _=0;_<2;_++){y[0]=a[0]-65517;for(let F=1;F<15;F++)y[F]=a[F]-65535-(y[F-1]>>16&1),y[F-1]&=65535;y[15]=a[15]-32767-(y[14]>>16&1);const j=y[15]>>16&1;y[14]&=65535,c(a,y,1-j)}for(let _=0;_<16;_++)p[2*_]=a[_]&255,p[2*_+1]=a[_]>>8}function f(p,E){for(let y=0;y<16;y++)p[y]=E[2*y]+(E[2*y+1]<<8);p[15]&=32767}function l(p,E,y){for(let a=0;a<16;a++)p[a]=E[a]+y[a]}function w(p,E,y){for(let a=0;a<16;a++)p[a]=E[a]-y[a]}function b(p,E,y){let a,_,j=0,F=0,Y=0,k=0,J=0,I=0,R=0,W=0,$=0,C=0,N=0,M=0,B=0,re=0,z=0,Z=0,q=0,oe=0,x=0,O=0,m=0,u=0,g=0,H=0,G=0,fe=0,pe=0,le=0,be=0,je=0,Pe=0,ge=y[0],de=y[1],he=y[2],ue=y[3],ae=y[4],se=y[5],ie=y[6],Q=y[7],ce=y[8],_e=y[9],te=y[10],ye=y[11],ve=y[12],we=y[13],me=y[14],Ee=y[15];a=E[0],j+=a*ge,F+=a*de,Y+=a*he,k+=a*ue,J+=a*ae,I+=a*se,R+=a*ie,W+=a*Q,$+=a*ce,C+=a*_e,N+=a*te,M+=a*ye,B+=a*ve,re+=a*we,z+=a*me,Z+=a*Ee,a=E[1],F+=a*ge,Y+=a*de,k+=a*he,J+=a*ue,I+=a*ae,R+=a*se,W+=a*ie,$+=a*Q,C+=a*ce,N+=a*_e,M+=a*te,B+=a*ye,re+=a*ve,z+=a*we,Z+=a*me,q+=a*Ee,a=E[2],Y+=a*ge,k+=a*de,J+=a*he,I+=a*ue,R+=a*ae,W+=a*se,$+=a*ie,C+=a*Q,N+=a*ce,M+=a*_e,B+=a*te,re+=a*ye,z+=a*ve,Z+=a*we,q+=a*me,oe+=a*Ee,a=E[3],k+=a*ge,J+=a*de,I+=a*he,R+=a*ue,W+=a*ae,$+=a*se,C+=a*ie,N+=a*Q,M+=a*ce,B+=a*_e,re+=a*te,z+=a*ye,Z+=a*ve,q+=a*we,oe+=a*me,x+=a*Ee,a=E[4],J+=a*ge,I+=a*de,R+=a*he,W+=a*ue,$+=a*ae,C+=a*se,N+=a*ie,M+=a*Q,B+=a*ce,re+=a*_e,z+=a*te,Z+=a*ye,q+=a*ve,oe+=a*we,x+=a*me,O+=a*Ee,a=E[5],I+=a*ge,R+=a*de,W+=a*he,$+=a*ue,C+=a*ae,N+=a*se,M+=a*ie,B+=a*Q,re+=a*ce,z+=a*_e,Z+=a*te,q+=a*ye,oe+=a*ve,x+=a*we,O+=a*me,m+=a*Ee,a=E[6],R+=a*ge,W+=a*de,$+=a*he,C+=a*ue,N+=a*ae,M+=a*se,B+=a*ie,re+=a*Q,z+=a*ce,Z+=a*_e,q+=a*te,oe+=a*ye,x+=a*ve,O+=a*we,m+=a*me,u+=a*Ee,a=E[7],W+=a*ge,$+=a*de,C+=a*he,N+=a*ue,M+=a*ae,B+=a*se,re+=a*ie,z+=a*Q,Z+=a*ce,q+=a*_e,oe+=a*te,x+=a*ye,O+=a*ve,m+=a*we,u+=a*me,g+=a*Ee,a=E[8],$+=a*ge,C+=a*de,N+=a*he,M+=a*ue,B+=a*ae,re+=a*se,z+=a*ie,Z+=a*Q,q+=a*ce,oe+=a*_e,x+=a*te,O+=a*ye,m+=a*ve,u+=a*we,g+=a*me,H+=a*Ee,a=E[9],C+=a*ge,N+=a*de,M+=a*he,B+=a*ue,re+=a*ae,z+=a*se,Z+=a*ie,q+=a*Q,oe+=a*ce,x+=a*_e,O+=a*te,m+=a*ye,u+=a*ve,g+=a*we,H+=a*me,G+=a*Ee,a=E[10],N+=a*ge,M+=a*de,B+=a*he,re+=a*ue,z+=a*ae,Z+=a*se,q+=a*ie,oe+=a*Q,x+=a*ce,O+=a*_e,m+=a*te,u+=a*ye,g+=a*ve,H+=a*we,G+=a*me,fe+=a*Ee,a=E[11],M+=a*ge,B+=a*de,re+=a*he,z+=a*ue,Z+=a*ae,q+=a*se,oe+=a*ie,x+=a*Q,O+=a*ce,m+=a*_e,u+=a*te,g+=a*ye,H+=a*ve,G+=a*we,fe+=a*me,pe+=a*Ee,a=E[12],B+=a*ge,re+=a*de,z+=a*he,Z+=a*ue,q+=a*ae,oe+=a*se,x+=a*ie,O+=a*Q,m+=a*ce,u+=a*_e,g+=a*te,H+=a*ye,G+=a*ve,fe+=a*we,pe+=a*me,le+=a*Ee,a=E[13],re+=a*ge,z+=a*de,Z+=a*he,q+=a*ue,oe+=a*ae,x+=a*se,O+=a*ie,m+=a*Q,u+=a*ce,g+=a*_e,H+=a*te,G+=a*ye,fe+=a*ve,pe+=a*we,le+=a*me,be+=a*Ee,a=E[14],z+=a*ge,Z+=a*de,q+=a*he,oe+=a*ue,x+=a*ae,O+=a*se,m+=a*ie,u+=a*Q,g+=a*ce,H+=a*_e,G+=a*te,fe+=a*ye,pe+=a*ve,le+=a*we,be+=a*me,je+=a*Ee,a=E[15],Z+=a*ge,q+=a*de,oe+=a*he,x+=a*ue,O+=a*ae,m+=a*se,u+=a*ie,g+=a*Q,H+=a*ce,G+=a*_e,fe+=a*te,pe+=a*ye,le+=a*ve,be+=a*we,je+=a*me,Pe+=a*Ee,j+=38*q,F+=38*oe,Y+=38*x,k+=38*O,J+=38*m,I+=38*u,R+=38*g,W+=38*H,$+=38*G,C+=38*fe,N+=38*pe,M+=38*le,B+=38*be,re+=38*je,z+=38*Pe,_=1,a=j+_+65535,_=Math.floor(a/65536),j=a-_*65536,a=F+_+65535,_=Math.floor(a/65536),F=a-_*65536,a=Y+_+65535,_=Math.floor(a/65536),Y=a-_*65536,a=k+_+65535,_=Math.floor(a/65536),k=a-_*65536,a=J+_+65535,_=Math.floor(a/65536),J=a-_*65536,a=I+_+65535,_=Math.floor(a/65536),I=a-_*65536,a=R+_+65535,_=Math.floor(a/65536),R=a-_*65536,a=W+_+65535,_=Math.floor(a/65536),W=a-_*65536,a=$+_+65535,_=Math.floor(a/65536),$=a-_*65536,a=C+_+65535,_=Math.floor(a/65536),C=a-_*65536,a=N+_+65535,_=Math.floor(a/65536),N=a-_*65536,a=M+_+65535,_=Math.floor(a/65536),M=a-_*65536,a=B+_+65535,_=Math.floor(a/65536),B=a-_*65536,a=re+_+65535,_=Math.floor(a/65536),re=a-_*65536,a=z+_+65535,_=Math.floor(a/65536),z=a-_*65536,a=Z+_+65535,_=Math.floor(a/65536),Z=a-_*65536,j+=_-1+37*(_-1),_=1,a=j+_+65535,_=Math.floor(a/65536),j=a-_*65536,a=F+_+65535,_=Math.floor(a/65536),F=a-_*65536,a=Y+_+65535,_=Math.floor(a/65536),Y=a-_*65536,a=k+_+65535,_=Math.floor(a/65536),k=a-_*65536,a=J+_+65535,_=Math.floor(a/65536),J=a-_*65536,a=I+_+65535,_=Math.floor(a/65536),I=a-_*65536,a=R+_+65535,_=Math.floor(a/65536),R=a-_*65536,a=W+_+65535,_=Math.floor(a/65536),W=a-_*65536,a=$+_+65535,_=Math.floor(a/65536),$=a-_*65536,a=C+_+65535,_=Math.floor(a/65536),C=a-_*65536,a=N+_+65535,_=Math.floor(a/65536),N=a-_*65536,a=M+_+65535,_=Math.floor(a/65536),M=a-_*65536,a=B+_+65535,_=Math.floor(a/65536),B=a-_*65536,a=re+_+65535,_=Math.floor(a/65536),re=a-_*65536,a=z+_+65535,_=Math.floor(a/65536),z=a-_*65536,a=Z+_+65535,_=Math.floor(a/65536),Z=a-_*65536,j+=_-1+37*(_-1),p[0]=j,p[1]=F,p[2]=Y,p[3]=k,p[4]=J,p[5]=I,p[6]=R,p[7]=W,p[8]=$,p[9]=C,p[10]=N,p[11]=M,p[12]=B,p[13]=re,p[14]=z,p[15]=Z}function v(p,E){b(p,E,E)}function T(p,E){const y=n();for(let a=0;a<16;a++)y[a]=E[a];for(let a=253;a>=0;a--)v(y,y),a!==2&&a!==4&&b(y,y,E);for(let a=0;a<16;a++)p[a]=y[a]}function U(p,E){const y=new Uint8Array(32),a=new Float64Array(80),_=n(),j=n(),F=n(),Y=n(),k=n(),J=n();for(let $=0;$<31;$++)y[$]=p[$];y[31]=p[31]&127|64,y[0]&=248,f(a,E);for(let $=0;$<16;$++)j[$]=a[$];_[0]=Y[0]=1;for(let $=254;$>=0;--$){const C=y[$>>>3]>>>($&7)&1;c(_,j,C),c(F,Y,C),l(k,_,F),w(_,_,F),l(F,j,Y),w(j,j,Y),v(Y,k),v(J,_),b(_,F,_),b(F,j,k),l(k,_,F),w(_,_,F),v(j,_),w(F,Y,J),b(_,F,s),l(_,_,Y),b(F,F,_),b(_,Y,J),b(Y,j,a),v(j,k),c(_,j,C),c(F,Y,C)}for(let $=0;$<16;$++)a[$+16]=_[$],a[$+32]=F[$],a[$+48]=j[$],a[$+64]=Y[$];const I=a.subarray(32),R=a.subarray(16);T(I,I),b(R,R,I);const W=new Uint8Array(32);return h(W,R),W}e.scalarMult=U;function P(p){return U(p,i)}e.scalarMultBase=P;function K(p){if(p.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const E=new Uint8Array(p);return{publicKey:P(E),secretKey:E}}e.generateKeyPairFromSeed=K;function S(p){const E=(0,t.randomBytes)(32,p),y=K(E);return(0,r.wipe)(E),y}e.generateKeyPair=S;function L(p,E,y=!1){if(p.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(E.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const a=U(p,E);if(y){let _=0;for(let j=0;j<a.length;j++)_|=a[j];if(_===0)throw new Error("X25519: invalid shared key")}return a}e.sharedKey=L})(Kn);var so=function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},sd=function(){function e(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return e}(),od=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),ad=function(){function e(t,r,n,i){this.name=t,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return e}(),ud=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),cd=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),fd=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,hd=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,oo=3,ld=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",fd]],ao=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function dd(e){return e?uo(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new cd:typeof navigator<"u"?uo(navigator.userAgent):pd()}function _d(e){return e!==""&&ld.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var s=i.exec(e);return!!s&&[n,s]},!1)}function uo(e){var t=_d(e);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new ud;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<oo&&(i=so(so([],i,!0),yd(oo-i.length),!0)):i=[];var s=i.join("."),o=gd(e),c=hd.exec(e);return c&&c[1]?new ad(r,s,o,c[1]):new sd(r,s,o)}function gd(e){for(var t=0,r=ao.length;t<r;t++){var n=ao[t],i=n[0],s=n[1],o=s.exec(e);if(o)return i}return null}function pd(){var e=typeof process<"u"&&process.version;return e?new od(process.version.slice(1)):null}function yd(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}var Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.getLocalStorage=Te.getLocalStorageOrThrow=Te.getCrypto=Te.getCryptoOrThrow=fo=Te.getLocation=Te.getLocationOrThrow=Gn=Te.getNavigator=Te.getNavigatorOrThrow=co=Te.getDocument=Te.getDocumentOrThrow=Te.getFromWindowOrThrow=Te.getFromWindow=void 0;function $t(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}Te.getFromWindow=$t;function kt(e){const t=$t(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Te.getFromWindowOrThrow=kt;function vd(){return kt("document")}Te.getDocumentOrThrow=vd;function bd(){return $t("document")}var co=Te.getDocument=bd;function Ed(){return kt("navigator")}Te.getNavigatorOrThrow=Ed;function wd(){return $t("navigator")}var Gn=Te.getNavigator=wd;function md(){return kt("location")}Te.getLocationOrThrow=md;function Dd(){return $t("location")}var fo=Te.getLocation=Dd;function Sd(){return kt("crypto")}Te.getCryptoOrThrow=Sd;function Od(){return $t("crypto")}Te.getCrypto=Od;function xd(){return kt("localStorage")}Te.getLocalStorageOrThrow=xd;function Td(){return $t("localStorage")}Te.getLocalStorage=Td;var Vn={};Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.getWindowMetadata=void 0;const ho=Te;function Ld(){let e,t;try{e=ho.getDocumentOrThrow(),t=ho.getLocationOrThrow()}catch{return null}function r(){const w=e.getElementsByTagName("link"),b=[];for(let v=0;v<w.length;v++){const T=w[v],U=T.getAttribute("rel");if(U&&U.toLowerCase().indexOf("icon")>-1){const P=T.getAttribute("href");if(P)if(P.toLowerCase().indexOf("https:")===-1&&P.toLowerCase().indexOf("http:")===-1&&P.indexOf("//")!==0){let K=t.protocol+"//"+t.host;if(P.indexOf("/")===0)K+=P;else{const S=t.pathname.split("/");S.pop();const L=S.join("/");K+=L+"/"+P}b.push(K)}else if(P.indexOf("//")===0){const K=t.protocol+P;b.push(K)}else b.push(P)}}return b}function n(...w){const b=e.getElementsByTagName("meta");for(let v=0;v<b.length;v++){const T=b[v],U=["itemprop","property","name"].map(P=>T.getAttribute(P)).filter(P=>P?w.includes(P):!1);if(U.length&&U){const P=T.getAttribute("content");if(P)return P}}return""}function i(){let w=n("name","og:site_name","og:title","twitter:title");return w||(w=e.title),w}function s(){return n("description","og:description","twitter:description","keywords")}const o=i(),c=s(),h=t.origin,f=r();return{description:c,url:h,icons:f,name:o}}Vn.getWindowMetadata=Ld;var vr={},Rd=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),lo="%[a-f0-9]{2}",_o=new RegExp(lo,"gi"),go=new RegExp("("+lo+")+","gi");function Wn(e,t){try{return decodeURIComponent(e.join(""))}catch{}if(e.length===1)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],Wn(r),Wn(n))}function Id(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(_o),r=1;r<t.length;r++)e=Wn(t,r).join(""),t=e.match(_o);return e}}function Ad(e){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=go.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var n=Id(r[0]);n!==r[0]&&(t[r[0]]=n)}r=go.exec(e)}t["%C2"]="\uFFFD";for(var i=Object.keys(t),s=0;s<i.length;s++){var o=i[s];e=e.replace(new RegExp(o,"g"),t[o])}return e}var Cd=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return Ad(e)}},Pd=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];const r=e.indexOf(t);return r===-1?[e]:[e.slice(0,r),e.slice(r+t.length)]},Nd=function(e,t){for(var r={},n=Object.keys(e),i=Array.isArray(t),s=0;s<n.length;s++){var o=n[s],c=e[o];(i?t.indexOf(o)!==-1:t(o,c,e))&&(r[o]=c)}return r};(function(e){const t=Rd,r=Cd,n=Pd,i=Nd,s=S=>S==null,o=Symbol("encodeFragmentIdentifier");function c(S){switch(S.arrayFormat){case"index":return L=>(p,E)=>{const y=p.length;return E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?p:E===null?[...p,[l(L,S),"[",y,"]"].join("")]:[...p,[l(L,S),"[",l(y,S),"]=",l(E,S)].join("")]};case"bracket":return L=>(p,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?p:E===null?[...p,[l(L,S),"[]"].join("")]:[...p,[l(L,S),"[]=",l(E,S)].join("")];case"colon-list-separator":return L=>(p,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?p:E===null?[...p,[l(L,S),":list="].join("")]:[...p,[l(L,S),":list=",l(E,S)].join("")];case"comma":case"separator":case"bracket-separator":{const L=S.arrayFormat==="bracket-separator"?"[]=":"=";return p=>(E,y)=>y===void 0||S.skipNull&&y===null||S.skipEmptyString&&y===""?E:(y=y===null?"":y,E.length===0?[[l(p,S),L,l(y,S)].join("")]:[[E,l(y,S)].join(S.arrayFormatSeparator)])}default:return L=>(p,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?p:E===null?[...p,l(L,S)]:[...p,[l(L,S),"=",l(E,S)].join("")]}}function h(S){let L;switch(S.arrayFormat){case"index":return(p,E,y)=>{if(L=/\[(\d*)\]$/.exec(p),p=p.replace(/\[\d*\]$/,""),!L){y[p]=E;return}y[p]===void 0&&(y[p]={}),y[p][L[1]]=E};case"bracket":return(p,E,y)=>{if(L=/(\[\])$/.exec(p),p=p.replace(/\[\]$/,""),!L){y[p]=E;return}if(y[p]===void 0){y[p]=[E];return}y[p]=[].concat(y[p],E)};case"colon-list-separator":return(p,E,y)=>{if(L=/(:list)$/.exec(p),p=p.replace(/:list$/,""),!L){y[p]=E;return}if(y[p]===void 0){y[p]=[E];return}y[p]=[].concat(y[p],E)};case"comma":case"separator":return(p,E,y)=>{const a=typeof E=="string"&&E.includes(S.arrayFormatSeparator),_=typeof E=="string"&&!a&&w(E,S).includes(S.arrayFormatSeparator);E=_?w(E,S):E;const j=a||_?E.split(S.arrayFormatSeparator).map(F=>w(F,S)):E===null?E:w(E,S);y[p]=j};case"bracket-separator":return(p,E,y)=>{const a=/(\[\])$/.test(p);if(p=p.replace(/\[\]$/,""),!a){y[p]=E&&w(E,S);return}const _=E===null?[]:E.split(S.arrayFormatSeparator).map(j=>w(j,S));if(y[p]===void 0){y[p]=_;return}y[p]=[].concat(y[p],_)};default:return(p,E,y)=>{if(y[p]===void 0){y[p]=E;return}y[p]=[].concat(y[p],E)}}}function f(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(S,L){return L.encode?L.strict?t(S):encodeURIComponent(S):S}function w(S,L){return L.decode?r(S):S}function b(S){return Array.isArray(S)?S.sort():typeof S=="object"?b(Object.keys(S)).sort((L,p)=>Number(L)-Number(p)).map(L=>S[L]):S}function v(S){const L=S.indexOf("#");return L!==-1&&(S=S.slice(0,L)),S}function T(S){let L="";const p=S.indexOf("#");return p!==-1&&(L=S.slice(p)),L}function U(S){S=v(S);const L=S.indexOf("?");return L===-1?"":S.slice(L+1)}function P(S,L){return L.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):L.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function K(S,L){L=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},L),f(L.arrayFormatSeparator);const p=h(L),E=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return E;for(const y of S.split("&")){if(y==="")continue;let[a,_]=n(L.decode?y.replace(/\+/g," "):y,"=");_=_===void 0?null:["comma","separator","bracket-separator"].includes(L.arrayFormat)?_:w(_,L),p(w(a,L),_,E)}for(const y of Object.keys(E)){const a=E[y];if(typeof a=="object"&&a!==null)for(const _ of Object.keys(a))a[_]=P(a[_],L);else E[y]=P(a,L)}return L.sort===!1?E:(L.sort===!0?Object.keys(E).sort():Object.keys(E).sort(L.sort)).reduce((y,a)=>{const _=E[a];return Boolean(_)&&typeof _=="object"&&!Array.isArray(_)?y[a]=b(_):y[a]=_,y},Object.create(null))}e.extract=U,e.parse=K,e.stringify=(S,L)=>{if(!S)return"";L=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},L),f(L.arrayFormatSeparator);const p=_=>L.skipNull&&s(S[_])||L.skipEmptyString&&S[_]==="",E=c(L),y={};for(const _ of Object.keys(S))p(_)||(y[_]=S[_]);const a=Object.keys(y);return L.sort!==!1&&a.sort(L.sort),a.map(_=>{const j=S[_];return j===void 0?"":j===null?l(_,L):Array.isArray(j)?j.length===0&&L.arrayFormat==="bracket-separator"?l(_,L)+"[]":j.reduce(E(_),[]).join("&"):l(_,L)+"="+l(j,L)}).filter(_=>_.length>0).join("&")},e.parseUrl=(S,L)=>{L=Object.assign({decode:!0},L);const[p,E]=n(S,"#");return Object.assign({url:p.split("?")[0]||"",query:K(U(S),L)},L&&L.parseFragmentIdentifier&&E?{fragmentIdentifier:w(E,L)}:{})},e.stringifyUrl=(S,L)=>{L=Object.assign({encode:!0,strict:!0,[o]:!0},L);const p=v(S.url).split("?")[0]||"",E=e.extract(S.url),y=e.parse(E,{sort:!1}),a=Object.assign(y,S.query);let _=e.stringify(a,L);_&&(_=`?${_}`);let j=T(S.url);return S.fragmentIdentifier&&(j=`#${L[o]?l(S.fragmentIdentifier,L):S.fragmentIdentifier}`),`${p}${_}${j}`},e.pick=(S,L,p)=>{p=Object.assign({parseFragmentIdentifier:!0,[o]:!1},p);const{url:E,query:y,fragmentIdentifier:a}=e.parseUrl(S,p);return e.stringifyUrl({url:E,query:i(y,L),fragmentIdentifier:a},p)},e.exclude=(S,L,p)=>{const E=Array.isArray(L)?y=>!L.includes(y):(y,a)=>!L(y,a);return e.pick(S,E,p)}})(vr);const Ud={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},po="base10",at="base16",qn="base64pad",Yn="utf8",yo=0,Jt=1,Md=0,vo=1,Xn=12,kn=32;function jd(){const e=Kn.generateKeyPair();return{privateKey:ot(e.secretKey,at),publicKey:ot(e.publicKey,at)}}function Jn(){const e=Xt.randomBytes(kn);return ot(e,at)}function $d(e,t){const r=Kn.sharedKey(it(e,at),it(t,at)),n=new id(Vr.SHA256,r).expand(kn);return ot(n,at)}function Fd(e){const t=Vr.hash(it(e,at));return ot(t,at)}function Zn(e){const t=Vr.hash(it(e,Yn));return ot(t,at)}function Bd(e){return it(`${e}`,po)}function br(e){return Number(ot(e,po))}function zd(e){const t=Bd(typeof e.type<"u"?e.type:yo);if(br(t)===Jt&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?it(e.senderPublicKey,at):void 0,n=typeof e.iv<"u"?it(e.iv,at):Xt.randomBytes(Xn),i=new Bn.ChaCha20Poly1305(it(e.symKey,at)).seal(n,it(e.message,Yn));return Kd({type:t,sealed:i,iv:n,senderPublicKey:r})}function Hd(e){const t=new Bn.ChaCha20Poly1305(it(e.symKey,at)),{sealed:r,iv:n}=Qn(e.encoded),i=t.open(n,r);if(i===null)throw new Error("Failed to decrypt");return ot(i,Yn)}function Kd(e){if(br(e.type)===Jt){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ot(Mn([e.type,e.senderPublicKey,e.iv,e.sealed]),qn)}return ot(Mn([e.type,e.iv,e.sealed]),qn)}function Qn(e){const t=it(e,qn),r=t.slice(Md,vo),n=vo;if(br(r)===Jt){const c=n+kn,h=c+Xn,f=t.slice(n,c),l=t.slice(c,h),w=t.slice(h);return{type:r,sealed:w,iv:l,senderPublicKey:f}}const i=n+Xn,s=t.slice(n,i),o=t.slice(i);return{type:r,sealed:o,iv:s}}function Gd(e,t){const r=Qn(e);return bo({type:br(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ot(r.senderPublicKey,at):void 0,receiverPublicKey:t?.receiverPublicKey})}function bo(e){const t=e?.type||yo;if(t===Jt){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Eo(e){return e.type===Jt&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}var Vd=Object.defineProperty,wo=Object.getOwnPropertySymbols,Wd=Object.prototype.hasOwnProperty,qd=Object.prototype.propertyIsEnumerable,mo=(e,t,r)=>t in e?Vd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Do=(e,t)=>{for(var r in t||(t={}))Wd.call(t,r)&&mo(e,r,t[r]);if(wo)for(var r of wo(t))qd.call(t,r)&&mo(e,r,t[r]);return e};const Yd="ReactNative",Er={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Xd="js";function So(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function kd(){return!co()&&!!Gn()&&navigator.product===Yd}function Jd(){return!So()&&!!Gn()}function Zd(){return kd()?Er.reactNative:So()?Er.node:Jd()?Er.browser:Er.unknown}function Qd(e,t){let r=vr.parse(e);return r=Do(Do({},r),t),e=vr.stringify(r),e}function e_(){const e=dd();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function t_(){var e;const t=Zd();return t===Er.browser?[t,((e=fo())==null?void 0:e.host)||"unknown"].join(":"):t}function r_(e,t,r){const n=e_(),i=t_();return[[e,t].join("-"),[Xd,r].join("-"),n,i].join("/")}function n_({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const o=r.split("?"),c=r_(e,t,n),h={auth:i,ua:c,projectId:s},f=Qd(o[1]||"",h);return o[0]+"?"+f}function Oo(e){return Object.fromEntries(e.entries())}function xo(e){return new Map(Object.entries(e))}function ei(e,t){return De.fromMiliseconds((t||Date.now())+De.toMiliseconds(e))}function To(e){return De.fromMiliseconds(Date.now())>=De.toMiliseconds(e)}function i_(e){const t=De.toMiliseconds(e||De.FIVE_MINUTES);let r,n,i;return{resolve:s=>{i&&r&&(clearTimeout(i),r(s))},reject:s=>{i&&n&&(clearTimeout(i),n(s))},done:()=>new Promise((s,o)=>{i=setTimeout(o,t),r=s,n=o})}}function Lo(e,t){return new Promise(async(r,n)=>{const i=setTimeout(()=>n(),t),s=await e;clearTimeout(i),r(s)})}function Ro(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function s_(e){return Ro("topic",e)}function o_(e){return Ro("id",e)}function a_(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")n.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return n}function ti(e,t){return`${e}${t?`:${t}`:""}`}const u_="irn";function ri(e){return e?.relay||{protocol:u_}}function ni(e){const t=Ud[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var c_=Object.defineProperty,Io=Object.getOwnPropertySymbols,f_=Object.prototype.hasOwnProperty,h_=Object.prototype.propertyIsEnumerable,Ao=(e,t,r)=>t in e?c_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l_=(e,t)=>{for(var r in t||(t={}))f_.call(t,r)&&Ao(e,r,t[r]);if(Io)for(var r of Io(t))h_.call(t,r)&&Ao(e,r,t[r]);return e};function d_(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=e[i];r[s]=o}}),r}function __(e){const t=e.indexOf(":"),r=e.indexOf("?")!==-1?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),s=typeof r<"u"?e.substring(r):"",o=vr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:o.symKey,relay:d_(o)}}function g_(e,t="-"){const r="relay",n={};return Object.keys(e).forEach(i=>{const s=r+t+i;e[i]&&(n[s]=e[i])}),n}function p_(e){return`${e.protocol}:${e.topic}@${e.version}?`+vr.stringify(l_({symKey:e.symKey},g_(e.relay)))}const y_={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},v_={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Le(e,t){const{message:r,code:n}=v_[e];return{message:t?`${r} ${t}`:r,code:n}}function wr(e,t){const{message:r,code:n}=y_[e];return{message:t?`${r} ${t}`:r,code:n}}function Wr(e){return typeof e>"u"}function Co(e,t){return t&&Wr(e)?!0:typeof e=="string"&&Boolean(e.trim().length)}function b_(e){if(Co(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function E_(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function w_(e){return e?.topic}function ii(e){return typeof e<"u"&&typeof e!==null}const si="wc",Po=2,qr="core",mt=`${si}@${2}:${qr}:`,No={name:qr,logger:"error"},Uo={database:":memory:"},Mo="crypto",oi="client_ed25519_seed",jo=De.ONE_DAY,$o="keychain",Fo="0.3",Bo="messages",zo="0.3",Ho=De.SIX_HOURS,Ko="publisher",Go="irn",Vo="error",Wo="wss://relay.walletconnect.com",qo="relayer",st={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Yo="_subscription",mr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ai=De.ONE_SECOND,m_={database:":memory:"},Xo="2.2.1",ko="0.3",_t={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},D_=De.THIRTY_DAYS,Jo="subscription",Zo="0.3",Qo=De.FIVE_SECONDS*1e3,ea="pairing",ta="0.3",S_=De.THIRTY_DAYS,Zt={wc_pairingDelete:{req:{ttl:De.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:De.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:De.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:De.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:De.ONE_DAY,prompt:!1,tag:0},res:{ttl:De.ONE_DAY,prompt:!1,tag:0}}},gt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ra="history",na="0.3",ia="expirer",ht={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},sa="0.3",O_=De.ONE_DAY;class oa{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=$o,this.version=Fo,this.initialized=!1,this.storagePrefix=mt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=Le("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Oo(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?xo(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}}class aa{constructor(t,r,n){this.core=t,this.logger=r,this.name=Mo,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=Js(i);return ks(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=jd();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),o=Js(s),c=Jn();return await Vl(c,i,jo,o)},this.generateSharedKey=(i,s,o)=>{this.isInitialized();const c=this.getPrivateKey(i),h=$d(c,s);return this.setSymKey(h,o)},this.setSymKey=async(i,s)=>{this.isInitialized();const o=s||Fd(i);return await this.keychain.set(o,i),o},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,o)=>{this.isInitialized();const c=bo(o),h=In(s);if(Eo(c)){const b=c.senderPublicKey,v=c.receiverPublicKey;i=await this.generateSharedKey(b,v)}const f=this.getSymKey(i),{type:l,senderPublicKey:w}=c;return zd({type:l,symKey:f,message:h,senderPublicKey:w})},this.decode=async(i,s,o)=>{this.isInitialized();const c=Gd(s,o);if(Eo(c)){const l=c.receiverPublicKey,w=c.senderPublicKey;i=await this.generateSharedKey(l,w)}const h=this.getSymKey(i),f=Hd({symKey:h,encoded:s});return Es(f)},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.keychain=n||new oa(this.core,this.logger)}get context(){return Re.getLoggerContext(this.logger)}getPayloadType(t){const r=Qn(t);return br(r.type)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(oi)}catch{t=Jn(),await this.keychain.set(oi,t)}return it(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}}class ua extends If{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=Bo,this.version=zo,this.initialized=!1,this.storagePrefix=mt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=Zn(i);let o=this.messages.get(n);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=i,this.messages.set(n,o),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),o=Zn(i);return typeof s[o]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Re.generateChildLogger(t,this.name),this.core=r}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Oo(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?xo(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}}var x_=Bi();const T_="PARSE_ERROR",L_="INVALID_REQUEST",R_="METHOD_NOT_FOUND",I_="INVALID_PARAMS",ca="INTERNAL_ERROR",ui="SERVER_ERROR",A_=[-32700,-32600,-32601,-32602,-32603],Dr={[T_]:{code:-32700,message:"Parse error"},[L_]:{code:-32600,message:"Invalid Request"},[R_]:{code:-32601,message:"Method not found"},[I_]:{code:-32602,message:"Invalid params"},[ca]:{code:-32603,message:"Internal error"},[ui]:{code:-32e3,message:"Server error"}},fa=ui;function C_(e){return A_.includes(e)}function ha(e){return Object.keys(Dr).includes(e)?Dr[e]:Dr[fa]}function P_(e){const t=Object.values(Dr).find(r=>r.code===e);return t||Dr[fa]}function N_(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var la={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ci=function(e,t){return ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ci(e,t)};function U_(e,t){ci(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var fi=function(){return fi=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},fi.apply(this,arguments)};function M_(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function j_(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function $_(e,t){return function(r,n){t(r,n,e)}}function F_(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function B_(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(w){o(w)}}function h(l){try{f(n.throw(l))}catch(w){o(w)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function z_(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function H_(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function K_(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function hi(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function da(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function G_(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(da(arguments[t]));return e}function V_(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function Sr(e){return this instanceof Sr?(this.v=e,this):new Sr(e)}function W_(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(v){return new Promise(function(T,U){s.push([b,v,T,U])>1||c(b,v)})})}function c(b,v){try{h(n[b](v))}catch(T){w(s[0][3],T)}}function h(b){b.value instanceof Sr?Promise.resolve(b.value.v).then(f,l):w(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function w(b,v){b(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function q_(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:Sr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function Y_(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof hi=="function"?hi(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function X_(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function k_(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function J_(e){return e&&e.__esModule?e:{default:e}}function Z_(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Q_(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var e0=Object.freeze({__proto__:null,__extends:U_,get __assign(){return fi},__rest:M_,__decorate:j_,__param:$_,__metadata:F_,__awaiter:B_,__generator:z_,__createBinding:H_,__exportStar:K_,__values:hi,__read:da,__spread:G_,__spreadArrays:V_,__await:Sr,__asyncGenerator:W_,__asyncDelegator:q_,__asyncValues:Y_,__makeTemplateObject:X_,__importStar:k_,__importDefault:J_,__classPrivateFieldGet:Z_,__classPrivateFieldSet:Q_}),t0=Ct(e0),Dt={},_a;function r0(){if(_a)return Dt;_a=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.isBrowserCryptoAvailable=Dt.getSubtleCrypto=Dt.getBrowerCrypto=void 0;function e(){return Ze?.crypto||Ze?.msCrypto||{}}Dt.getBrowerCrypto=e;function t(){const n=e();return n.subtle||n.webkitSubtle}Dt.getSubtleCrypto=t;function r(){return!!e()&&!!t()}return Dt.isBrowserCryptoAvailable=r,Dt}var St={},ga;function n0(){if(ga)return St;ga=1,Object.defineProperty(St,"__esModule",{value:!0}),St.isBrowser=St.isNode=St.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}St.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}St.isNode=t;function r(){return!e()&&!t()}return St.isBrowser=r,St}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=t0;t.__exportStar(r0(),e),t.__exportStar(n0(),e)})(la);function i0(){const e=Date.now()*Math.pow(10,3),t=Math.floor(Math.random()*Math.pow(10,3));return e+t}function li(e,t,r){return{id:r||i0(),jsonrpc:"2.0",method:e,params:t}}function pa(e,t){return{id:e,jsonrpc:"2.0",result:t}}function ya(e,t,r){return{id:e,jsonrpc:"2.0",error:s0(t,r)}}function s0(e,t){return typeof e>"u"?ha(ca):(typeof e=="string"&&(e=Object.assign(Object.assign({},ha(ui)),{message:e})),typeof t<"u"&&(e.data=t),C_(e.code)&&(e=P_(e.code)),e)}class o0{}class a0 extends o0{constructor(){super()}}class u0 extends a0{constructor(t){super()}}const c0="^wss?:";function f0(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function h0(e,t){const r=f0(e);return typeof r>"u"?!1:new RegExp(t).test(r)}function va(e){return h0(e,c0)}function l0(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function ba(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function Ea(e){return ba(e)&&"method"in e}function wa(e){return ba(e)&&(ma(e)||Yr(e))}function ma(e){return"result"in e}function Yr(e){return"error"in e}class d0 extends u0{constructor(t){super(t),this.events=new x_.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(li(t.method,t.params||[]),r)}async requestStrict(t,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${t.id}`,s=>{Yr(s)?i(s.error):n(s.result)});try{await this.connection.send(t,r)}catch(s){i(s)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),wa(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",t=>this.events.emit("error",t)),this.hasRegisteredEventListeners=!0)}}var di={exports:{}},Qt=typeof Reflect=="object"?Reflect:null,Da=Qt&&typeof Qt.apply=="function"?Qt.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},Xr;Qt&&typeof Qt.ownKeys=="function"?Xr=Qt.ownKeys:Object.getOwnPropertySymbols?Xr=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Xr=function(t){return Object.getOwnPropertyNames(t)};function _0(e){console&&console.warn&&console.warn(e)}var Sa=Number.isNaN||function(t){return t!==t};function xe(){xe.init.call(this)}di.exports=xe,di.exports.once=v0,xe.EventEmitter=xe,xe.prototype._events=void 0,xe.prototype._eventsCount=0,xe.prototype._maxListeners=void 0;var Oa=10;function kr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(xe,"defaultMaxListeners",{enumerable:!0,get:function(){return Oa},set:function(e){if(typeof e!="number"||e<0||Sa(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Oa=e}}),xe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},xe.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Sa(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function xa(e){return e._maxListeners===void 0?xe.defaultMaxListeners:e._maxListeners}xe.prototype.getMaxListeners=function(){return xa(this)},xe.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")Da(h,this,r);else for(var f=h.length,l=Aa(h,f),n=0;n<f;++n)Da(l[n],this,r);return!0};function Ta(e,t,r,n){var i,s,o;if(kr(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),o===void 0)o=s[t]=r,++e._eventsCount;else if(typeof o=="function"?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=xa(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,_0(c)}return e}xe.prototype.addListener=function(t,r){return Ta(this,t,r,!1)},xe.prototype.on=xe.prototype.addListener,xe.prototype.prependListener=function(t,r){return Ta(this,t,r,!0)};function g0(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function La(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=g0.bind(n);return i.listener=r,n.wrapFn=i,i}xe.prototype.once=function(t,r){return kr(r),this.on(t,La(this,t,r)),this},xe.prototype.prependOnceListener=function(t,r){return kr(r),this.prependListener(t,La(this,t,r)),this},xe.prototype.removeListener=function(t,r){var n,i,s,o,c;if(kr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){c=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():p0(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||r)}return this},xe.prototype.off=xe.prototype.removeListener,xe.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function Ra(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?y0(i):Aa(i,i.length)}xe.prototype.listeners=function(t){return Ra(this,t,!0)},xe.prototype.rawListeners=function(t){return Ra(this,t,!1)},xe.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Ia.call(e,t)},xe.prototype.listenerCount=Ia;function Ia(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}xe.prototype.eventNames=function(){return this._eventsCount>0?Xr(this._events):[]};function Aa(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function p0(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function y0(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function v0(e,t){return new Promise(function(r,n){function i(o){e.removeListener(t,s),n(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}Ca(e,t,s,{once:!0}),t!=="error"&&b0(e,i,{once:!0})})}function b0(e,t,r){typeof e.on=="function"&&Ca(e,"error",t,r)}function Ca(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}const Pa=10,E0=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),w0=()=>typeof window<"u",m0=E0();class D0{constructor(t){if(this.url=t,this.events=new di.exports.EventEmitter,this.registering=!1,!va(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(In(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!va(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const i=la.isReactNative()?void 0:{rejectUnauthorized:!l0(t)},s=new m0(t,[],i);w0()?s.onerror=o=>{const c=o;n(this.emitError(c.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=()=>this.onClose(),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?Es(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),i=n.message||n.toString(),s=ya(t,i);this.events.emit("payload",s)}parseError(t,r=this.url){return N_(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>Pa&&this.events.setMaxListeners(Pa)}emitError(t){const r=this.parseError(new Error(t?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}class S0 extends Af{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new wt.exports.EventEmitter,this.name=Ko,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const o=s?.ttl||Ho,c=ri(s),h=s?.prompt||!1,f=s?.tag||0,l={topic:n,message:i,opts:{ttl:o,relay:c,prompt:h,tag:f}},w=Zn(i);this.queue.set(w,l);try{await await Lo(this.rpcPublish(n,i,o,c,h,f),this.publishTimeout),this.relayer.events.emit(st.publish,l)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(st.connection_stalled);return}this.onPublish(w,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Re.getLoggerContext(this.logger)}rpcPublish(t,r,n,i,s,o){var c,h,f,l;const w={method:ni(i.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:s,tag:o}};return Wr((c=w.params)==null?void 0:c.prompt)&&((h=w.params)==null||delete h.prompt),Wr((f=w.params)==null?void 0:f.tag)&&((l=w.params)==null||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:w}),this.relayer.provider.request(w)}onPublish(t,r){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:i}=t;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(ur.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class O0{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(t);return}this.map.set(t,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var x0=Object.defineProperty,T0=Object.defineProperties,L0=Object.getOwnPropertyDescriptors,Na=Object.getOwnPropertySymbols,R0=Object.prototype.hasOwnProperty,I0=Object.prototype.propertyIsEnumerable,Ua=(e,t,r)=>t in e?x0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Jr=(e,t)=>{for(var r in t||(t={}))R0.call(t,r)&&Ua(e,r,t[r]);if(Na)for(var r of Na(t))I0.call(t,r)&&Ua(e,r,t[r]);return e},_i=(e,t)=>T0(e,L0(t));class Ma extends Nf{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new O0,this.events=new wt.exports.EventEmitter,this.name=Jo,this.version=Zo,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=mt,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=ri(i),o={topic:n,relay:s};this.pending.set(n,o);const c=await this.rpcSubscribe(n,s);return this.onSubscribe(c,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const o=new De.Watch;o.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(c),o.stop(this.pendingSubscriptionWatchLabel),i(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=Qo&&(clearInterval(c),o.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=t,this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async i=>await this.unsubscribeById(t,i,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const i=ri(n);await this.rpcUnsubscribe(t,r,i);const s=wr("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(t,r){const n={method:ni(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await Lo(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(st.connection_stalled)}return i}rpcUnsubscribe(t,r,n){const i={method:ni(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(t,r){this.setSubscription(t,_i(Jr({},r),{id:t})),this.pending.delete(r.topic)}onResubscribe(t,r){this.addSubscription(t,_i(Jr({},r),{id:t})),this.pending.delete(r.topic)}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Jr({},r)),this.topicMap.set(r.topic,t),this.events.emit(_t.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=Le("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(_t.deleted,_i(Jr({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(_t.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async t=>await this.resubscribe(t))),this.events.emit(_t.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=Le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async resubscribe(t){if(!this.ids.includes(t.id)){const{topic:r,relay:n}=t,i={topic:r,relay:n};this.pending.set(i.topic,i);const s=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(s,i)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async t=>{const r=await this.rpcSubscribe(t.topic,t.relay);this.onSubscribe(r,t)})}registerEventListeners(){this.relayer.core.heartbeat.on(ur.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(st.connect,async()=>{await this.onConnect()}),this.relayer.on(st.disconnect,()=>{this.onDisconnect()}),this.events.on(_t.created,async t=>{const r=_t.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(_t.deleted,async t=>{const r=_t.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}}var A0=Object.defineProperty,ja=Object.getOwnPropertySymbols,C0=Object.prototype.hasOwnProperty,P0=Object.prototype.propertyIsEnumerable,$a=(e,t,r)=>t in e?A0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,N0=(e,t)=>{for(var r in t||(t={}))C0.call(t,r)&&$a(e,r,t[r]);if(ja)for(var r of ja(t))P0.call(t,r)&&$a(e,r,t[r]);return e};class Fa extends Cf{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new wt.exports.EventEmitter,this.name=qo,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Re.generateChildLogger(t.logger,this.name):an(Re.getDefaultLoggerOptions({level:t.logger||Vo})),this.messages=new ua(this.logger,t.core),this.subscriber=new Ma(this,this.logger),this.publisher=new S0(this,this.logger),this.relayUrl=t?.relayUrl||Wo,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return Re.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r})}async subscribe(t,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(_t.created,s=>{s.topic===t&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(t,r),i()})]),n}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&await this.provider.disconnect(),this.events.emit(st.transport_closed)}async transportOpen(t){this.relayUrl=t||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(_t.resubscribed,()=>{r()})}),await Promise.race([this.provider.connect(),new Promise((r,n)=>this.once(st.transport_closed,()=>{n()}))])])}catch(r){const n=r;if(!/socket hang up/i.test(n.message))throw new Error(n.message);this.logger.error(n),this.events.emit(st.transport_closed)}}async restartTransport(t){await this.transportClose(),await new Promise(r=>setTimeout(r,ai)),await this.transportOpen(t)}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);return new d0(new D0(n_({sdkVersion:Xo,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t})))}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Ea(t)){if(!t.method.endsWith(Yo))return;const r=t.params,{topic:n,message:i}=r.data,s={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(N0({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(t),await this.onMessageEvent(s)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(st.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=pa(t.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(mr.payload,t=>this.onProviderPayload(t)),this.provider.on(mr.connect,()=>{this.events.emit(st.connect)}),this.provider.on(mr.disconnect,()=>{this.events.emit(st.disconnect),this.attemptToReconnect()}),this.provider.on(mr.error,t=>this.events.emit(st.error,t)),this.events.on(st.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},De.toMiliseconds(ai))}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}}var gi={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,c="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",l="[object Boolean]",w="[object Date]",b="[object Error]",v="[object Function]",T="[object GeneratorFunction]",U="[object Map]",P="[object Number]",K="[object Null]",S="[object Object]",L="[object Promise]",p="[object Proxy]",E="[object RegExp]",y="[object Set]",a="[object String]",_="[object Symbol]",j="[object Undefined]",F="[object WeakMap]",Y="[object ArrayBuffer]",k="[object DataView]",J="[object Float32Array]",I="[object Float64Array]",R="[object Int8Array]",W="[object Int16Array]",$="[object Int32Array]",C="[object Uint8Array]",N="[object Uint8ClampedArray]",M="[object Uint16Array]",B="[object Uint32Array]",re=/[\\^$.*+?()[\]{}|]/g,z=/^\[object .+?Constructor\]$/,Z=/^(?:0|[1-9]\d*)$/,q={};q[J]=q[I]=q[R]=q[W]=q[$]=q[C]=q[N]=q[M]=q[B]=!0,q[c]=q[h]=q[Y]=q[l]=q[k]=q[w]=q[b]=q[v]=q[U]=q[P]=q[S]=q[E]=q[y]=q[a]=q[F]=!1;var oe=typeof Ze=="object"&&Ze&&Ze.Object===Object&&Ze,x=typeof self=="object"&&self&&self.Object===Object&&self,O=oe||x||Function("return this")(),m=t&&!t.nodeType&&t,u=m&&!0&&e&&!e.nodeType&&e,g=u&&u.exports===m,H=g&&oe.process,G=function(){try{return H&&H.binding&&H.binding("util")}catch{}}(),fe=G&&G.isTypedArray;function pe(d,D){for(var A=-1,V=d==null?0:d.length,Ie=0,ne=[];++A<V;){var Me=d[A];D(Me,A,d)&&(ne[Ie++]=Me)}return ne}function le(d,D){for(var A=-1,V=D.length,Ie=d.length;++A<V;)d[Ie+A]=D[A];return d}function be(d,D){for(var A=-1,V=d==null?0:d.length;++A<V;)if(D(d[A],A,d))return!0;return!1}function je(d,D){for(var A=-1,V=Array(d);++A<d;)V[A]=D(A);return V}function Pe(d){return function(D){return d(D)}}function ge(d,D){return d.has(D)}function de(d,D){return d?.[D]}function he(d){var D=-1,A=Array(d.size);return d.forEach(function(V,Ie){A[++D]=[Ie,V]}),A}function ue(d,D){return function(A){return d(D(A))}}function ae(d){var D=-1,A=Array(d.size);return d.forEach(function(V){A[++D]=V}),A}var se=Array.prototype,ie=Function.prototype,Q=Object.prototype,ce=O["__core-js_shared__"],_e=ie.toString,te=Q.hasOwnProperty,ye=function(){var d=/[^.]+$/.exec(ce&&ce.keys&&ce.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),ve=Q.toString,we=RegExp("^"+_e.call(te).replace(re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),me=g?O.Buffer:void 0,Ee=O.Symbol,pt=O.Uint8Array,Et=Q.propertyIsEnumerable,Lt=se.splice,ct=Ee?Ee.toStringTag:void 0,Ft=Object.getOwnPropertySymbols,Or=me?me.isBuffer:void 0,Qr=ue(Object.keys,Object),$e=er(O,"DataView"),Ne=er(O,"Map"),Fe=er(O,"Promise"),Be=er(O,"Set"),ze=er(O,"WeakMap"),Ue=er(Object,"create"),Ge=zt($e),Ve=zt(Ne),We=zt(Fe),qe=zt(Be),Ye=zt(ze),Ke=Ee?Ee.prototype:void 0,He=Ke?Ke.valueOf:void 0;function Ae(d){var D=-1,A=d==null?0:d.length;for(this.clear();++D<A;){var V=d[D];this.set(V[0],V[1])}}function Xe(){this.__data__=Ue?Ue(null):{},this.size=0}function ke(d){var D=this.has(d)&&delete this.__data__[d];return this.size-=D?1:0,D}function K0(d){var D=this.__data__;if(Ue){var A=D[d];return A===n?void 0:A}return te.call(D,d)?D[d]:void 0}function G0(d){var D=this.__data__;return Ue?D[d]!==void 0:te.call(D,d)}function V0(d,D){var A=this.__data__;return this.size+=this.has(d)?0:1,A[d]=Ue&&D===void 0?n:D,this}Ae.prototype.clear=Xe,Ae.prototype.delete=ke,Ae.prototype.get=K0,Ae.prototype.has=G0,Ae.prototype.set=V0;function Ot(d){var D=-1,A=d==null?0:d.length;for(this.clear();++D<A;){var V=d[D];this.set(V[0],V[1])}}function W0(){this.__data__=[],this.size=0}function q0(d){var D=this.__data__,A=tn(D,d);if(A<0)return!1;var V=D.length-1;return A==V?D.pop():Lt.call(D,A,1),--this.size,!0}function Y0(d){var D=this.__data__,A=tn(D,d);return A<0?void 0:D[A][1]}function X0(d){return tn(this.__data__,d)>-1}function k0(d,D){var A=this.__data__,V=tn(A,d);return V<0?(++this.size,A.push([d,D])):A[V][1]=D,this}Ot.prototype.clear=W0,Ot.prototype.delete=q0,Ot.prototype.get=Y0,Ot.prototype.has=X0,Ot.prototype.set=k0;function Bt(d){var D=-1,A=d==null?0:d.length;for(this.clear();++D<A;){var V=d[D];this.set(V[0],V[1])}}function J0(){this.size=0,this.__data__={hash:new Ae,map:new(Ne||Ot),string:new Ae}}function Z0(d){var D=rn(this,d).delete(d);return this.size-=D?1:0,D}function Q0(d){return rn(this,d).get(d)}function eg(d){return rn(this,d).has(d)}function tg(d,D){var A=rn(this,d),V=A.size;return A.set(d,D),this.size+=A.size==V?0:1,this}Bt.prototype.clear=J0,Bt.prototype.delete=Z0,Bt.prototype.get=Q0,Bt.prototype.has=eg,Bt.prototype.set=tg;function en(d){var D=-1,A=d==null?0:d.length;for(this.__data__=new Bt;++D<A;)this.add(d[D])}function rg(d){return this.__data__.set(d,n),this}function ng(d){return this.__data__.has(d)}en.prototype.add=en.prototype.push=rg,en.prototype.has=ng;function Rt(d){var D=this.__data__=new Ot(d);this.size=D.size}function ig(){this.__data__=new Ot,this.size=0}function sg(d){var D=this.__data__,A=D.delete(d);return this.size=D.size,A}function og(d){return this.__data__.get(d)}function ag(d){return this.__data__.has(d)}function ug(d,D){var A=this.__data__;if(A instanceof Ot){var V=A.__data__;if(!Ne||V.length<r-1)return V.push([d,D]),this.size=++A.size,this;A=this.__data__=new Bt(V)}return A.set(d,D),this.size=A.size,this}Rt.prototype.clear=ig,Rt.prototype.delete=sg,Rt.prototype.get=og,Rt.prototype.has=ag,Rt.prototype.set=ug;function cg(d,D){var A=nn(d),V=!A&&Sg(d),Ie=!A&&!V&&pi(d),ne=!A&&!V&&!Ie&&iu(d),Me=A||V||Ie||ne,Je=Me?je(d.length,String):[],et=Je.length;for(var Ce in d)(D||te.call(d,Ce))&&!(Me&&(Ce=="length"||Ie&&(Ce=="offset"||Ce=="parent")||ne&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||bg(Ce,et)))&&Je.push(Ce);return Je}function tn(d,D){for(var A=d.length;A--;)if(eu(d[A][0],D))return A;return-1}function fg(d,D,A){var V=D(d);return nn(d)?V:le(V,A(d))}function xr(d){return d==null?d===void 0?j:K:ct&&ct in Object(d)?yg(d):Dg(d)}function ka(d){return Tr(d)&&xr(d)==c}function Ja(d,D,A,V,Ie){return d===D?!0:d==null||D==null||!Tr(d)&&!Tr(D)?d!==d&&D!==D:hg(d,D,A,V,Ja,Ie)}function hg(d,D,A,V,Ie,ne){var Me=nn(d),Je=nn(D),et=Me?h:It(d),Ce=Je?h:It(D);et=et==c?S:et,Ce=Ce==c?S:Ce;var ft=et==S,yt=Ce==S,rt=et==Ce;if(rt&&pi(d)){if(!pi(D))return!1;Me=!0,ft=!1}if(rt&&!ft)return ne||(ne=new Rt),Me||iu(d)?Za(d,D,A,V,Ie,ne):gg(d,D,et,A,V,Ie,ne);if(!(A&i)){var lt=ft&&te.call(d,"__wrapped__"),dt=yt&&te.call(D,"__wrapped__");if(lt||dt){var At=lt?d.value():d,xt=dt?D.value():D;return ne||(ne=new Rt),Ie(At,xt,A,V,ne)}}return rt?(ne||(ne=new Rt),pg(d,D,A,V,Ie,ne)):!1}function lg(d){if(!nu(d)||wg(d))return!1;var D=tu(d)?we:z;return D.test(zt(d))}function dg(d){return Tr(d)&&ru(d.length)&&!!q[xr(d)]}function _g(d){if(!mg(d))return Qr(d);var D=[];for(var A in Object(d))te.call(d,A)&&A!="constructor"&&D.push(A);return D}function Za(d,D,A,V,Ie,ne){var Me=A&i,Je=d.length,et=D.length;if(Je!=et&&!(Me&&et>Je))return!1;var Ce=ne.get(d);if(Ce&&ne.get(D))return Ce==D;var ft=-1,yt=!0,rt=A&s?new en:void 0;for(ne.set(d,D),ne.set(D,d);++ft<Je;){var lt=d[ft],dt=D[ft];if(V)var At=Me?V(dt,lt,ft,D,d,ne):V(lt,dt,ft,d,D,ne);if(At!==void 0){if(At)continue;yt=!1;break}if(rt){if(!be(D,function(xt,Ht){if(!ge(rt,Ht)&&(lt===xt||Ie(lt,xt,A,V,ne)))return rt.push(Ht)})){yt=!1;break}}else if(!(lt===dt||Ie(lt,dt,A,V,ne))){yt=!1;break}}return ne.delete(d),ne.delete(D),yt}function gg(d,D,A,V,Ie,ne,Me){switch(A){case k:if(d.byteLength!=D.byteLength||d.byteOffset!=D.byteOffset)return!1;d=d.buffer,D=D.buffer;case Y:return!(d.byteLength!=D.byteLength||!ne(new pt(d),new pt(D)));case l:case w:case P:return eu(+d,+D);case b:return d.name==D.name&&d.message==D.message;case E:case a:return d==D+"";case U:var Je=he;case y:var et=V&i;if(Je||(Je=ae),d.size!=D.size&&!et)return!1;var Ce=Me.get(d);if(Ce)return Ce==D;V|=s,Me.set(d,D);var ft=Za(Je(d),Je(D),V,Ie,ne,Me);return Me.delete(d),ft;case _:if(He)return He.call(d)==He.call(D)}return!1}function pg(d,D,A,V,Ie,ne){var Me=A&i,Je=Qa(d),et=Je.length,Ce=Qa(D),ft=Ce.length;if(et!=ft&&!Me)return!1;for(var yt=et;yt--;){var rt=Je[yt];if(!(Me?rt in D:te.call(D,rt)))return!1}var lt=ne.get(d);if(lt&&ne.get(D))return lt==D;var dt=!0;ne.set(d,D),ne.set(D,d);for(var At=Me;++yt<et;){rt=Je[yt];var xt=d[rt],Ht=D[rt];if(V)var su=Me?V(Ht,xt,rt,D,d,ne):V(xt,Ht,rt,d,D,ne);if(!(su===void 0?xt===Ht||Ie(xt,Ht,A,V,ne):su)){dt=!1;break}At||(At=rt=="constructor")}if(dt&&!At){var sn=d.constructor,on=D.constructor;sn!=on&&"constructor"in d&&"constructor"in D&&!(typeof sn=="function"&&sn instanceof sn&&typeof on=="function"&&on instanceof on)&&(dt=!1)}return ne.delete(d),ne.delete(D),dt}function Qa(d){return fg(d,Tg,vg)}function rn(d,D){var A=d.__data__;return Eg(D)?A[typeof D=="string"?"string":"hash"]:A.map}function er(d,D){var A=de(d,D);return lg(A)?A:void 0}function yg(d){var D=te.call(d,ct),A=d[ct];try{d[ct]=void 0;var V=!0}catch{}var Ie=ve.call(d);return V&&(D?d[ct]=A:delete d[ct]),Ie}var vg=Ft?function(d){return d==null?[]:(d=Object(d),pe(Ft(d),function(D){return Et.call(d,D)}))}:Lg,It=xr;($e&&It(new $e(new ArrayBuffer(1)))!=k||Ne&&It(new Ne)!=U||Fe&&It(Fe.resolve())!=L||Be&&It(new Be)!=y||ze&&It(new ze)!=F)&&(It=function(d){var D=xr(d),A=D==S?d.constructor:void 0,V=A?zt(A):"";if(V)switch(V){case Ge:return k;case Ve:return U;case We:return L;case qe:return y;case Ye:return F}return D});function bg(d,D){return D=D??o,!!D&&(typeof d=="number"||Z.test(d))&&d>-1&&d%1==0&&d<D}function Eg(d){var D=typeof d;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?d!=="__proto__":d===null}function wg(d){return!!ye&&ye in d}function mg(d){var D=d&&d.constructor,A=typeof D=="function"&&D.prototype||Q;return d===A}function Dg(d){return ve.call(d)}function zt(d){if(d!=null){try{return _e.call(d)}catch{}try{return d+""}catch{}}return""}function eu(d,D){return d===D||d!==d&&D!==D}var Sg=ka(function(){return arguments}())?ka:function(d){return Tr(d)&&te.call(d,"callee")&&!Et.call(d,"callee")},nn=Array.isArray;function Og(d){return d!=null&&ru(d.length)&&!tu(d)}var pi=Or||Rg;function xg(d,D){return Ja(d,D)}function tu(d){if(!nu(d))return!1;var D=xr(d);return D==v||D==T||D==f||D==p}function ru(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=o}function nu(d){var D=typeof d;return d!=null&&(D=="object"||D=="function")}function Tr(d){return d!=null&&typeof d=="object"}var iu=fe?Pe(fe):dg;function Tg(d){return Og(d)?cg(d):_g(d)}function Lg(){return[]}function Rg(){return!1}e.exports=xg})(gi,gi.exports);var U0=gi.exports,M0=Object.defineProperty,Ba=Object.getOwnPropertySymbols,j0=Object.prototype.hasOwnProperty,$0=Object.prototype.propertyIsEnumerable,za=(e,t,r)=>t in e?M0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ha=(e,t)=>{for(var r in t||(t={}))j0.call(t,r)&&za(e,r,t[r]);if(Ba)for(var r of Ba(t))$0.call(t,r)&&za(e,r,t[r]);return e};class Ka extends Pf{constructor(t,r,n,i=mt,s=void 0){super(t,r,n,i),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=ko,this.cached=[],this.initialized=!1,this.storagePrefix=mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{E_(o)?this.map.set(o.id,o):w_(o)?this.map.set(o.topic,o):this.getKey&&o!==null&&!Wr(o)&&this.map.set(this.getKey(o),o)}),this.cached=[],this.initialized=!0)},this.set=async(o,c)=>{this.isInitialized(),this.map.has(o)?await this.update(o,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:c}),this.map.set(o,c),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(c=>Object.keys(o).every(h=>U0(c[h],o[h]))):this.values),this.update=async(o,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:c});const h=Ha(Ha({},this.getData(o)),c);this.map.set(o,h),await this.persist()},this.delete=async(o,c)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:c}),this.map.delete(o),await this.persist())},this.logger=Re.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=Le("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=Le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Ga{constructor(t,r){this.core=t,this.logger=r,this.name=ea,this.version=ta,this.events=new wt.exports,this.initialized=!1,this.storagePrefix=mt,this.ignoredPayloadTypes=[Jt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Jn(),i=await this.core.crypto.setSymKey(n),s=ei(De.FIVE_MINUTES),o={protocol:Go},c={topic:i,expiry:s,relay:o,active:!1},h=p_({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:o});return await this.pairings.set(i,c),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:o}=__(n.uri),c=ei(De.FIVE_MINUTES),h={topic:i,relay:o,expiry:c,active:!1};return await this.pairings.set(i,h),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:o}),this.core.expirer.set(i,c),n.activatePairing&&await this.activate({topic:i}),h},this.activate=async({topic:n})=>{this.isInitialized();const i=ei(De.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:c,reject:h}=i_();this.events.once(ti("pairing_ping",s),({error:f})=>{f?h(f):c()}),await o()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",wr("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const o=li(i,s),c=await this.core.crypto.encode(n,o),h=Zt[i].req;return this.core.history.set(n,o),await this.core.relayer.publish(n,c,h),o.id},this.sendResult=async(n,i,s)=>{const o=pa(n,s),c=await this.core.crypto.encode(i,o),h=await this.core.history.get(i,n),f=Zt[h.request.method].res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(o)},this.sendError=async(n,i,s)=>{const o=ya(n,s),c=await this.core.crypto.encode(i,o),h=await this.core.history.get(i,n),f=Zt[h.request.method]?Zt[h.request.method].res:Zt.unregistered_method.res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(o)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,wr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>To(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,o=s.method;if(this.pairings.keys.includes(i))switch(o){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{ma(i)?this.events.emit(ti("pairing_ping",s),{}):Yr(i)&&this.events.emit(ti("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.sendResult(s,n,!0),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const c=wr("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,c),this.logger.error(c)}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(wr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ii(n)){const{message:i}=Le("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!b_(n.uri)){const{message:i}=Le("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!ii(n)){const{message:s}=Le("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!ii(n)){const{message:s}=Le("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!Co(n,!1)){const{message:i}=Le("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=Le("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(To(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=Le("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=t,this.logger=Re.generateChildLogger(r,this.name),this.pairings=new Ka(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Re.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(st.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Ea(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):wa(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(ht.expired,async t=>{const{topic:r}=a_(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Va extends Rf{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new wt.exports.EventEmitter,this.name=ra,this.version=na,this.cached=[],this.initialized=!1,this.storagePrefix=mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(o.id,o),this.events.emit(gt.created,o)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=Yr(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(gt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(gt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:li(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=Le("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(gt.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=Le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(gt.created,t=>{const r=gt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(gt.updated,t=>{const r=gt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(gt.deleted,t=>{const r=gt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Wa extends Uf{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new wt.exports.EventEmitter,this.name=ia,this.version=sa,this.cached=[],this.initialized=!1,this.storagePrefix=mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(ht.created,{target:s,expiration:o})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(ht.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=Re.generateChildLogger(r,this.name)}get context(){return Re.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return s_(t);if(typeof t=="number")return o_(t);const{message:r}=Le("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(ht.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=Le("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=Le("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;De.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(ht.expired,{target:t,expiration:r})}checkExpirations(){this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(ur.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(ht.created,t=>{const r=ht.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(ht.expired,t=>{const r=ht.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(ht.deleted,t=>{const r=ht.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Le("NOT_INITIALIZED",this.name);throw new Error(t)}}}var F0=Object.defineProperty,qa=Object.getOwnPropertySymbols,B0=Object.prototype.hasOwnProperty,z0=Object.prototype.propertyIsEnumerable,Ya=(e,t,r)=>t in e?F0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Xa=(e,t)=>{for(var r in t||(t={}))B0.call(t,r)&&Ya(e,r,t[r]);if(qa)for(var r of qa(t))z0.call(t,r)&&Ya(e,r,t[r]);return e};class Zr extends Lf{constructor(t){super(t),this.protocol=si,this.version=Po,this.name=qr,this.events=new wt.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=t?.projectId;const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:an(Re.getDefaultLoggerOptions({level:t?.logger||No.logger}));this.logger=Re.generateChildLogger(r,this.name),this.heartbeat=new ur.HeartBeat,this.crypto=new aa(this,this.logger,t?.keychain),this.history=new Va(this,this.logger),this.expirer=new Wa(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Qu(Xa(Xa({},Uo),t?.storageOptions)),this.relayer=new Fa({core:this,logger:this.logger,relayUrl:t?.relayUrl,projectId:this.projectId}),this.pairing=new Ga(this,this.logger)}static async init(t){const r=new Zr(t);return await r.initialize(),r}get context(){return Re.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const H0=Zr;X.CORE_CONTEXT=qr,X.CORE_DEFAULT=No,X.CORE_PROTOCOL=si,X.CORE_STORAGE_OPTIONS=Uo,X.CORE_STORAGE_PREFIX=mt,X.CORE_VERSION=Po,X.CRYPTO_CLIENT_SEED=oi,X.CRYPTO_CONTEXT=Mo,X.CRYPTO_JWT_TTL=jo,X.Core=H0,X.Crypto=aa,X.EXPIRER_CONTEXT=ia,X.EXPIRER_DEFAULT_TTL=O_,X.EXPIRER_EVENTS=ht,X.EXPIRER_STORAGE_VERSION=sa,X.Expirer=Wa,X.HISTORY_CONTEXT=ra,X.HISTORY_EVENTS=gt,X.HISTORY_STORAGE_VERSION=na,X.JsonRpcHistory=Va,X.KEYCHAIN_CONTEXT=$o,X.KEYCHAIN_STORAGE_VERSION=Fo,X.KeyChain=oa,X.MESSAGES_CONTEXT=Bo,X.MESSAGES_STORAGE_VERSION=zo,X.MessageTracker=ua,X.PAIRING_CONTEXT=ea,X.PAIRING_DEFAULT_TTL=S_,X.PAIRING_RPC_OPTS=Zt,X.PAIRING_STORAGE_VERSION=ta,X.PENDING_SUB_RESOLUTION_TIMEOUT=Qo,X.PUBLISHER_CONTEXT=Ko,X.PUBLISHER_DEFAULT_TTL=Ho,X.Pairing=Ga,X.RELAYER_CONTEXT=qo,X.RELAYER_DEFAULT_LOGGER=Vo,X.RELAYER_DEFAULT_PROTOCOL=Go,X.RELAYER_DEFAULT_RELAY_URL=Wo,X.RELAYER_EVENTS=st,X.RELAYER_PROVIDER_EVENTS=mr,X.RELAYER_RECONNECT_TIMEOUT=ai,X.RELAYER_SDK_VERSION=Xo,X.RELAYER_STORAGE_OPTIONS=m_,X.RELAYER_SUBSCRIBER_SUFFIX=Yo,X.Relayer=Fa,X.STORE_STORAGE_VERSION=ko,X.SUBSCRIBER_CONTEXT=Jo,X.SUBSCRIBER_DEFAULT_TTL=D_,X.SUBSCRIBER_EVENTS=_t,X.SUBSCRIBER_STORAGE_VERSION=Zo,X.Store=Ka,X.Subscriber=Ma,X.default=Zr,Object.defineProperty(X,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
