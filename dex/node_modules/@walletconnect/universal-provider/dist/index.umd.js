(function(Yt,We){typeof exports=="object"&&typeof module<"u"?We(exports):typeof define=="function"&&define.amd?define(["exports"],We):(Yt=typeof globalThis<"u"?globalThis:Yt||self,We(Yt["@walletconnect/universal-provider"]={}))})(this,function(Yt){"use strict";var We=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Du(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Jt(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),r}function xu(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Su=Ou;function Ou(t,e,r){var n=r&&r.stringify||xu,i=1;if(typeof t=="object"&&t!==null){var s=e.length+i;if(s===1)return t;var o=new Array(s);o[0]=n(t);for(var a=1;a<s;a++)o[a]=n(e[a]);return o.join(" ")}if(typeof t!="string")return t;var f=e.length;if(f===0)return t;for(var h="",l=1-i,D=-1,v=t&&t.length||0,m=0;m<v;){if(t.charCodeAt(m)===37&&m+1<v){switch(D=D>-1?D:0,t.charCodeAt(m+1)){case 100:case 102:if(l>=f||e[l]==null)break;D<m&&(h+=t.slice(D,m)),h+=Number(e[l]),D=m+2,m++;break;case 105:if(l>=f||e[l]==null)break;D<m&&(h+=t.slice(D,m)),h+=Math.floor(Number(e[l])),D=m+2,m++;break;case 79:case 111:case 106:if(l>=f||e[l]===void 0)break;D<m&&(h+=t.slice(D,m));var w=typeof e[l];if(w==="string"){h+="'"+e[l]+"'",D=m+2,m++;break}if(w==="function"){h+=e[l].name||"<anonymous>",D=m+2,m++;break}h+=n(e[l]),D=m+2,m++;break;case 115:if(l>=f)break;D<m&&(h+=t.slice(D,m)),h+=String(e[l]),D=m+2,m++;break;case 37:D<m&&(h+=t.slice(D,m)),h+="%",D=m+2,m++,l--;break}++l}++m}return D===-1?t:(D<v&&(h+=t.slice(D)),h)}const fs=Su;var Er=It;const Dr=Fu().console||{},Iu={mapHttpRequest:en,mapHttpResponse:en,wrapRequestSerializer:Kn,wrapResponseSerializer:Kn,wrapErrorSerializer:Kn,req:en,res:en,err:Ru};function Lu(t,e){return Array.isArray(t)?t.filter(function(n){return n!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function It(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||Dr;t.browser.write&&(t.browser.asObject=!0);const n=t.serializers||{},i=Lu(t.browser.serialize,n);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const a=t.level||"info",f=Object.create(r);f.log||(f.log=xr),Object.defineProperty(f,"levelVal",{get:l}),Object.defineProperty(f,"level",{get:D,set:v});const h={transmit:e,serialize:i,asObject:t.browser.asObject,levels:o,timestamp:Cu(t)};f.levels=It.levels,f.level=a,f.setMaxListeners=f.getMaxListeners=f.emit=f.addListener=f.on=f.prependListener=f.once=f.prependOnceListener=f.removeListener=f.removeAllListeners=f.listeners=f.listenerCount=f.eventNames=f.write=f.flush=xr,f.serializers=n,f._serialize=i,f._stdErrSerialize=s,f.child=m,e&&(f._logEvent=qn());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function D(){return this._level}function v(w){if(w!=="silent"&&!this.levels.values[w])throw Error("unknown level "+w);this._level=w,ur(h,f,"error","log"),ur(h,f,"fatal","error"),ur(h,f,"warn","error"),ur(h,f,"info","log"),ur(h,f,"debug","log"),ur(h,f,"trace","log")}function m(w,N){if(!w)throw new Error("missing bindings for child Pino");N=N||{},i&&w.serializers&&(N.serializers=w.serializers);const R=N.serializers;if(i&&R){var B=Object.assign({},n,R),S=t.browser.serialize===!0?Object.keys(B):i;delete w.serializers,Qr([w],S,B,this._stdErrSerialize)}function L(y){this._childLevel=(y._childLevel|0)+1,this.error=fr(y,w,"error"),this.fatal=fr(y,w,"fatal"),this.warn=fr(y,w,"warn"),this.info=fr(y,w,"info"),this.debug=fr(y,w,"debug"),this.trace=fr(y,w,"trace"),B&&(this.serializers=B,this._serialize=S),e&&(this._logEvent=qn([].concat(y._logEvent.bindings,w)))}return L.prototype=this,new L(this)}return f}It.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},It.stdSerializers=Iu,It.stdTimeFunctions=Object.assign({},{nullTime:hs,epochTime:ls,unixTime:Nu,isoTime:$u});function ur(t,e,r,n){const i=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?xr:i[r]?i[r]:Dr[r]||Dr[n]||xr,Au(t,e,r)}function Au(t,e,r){!t.transmit&&e[r]===xr||(e[r]=function(n){return function(){const s=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Dr?Dr:this;for(var f=0;f<o.length;f++)o[f]=arguments[f];if(t.serialize&&!t.asObject&&Qr(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?n.call(a,Pu(this,r,o,s)):n.apply(a,o),t.transmit){const h=t.transmit.level||e.level,l=It.levels.values[h],D=It.levels.values[r];if(D<l)return;Tu(this,{ts:s,methodLevel:r,methodValue:D,transmitLevel:h,transmitValue:It.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[r]))}function Pu(t,e,r,n){t._serialize&&Qr(r,t._serialize,t.serializers,t._stdErrSerialize);const i=r.slice();let s=i[0];const o={};n&&(o.time=n),o.level=It.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),s!==null&&typeof s=="object"){for(;a--&&typeof i[0]=="object";)Object.assign(o,i.shift());s=i.length?fs(i.shift(),i):void 0}else typeof s=="string"&&(s=fs(i.shift(),i));return s!==void 0&&(o.msg=s),o}function Qr(t,e,r,n){for(const i in t)if(n&&t[i]instanceof Error)t[i]=It.stdSerializers.err(t[i]);else if(typeof t[i]=="object"&&!Array.isArray(t[i]))for(const s in t[i])e&&e.indexOf(s)>-1&&s in r&&(t[i][s]=r[s](t[i][s]))}function fr(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function Tu(t,e,r){const n=e.send,i=e.ts,s=e.methodLevel,o=e.methodValue,a=e.val,f=t._logEvent.bindings;Qr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter(function(h){return f.indexOf(h)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=o,n(s,t._logEvent,a),t._logEvent=qn(f)}function qn(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Ru(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Cu(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?hs:ls}function en(){return{}}function Kn(t){return t}function xr(){}function hs(){return!1}function ls(){return Date.now()}function Nu(){return Math.round(Date.now()/1e3)}function $u(){return new Date(Date.now()).toISOString()}function Fu(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var Nt={exports:{}},hr=typeof Reflect=="object"?Reflect:null,ds=hr&&typeof hr.apply=="function"?hr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},tn;hr&&typeof hr.ownKeys=="function"?tn=hr.ownKeys:Object.getOwnPropertySymbols?tn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:tn=function(e){return Object.getOwnPropertyNames(e)};function Uu(t){console&&console.warn&&console.warn(t)}var ps=Number.isNaN||function(e){return e!==e};function Se(){Se.init.call(this)}Nt.exports=Se,Nt.exports.once=zu,Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var gs=10;function rn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return gs},set:function(t){if(typeof t!="number"||t<0||ps(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");gs=t}}),Se.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ps(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ys(t){return t._maxListeners===void 0?Se.defaultMaxListeners:t._maxListeners}Se.prototype.getMaxListeners=function(){return ys(this)},Se.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")ds(f,this,r);else for(var h=f.length,l=ws(f,h),n=0;n<h;++n)ds(l[n],this,r);return!0};function vs(t,e,r,n){var i,s,o;if(rn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=ys(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Uu(a)}return t}Se.prototype.addListener=function(e,r){return vs(this,e,r,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(e,r){return vs(this,e,r,!0)};function Mu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _s(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Mu.bind(n);return i.listener=r,n.wrapFn=i,i}Se.prototype.once=function(e,r){return rn(r),this.on(e,_s(this,e,r)),this},Se.prototype.prependOnceListener=function(e,r){return rn(r),this.prependListener(e,_s(this,e,r)),this},Se.prototype.removeListener=function(e,r){var n,i,s,o,a;if(rn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():ju(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function bs(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Bu(i):ws(i,i.length)}Se.prototype.listeners=function(e){return bs(this,e,!0)},Se.prototype.rawListeners=function(e){return bs(this,e,!1)},Se.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):ms.call(t,e)},Se.prototype.listenerCount=ms;function ms(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?tn(this._events):[]};function ws(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function ju(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Bu(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function zu(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Es(t,e,s,{once:!0}),e!=="error"&&Hu(t,i,{once:!0})})}function Hu(t,e,r){typeof t.on=="function"&&Es(t,"error",e,r)}function Es(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var nn={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Vn=function(t,e){return Vn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Vn(t,e)};function qu(t,e){Vn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Gn=function(){return Gn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Gn.apply(this,arguments)};function Ku(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Vu(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Gu(t,e){return function(r,n){e(r,n,t)}}function Wu(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function ku(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(D){o(D)}}function f(l){try{h(n.throw(l))}catch(D){o(D)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function Yu(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Ju(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Xu(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Wn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ds(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Zu(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ds(arguments[e]));return t}function Qu(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Sr(t){return this instanceof Sr?(this.v=t,this):new Sr(t)}function ef(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(v){n[v]&&(i[v]=function(m){return new Promise(function(w,N){s.push([v,m,w,N])>1||a(v,m)})})}function a(v,m){try{f(n[v](m))}catch(w){D(s[0][3],w)}}function f(v){v.value instanceof Sr?Promise.resolve(v.value.v).then(h,l):D(s[0][2],v)}function h(v){a("next",v)}function l(v){a("throw",v)}function D(v,m){v(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}function tf(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Sr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function rf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Wn=="function"?Wn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function nf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function sf(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function of(t){return t&&t.__esModule?t:{default:t}}function af(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function cf(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var uf=Object.freeze({__proto__:null,__extends:qu,get __assign(){return Gn},__rest:Ku,__decorate:Vu,__param:Gu,__metadata:Wu,__awaiter:ku,__generator:Yu,__createBinding:Ju,__exportStar:Xu,__values:Wn,__read:Ds,__spread:Zu,__spreadArrays:Qu,__await:Sr,__asyncGenerator:ef,__asyncDelegator:tf,__asyncValues:rf,__makeTemplateObject:nf,__importStar:sf,__importDefault:of,__classPrivateFieldGet:af,__classPrivateFieldSet:cf}),xs=Jt(uf),Or={};Object.defineProperty(Or,"__esModule",{value:!0});function ff(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}Or.safeJsonParse=ff;function hf(t){return typeof t=="string"?t:JSON.stringify(t,(e,r)=>typeof r>"u"?null:r)}Or.safeJsonStringify=hf;var Ir={exports:{}},Ss;function lf(){return Ss||(Ss=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof We<"u"&&We.localStorage?Ir.exports=We.localStorage:typeof window<"u"&&window.localStorage?Ir.exports=window.localStorage:Ir.exports=new e}()),Ir.exports}var kn={},Lr={},Os;function df(){if(Os)return Lr;Os=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.IKeyValueStorage=void 0;class t{}return Lr.IKeyValueStorage=t,Lr}var Ar={},Is;function pf(){if(Is)return Ar;Is=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.parseEntry=void 0;const t=Or;function e(r){var n;return[r[0],t.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return Ar.parseEntry=e,Ar}var Ls;function gf(){return Ls||(Ls=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=xs;e.__exportStar(df(),t),e.__exportStar(pf(),t)}(kn)),kn}Object.defineProperty(nn,"__esModule",{value:!0}),nn.KeyValueStorage=void 0;const lr=xs,As=Or,yf=lr.__importDefault(lf()),vf=gf();class Ps{constructor(){this.localStorage=yf.default}getKeys(){return lr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return lr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(vf.parseEntry)})}getItem(e){return lr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return As.safeJsonParse(r)})}setItem(e,r){return lr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,As.safeJsonStringify(r))})}removeItem(e){return lr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}nn.KeyValueStorage=Ps;var _f=nn.default=Ps,Pr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Yn=function(t,e){return Yn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Yn(t,e)};function bf(t,e){Yn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Jn=function(){return Jn=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Jn.apply(this,arguments)};function mf(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function wf(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Ef(t,e){return function(r,n){e(r,n,t)}}function Df(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function xf(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(D){o(D)}}function f(l){try{h(n.throw(l))}catch(D){o(D)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function Sf(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Of(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function If(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Xn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ts(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Lf(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ts(arguments[e]));return t}function Af(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Tr(t){return this instanceof Tr?(this.v=t,this):new Tr(t)}function Pf(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(v){n[v]&&(i[v]=function(m){return new Promise(function(w,N){s.push([v,m,w,N])>1||a(v,m)})})}function a(v,m){try{f(n[v](m))}catch(w){D(s[0][3],w)}}function f(v){v.value instanceof Tr?Promise.resolve(v.value.v).then(h,l):D(s[0][2],v)}function h(v){a("next",v)}function l(v){a("throw",v)}function D(v,m){v(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Tf(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Tr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Rf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Xn=="function"?Xn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function Cf(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Nf(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function $f(t){return t&&t.__esModule?t:{default:t}}function Ff(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Uf(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Mf=Object.freeze({__proto__:null,__extends:bf,get __assign(){return Jn},__rest:mf,__decorate:wf,__param:Ef,__metadata:Df,__awaiter:xf,__generator:Sf,__createBinding:Of,__exportStar:If,__values:Xn,__read:Ts,__spread:Lf,__spreadArrays:Af,__await:Tr,__asyncGenerator:Pf,__asyncDelegator:Tf,__asyncValues:Rf,__makeTemplateObject:Cf,__importStar:Nf,__importDefault:$f,__classPrivateFieldGet:Ff,__classPrivateFieldSet:Uf}),sn=Jt(Mf),Rr={};function ke(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var Zn=ke;ke.EventEmitter=ke,ke.prototype._events=void 0,ke.prototype._maxListeners=void 0,ke.defaultMaxListeners=10,ke.prototype.setMaxListeners=function(t){if(!jf(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},ke.prototype.emit=function(t){var e,r,n,i,s,o;if(this._events||(this._events={}),t==="error"&&(!this._events.error||Cr(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var a=new Error('Uncaught, unspecified "error" event. ('+e+")");throw a.context=e,a}if(r=this._events[t],Rs(r))return!1;if($t(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),r.apply(this,i)}else if(Cr(r))for(i=Array.prototype.slice.call(arguments,1),o=r.slice(),n=o.length,s=0;s<n;s++)o[s].apply(this,i);return!0},ke.prototype.addListener=function(t,e){var r;if(!$t(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,$t(e.listener)?e.listener:e),this._events[t]?Cr(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,Cr(this._events[t])&&!this._events[t].warned&&(Rs(this._maxListeners)?r=ke.defaultMaxListeners:r=this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),typeof console.trace=="function"&&console.trace())),this},ke.prototype.on=ke.prototype.addListener,ke.prototype.once=function(t,e){if(!$t(e))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}return n.listener=e,this.on(t,n),this},ke.prototype.removeListener=function(t,e){var r,n,i,s;if(!$t(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],i=r.length,n=-1,r===e||$t(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(Cr(r)){for(s=i;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){n=s;break}if(n<0)return this;r.length===1?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},ke.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[t]&&delete this._events[t],this;if(arguments.length===0){for(e in this._events)e!=="removeListener"&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],$t(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},ke.prototype.listeners=function(t){var e;return!this._events||!this._events[t]?e=[]:$t(this._events[t])?e=[this._events[t]]:e=this._events[t].slice(),e},ke.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if($t(e))return 1;if(e)return e.length}return 0},ke.listenerCount=function(t,e){return t.listenerCount(e)};function $t(t){return typeof t=="function"}function jf(t){return typeof t=="number"}function Cr(t){return typeof t=="object"&&t!==null}function Rs(t){return t===void 0}var Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Qn=function(t,e){return Qn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Qn(t,e)};function Bf(t,e){Qn(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ei=function(){return ei=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ei.apply(this,arguments)};function zf(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Hf(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function qf(t,e){return function(r,n){e(r,n,t)}}function Kf(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Vf(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(D){o(D)}}function f(l){try{h(n.throw(l))}catch(D){o(D)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function Gf(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Wf(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function kf(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function ti(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Yf(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Cs(arguments[e]));return t}function Jf(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Nr(t){return this instanceof Nr?(this.v=t,this):new Nr(t)}function Xf(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(v){n[v]&&(i[v]=function(m){return new Promise(function(w,N){s.push([v,m,w,N])>1||a(v,m)})})}function a(v,m){try{f(n[v](m))}catch(w){D(s[0][3],w)}}function f(v){v.value instanceof Nr?Promise.resolve(v.value.v).then(h,l):D(s[0][2],v)}function h(v){a("next",v)}function l(v){a("throw",v)}function D(v,m){v(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Zf(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Nr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Qf(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof ti=="function"?ti(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function eh(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function th(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function rh(t){return t&&t.__esModule?t:{default:t}}function nh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function ih(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var sh=Object.freeze({__proto__:null,__extends:Bf,get __assign(){return ei},__rest:zf,__decorate:Hf,__param:qf,__metadata:Kf,__awaiter:Vf,__generator:Gf,__createBinding:Wf,__exportStar:kf,__values:ti,__read:Cs,__spread:Yf,__spreadArrays:Jf,__await:Nr,__asyncGenerator:Xf,__asyncDelegator:Zf,__asyncValues:Qf,__makeTemplateObject:eh,__importStar:th,__importDefault:rh,__classPrivateFieldGet:nh,__classPrivateFieldSet:ih}),on=Jt(sh),ri={},$r={},Ns;function oh(){if(Ns)return $r;Ns=1,Object.defineProperty($r,"__esModule",{value:!0}),$r.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return $r.delay=t,$r}var Xt={},ni={},Zt={},$s;function ah(){return $s||($s=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.ONE_THOUSAND=Zt.ONE_HUNDRED=void 0,Zt.ONE_HUNDRED=100,Zt.ONE_THOUSAND=1e3),Zt}var ii={},Fs;function ch(){return Fs||(Fs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(ii)),ii}var Us;function Ms(){return Us||(Us=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=on;e.__exportStar(ah(),t),e.__exportStar(ch(),t)}(ni)),ni}var js;function uh(){if(js)return Xt;js=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.fromMiliseconds=Xt.toMiliseconds=void 0;const t=Ms();function e(n){return n*t.ONE_THOUSAND}Xt.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return Xt.fromMiliseconds=r,Xt}var Bs;function fh(){return Bs||(Bs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=on;e.__exportStar(oh(),t),e.__exportStar(uh(),t)}(ri)),ri}var dr={},zs;function hh(){if(zs)return dr;zs=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return dr.Watch=t,dr.default=t,dr}var si={},Fr={},Hs;function lh(){if(Hs)return Fr;Hs=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.IWatch=void 0;class t{}return Fr.IWatch=t,Fr}var qs;function dh(){return qs||(qs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),on.__exportStar(lh(),t)}(si)),si}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=on;e.__exportStar(fh(),t),e.__exportStar(hh(),t),e.__exportStar(dh(),t),e.__exportStar(Ms(),t)})(Z);var oi={},Ur={};class Qt{}var ph=Object.freeze({__proto__:null,IEvents:Qt}),gh=Jt(ph),Ks;function yh(){if(Ks)return Ur;Ks=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.IHeartBeat=void 0;const t=gh;class e extends t.IEvents{constructor(n){super()}}return Ur.IHeartBeat=e,Ur}var Vs;function Gs(){return Vs||(Vs=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),sn.__exportStar(yh(),t)}(oi)),oi}var ai={},er={},Ws;function vh(){if(Ws)return er;Ws=1,Object.defineProperty(er,"__esModule",{value:!0}),er.HEARTBEAT_EVENTS=er.HEARTBEAT_INTERVAL=void 0;const t=Z;return er.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,er.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},er}var ks;function Ys(){return ks||(ks=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),sn.__exportStar(vh(),t)}(ai)),ai}var Js;function _h(){if(Js)return Rr;Js=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.HeartBeat=void 0;const t=sn,e=Zn,r=Z,n=Gs(),i=Ys();class s extends n.IHeartBeat{constructor(a){super(a),this.events=new e.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=a?.interval||i.HEARTBEAT_INTERVAL}static init(a){return t.__awaiter(this,void 0,void 0,function*(){const f=new s(a);return yield f.init(),f})}init(){return t.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}on(a,f){this.events.on(a,f)}once(a,f){this.events.once(a,f)}off(a,f){this.events.off(a,f)}removeListener(a,f){this.events.removeListener(a,f)}initialize(){return t.__awaiter(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return Rr.HeartBeat=s,Rr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=sn;e.__exportStar(_h(),t),e.__exportStar(Gs(),t),e.__exportStar(Ys(),t)})(Pr);var xe={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var ci=function(t,e){return ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},ci(t,e)};function bh(t,e){ci(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ui=function(){return ui=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ui.apply(this,arguments)};function mh(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function wh(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function Eh(t,e){return function(r,n){e(r,n,t)}}function Dh(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function xh(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(D){o(D)}}function f(l){try{h(n.throw(l))}catch(D){o(D)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function Sh(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function Oh(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Ih(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function fi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xs(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Lh(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Xs(arguments[e]));return t}function Ah(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Mr(t){return this instanceof Mr?(this.v=t,this):new Mr(t)}function Ph(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(v){n[v]&&(i[v]=function(m){return new Promise(function(w,N){s.push([v,m,w,N])>1||a(v,m)})})}function a(v,m){try{f(n[v](m))}catch(w){D(s[0][3],w)}}function f(v){v.value instanceof Mr?Promise.resolve(v.value.v).then(h,l):D(s[0][2],v)}function h(v){a("next",v)}function l(v){a("throw",v)}function D(v,m){v(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Th(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Mr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Rh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof fi=="function"?fi(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function Ch(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Nh(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function $h(t){return t&&t.__esModule?t:{default:t}}function Fh(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Uh(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Mh=Object.freeze({__proto__:null,__extends:bh,get __assign(){return ui},__rest:mh,__decorate:wh,__param:Eh,__metadata:Dh,__awaiter:xh,__generator:Sh,__createBinding:Oh,__exportStar:Ih,__values:fi,__read:Xs,__spread:Lh,__spreadArrays:Ah,__await:Mr,__asyncGenerator:Ph,__asyncDelegator:Th,__asyncValues:Rh,__makeTemplateObject:Ch,__importStar:Nh,__importDefault:$h,__classPrivateFieldGet:Fh,__classPrivateFieldSet:Uh}),jh=Jt(Mh),tr={},Zs;function Qs(){return Zs||(Zs=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.PINO_CUSTOM_CONTEXT_KEY=tr.PINO_LOGGER_DEFAULTS=void 0,tr.PINO_LOGGER_DEFAULTS={level:"info"},tr.PINO_CUSTOM_CONTEXT_KEY="custom_context"),tr}var ut={},eo;function Bh(){if(eo)return ut;eo=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.generateChildLogger=ut.formatChildLoggerContext=ut.getLoggerContext=ut.setBrowserLoggerContext=ut.getBrowserLoggerContext=ut.getDefaultLoggerOptions=void 0;const t=Qs();function e(a){return Object.assign(Object.assign({},a),{level:a?.level||t.PINO_LOGGER_DEFAULTS.level})}ut.getDefaultLoggerOptions=e;function r(a,f=t.PINO_CUSTOM_CONTEXT_KEY){return a[f]||""}ut.getBrowserLoggerContext=r;function n(a,f,h=t.PINO_CUSTOM_CONTEXT_KEY){return a[h]=f,a}ut.setBrowserLoggerContext=n;function i(a,f=t.PINO_CUSTOM_CONTEXT_KEY){let h="";return typeof a.bindings>"u"?h=r(a,f):h=a.bindings().context||"",h}ut.getLoggerContext=i;function s(a,f,h=t.PINO_CUSTOM_CONTEXT_KEY){const l=i(a,h);return l.trim()?`${l}/${f}`:f}ut.formatChildLoggerContext=s;function o(a,f,h=t.PINO_CUSTOM_CONTEXT_KEY){const l=s(a,f,h),D=a.child({context:l});return n(D,l,h)}return ut.generateChildLogger=o,ut}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=jh,r=e.__importDefault(Er);Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(Qs(),t),e.__exportStar(Bh(),t)})(xe);var to={exports:{}},pr=typeof Reflect=="object"?Reflect:null,ro=pr&&typeof pr.apply=="function"?pr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},an;pr&&typeof pr.ownKeys=="function"?an=pr.ownKeys:Object.getOwnPropertySymbols?an=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:an=function(e){return Object.getOwnPropertyNames(e)};function zh(t){console&&console.warn&&console.warn(t)}var no=Number.isNaN||function(e){return e!==e};function Oe(){Oe.init.call(this)}to.exports=Oe,to.exports.once=Vh,Oe.EventEmitter=Oe,Oe.prototype._events=void 0,Oe.prototype._eventsCount=0,Oe.prototype._maxListeners=void 0;var io=10;function cn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Oe,"defaultMaxListeners",{enumerable:!0,get:function(){return io},set:function(t){if(typeof t!="number"||t<0||no(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");io=t}}),Oe.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Oe.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||no(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function so(t){return t._maxListeners===void 0?Oe.defaultMaxListeners:t._maxListeners}Oe.prototype.getMaxListeners=function(){return so(this)},Oe.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")ro(f,this,r);else for(var h=f.length,l=fo(f,h),n=0;n<h;++n)ro(l[n],this,r);return!0};function oo(t,e,r,n){var i,s,o;if(cn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=so(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,zh(a)}return t}Oe.prototype.addListener=function(e,r){return oo(this,e,r,!1)},Oe.prototype.on=Oe.prototype.addListener,Oe.prototype.prependListener=function(e,r){return oo(this,e,r,!0)};function Hh(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ao(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Hh.bind(n);return i.listener=r,n.wrapFn=i,i}Oe.prototype.once=function(e,r){return cn(r),this.on(e,ao(this,e,r)),this},Oe.prototype.prependOnceListener=function(e,r){return cn(r),this.prependListener(e,ao(this,e,r)),this},Oe.prototype.removeListener=function(e,r){var n,i,s,o,a;if(cn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():qh(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Oe.prototype.off=Oe.prototype.removeListener,Oe.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function co(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Kh(i):fo(i,i.length)}Oe.prototype.listeners=function(e){return co(this,e,!0)},Oe.prototype.rawListeners=function(e){return co(this,e,!1)},Oe.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):uo.call(t,e)},Oe.prototype.listenerCount=uo;function uo(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Oe.prototype.eventNames=function(){return this._eventsCount>0?an(this._events):[]};function fo(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function qh(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Kh(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Vh(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}ho(t,e,s,{once:!0}),e!=="error"&&Gh(t,i,{once:!0})})}function Gh(t,e,r){typeof t.on=="function"&&ho(t,"error",e,r)}function ho(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}class Wh extends Qt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class kh extends Qt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Yh{constructor(e,r){this.logger=e,this.core=r}}class Jh extends Qt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class Xh extends Qt{constructor(e){super()}}class Zh{constructor(e,r,n,i){this.core=e,this.logger=r,this.name=n}}class Qh extends Qt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class el extends Qt{constructor(e,r){super(),this.core=e,this.logger=r}}class tl{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class rl{constructor(e){this.client=e}}function hi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function jr(t){return typeof t=="string"?t:JSON.stringify(t)}var li={},gr={},un={},fn={};Object.defineProperty(fn,"__esModule",{value:!0}),fn.BrowserRandomSource=void 0;const lo=65536;class nl{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(e);for(let n=0;n<r.length;n+=lo)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,lo)));return r}}fn.BrowserRandomSource=nl;function il(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var hn={},vt={};Object.defineProperty(vt,"__esModule",{value:!0});function sl(t){for(var e=0;e<t.length;e++)t[e]=0;return t}vt.wipe=sl;var ol={},al=Object.freeze({__proto__:null,default:ol}),cl=Jt(al);Object.defineProperty(hn,"__esModule",{value:!0}),hn.NodeRandomSource=void 0;const ul=vt;class fl{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof il<"u"){const e=cl;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(e);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,ul.wipe)(r),n}}hn.NodeRandomSource=fl,Object.defineProperty(un,"__esModule",{value:!0}),un.SystemRandomSource=void 0;const hl=fn,ll=hn;class dl{constructor(){if(this.isAvailable=!1,this.name="",this._source=new hl.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ll.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}un.SystemRandomSource=dl;var re={},po={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(a,f){var h=a>>>16&65535,l=a&65535,D=f>>>16&65535,v=f&65535;return l*v+(h*v+l*D<<16>>>0)|0}t.mul=Math.imul||e;function r(a,f){return a+f|0}t.add=r;function n(a,f){return a-f|0}t.sub=n;function i(a,f){return a<<f|a>>>32-f}t.rotl=i;function s(a,f){return a<<32-f|a>>>f}t.rotr=s;function o(a){return typeof a=="number"&&isFinite(a)&&Math.floor(a)===a}t.isInteger=Number.isInteger||o,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(a){return t.isInteger(a)&&a>=-t.MAX_SAFE_INTEGER&&a<=t.MAX_SAFE_INTEGER}})(po),Object.defineProperty(re,"__esModule",{value:!0});var go=po;function pl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}re.readInt16BE=pl;function gl(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}re.readUint16BE=gl;function yl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}re.readInt16LE=yl;function vl(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}re.readUint16LE=vl;function yo(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}re.writeUint16BE=yo,re.writeInt16BE=yo;function vo(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}re.writeUint16LE=vo,re.writeInt16LE=vo;function di(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}re.readInt32BE=di;function pi(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}re.readUint32BE=pi;function gi(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}re.readInt32LE=gi;function yi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}re.readUint32LE=yi;function ln(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}re.writeUint32BE=ln,re.writeInt32BE=ln;function dn(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}re.writeUint32LE=dn,re.writeInt32LE=dn;function _l(t,e){e===void 0&&(e=0);var r=di(t,e),n=di(t,e+4);return r*4294967296+n-(n>>31)*4294967296}re.readInt64BE=_l;function bl(t,e){e===void 0&&(e=0);var r=pi(t,e),n=pi(t,e+4);return r*4294967296+n}re.readUint64BE=bl;function ml(t,e){e===void 0&&(e=0);var r=gi(t,e),n=gi(t,e+4);return n*4294967296+r-(r>>31)*4294967296}re.readInt64LE=ml;function wl(t,e){e===void 0&&(e=0);var r=yi(t,e),n=yi(t,e+4);return n*4294967296+r}re.readUint64LE=wl;function _o(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),ln(t/4294967296>>>0,e,r),ln(t>>>0,e,r+4),e}re.writeUint64BE=_o,re.writeInt64BE=_o;function bo(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),dn(t>>>0,e,r),dn(t/4294967296>>>0,e,r+4),e}re.writeUint64LE=bo,re.writeInt64LE=bo;function El(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=t/8+r-1;s>=r;s--)n+=e[s]*i,i*=256;return n}re.readUintBE=El;function Dl(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+t/8;s++)n+=e[s]*i,i*=256;return n}re.readUintLE=Dl;function xl(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!go.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,s=t/8+n-1;s>=n;s--)r[s]=e/i&255,i*=256;return r}re.writeUintBE=xl;function Sl(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!go.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+t/8;s++)r[s]=e/i&255,i*=256;return r}re.writeUintLE=Sl;function Ol(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}re.readFloat32BE=Ol;function Il(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}re.readFloat32LE=Il;function Ll(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}re.readFloat64BE=Ll;function Al(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}re.readFloat64LE=Al;function Pl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}re.writeFloat32BE=Pl;function Tl(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}re.writeFloat32LE=Tl;function Rl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}re.writeFloat64BE=Rl;function Cl(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}re.writeFloat64LE=Cl,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.randomStringForEntropy=t.randomString=t.randomUint32=t.randomBytes=t.defaultRandomSource=void 0;const e=un,r=re,n=vt;t.defaultRandomSource=new e.SystemRandomSource;function i(h,l=t.defaultRandomSource){return l.randomBytes(h)}t.randomBytes=i;function s(h=t.defaultRandomSource){const l=i(4,h),D=(0,r.readUint32LE)(l);return(0,n.wipe)(l),D}t.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function a(h,l=o,D=t.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let v="";const m=l.length,w=256-256%m;for(;h>0;){const N=i(Math.ceil(h*256/w),D);for(let R=0;R<N.length&&h>0;R++){const B=N[R];B<w&&(v+=l.charAt(B%m),h--)}(0,n.wipe)(N)}return v}t.randomString=a;function f(h,l=o,D=t.defaultRandomSource){const v=Math.ceil(h/(Math.log(l.length)/Math.LN2));return a(v,l,D)}t.randomStringForEntropy=f}(gr);var mo={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=vt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},a.prototype.update=function(f,h){if(h===void 0&&(h=f.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&h>0;)this._buffer[this._bufferLength++]=f[l++],h--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,f,l,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=f[l++],h--;return this},a.prototype.finish=function(f){if(!this._finished){var h=this._bytesHashed,l=this._bufferLength,D=h/536870912|0,v=h<<3,m=h%128<112?128:256;this._buffer[l]=128;for(var w=l+1;w<m-8;w++)this._buffer[w]=0;e.writeUint32BE(D,this._buffer,m-8),e.writeUint32BE(v,this._buffer,m-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,m),this._finished=!0}for(var w=0;w<this.digestLength/8;w++)e.writeUint32BE(this._stateHi[w],f,w*8),e.writeUint32BE(this._stateLo[w],f,w*8+4);return this},a.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(f){return this._stateHi.set(f.stateHi),this._stateLo.set(f.stateLo),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(f){r.wipe(f.stateHi),r.wipe(f.stateLo),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},a}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(a,f,h,l,D,v,m){for(var w=h[0],N=h[1],R=h[2],B=h[3],S=h[4],L=h[5],y=h[6],x=h[7],E=l[0],c=l[1],d=l[2],M=l[3],H=l[4],G=l[5],J=l[6],X=l[7],g,_,F,U,C,T,j,z;m>=128;){for(var Q=0;Q<16;Q++){var q=8*Q+v;a[Q]=e.readUint32BE(D,q),f[Q]=e.readUint32BE(D,q+4)}for(var Q=0;Q<80;Q++){var ee=w,Y=N,ae=R,P=B,A=S,O=L,u=y,b=x,K=E,W=c,he=d,ve=M,de=H,me=G,je=J,Ne=X;if(g=x,_=X,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=(S>>>14|H<<32-14)^(S>>>18|H<<32-18)^(H>>>41-32|S<<32-(41-32)),_=(H>>>14|S<<32-14)^(H>>>18|S<<32-18)^(S>>>41-32|H<<32-(41-32)),C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,g=S&L^~S&y,_=H&G^~H&J,C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,g=i[Q*2],_=i[Q*2+1],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,g=a[Q%16],_=f[Q%16],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,F=j&65535|z<<16,U=C&65535|T<<16,g=F,_=U,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=(w>>>28|E<<32-28)^(E>>>34-32|w<<32-(34-32))^(E>>>39-32|w<<32-(39-32)),_=(E>>>28|w<<32-28)^(w>>>34-32|E<<32-(34-32))^(w>>>39-32|E<<32-(39-32)),C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,g=w&N^w&R^N&R,_=E&c^E&d^c&d,C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,b=j&65535|z<<16,Ne=C&65535|T<<16,g=P,_=ve,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=F,_=U,C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,P=j&65535|z<<16,ve=C&65535|T<<16,N=ee,R=Y,B=ae,S=P,L=A,y=O,x=u,w=b,c=K,d=W,M=he,H=ve,G=de,J=me,X=je,E=Ne,Q%16===15)for(var q=0;q<16;q++)g=a[q],_=f[q],C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=a[(q+9)%16],_=f[(q+9)%16],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,F=a[(q+1)%16],U=f[(q+1)%16],g=(F>>>1|U<<32-1)^(F>>>8|U<<32-8)^F>>>7,_=(U>>>1|F<<32-1)^(U>>>8|F<<32-8)^(U>>>7|F<<32-7),C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,F=a[(q+14)%16],U=f[(q+14)%16],g=(F>>>19|U<<32-19)^(U>>>61-32|F<<32-(61-32))^F>>>6,_=(U>>>19|F<<32-19)^(F>>>61-32|U<<32-(61-32))^(U>>>6|F<<32-6),C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,a[q]=j&65535|z<<16,f[q]=C&65535|T<<16}g=w,_=E,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=h[0],_=l[0],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,h[0]=w=j&65535|z<<16,l[0]=E=C&65535|T<<16,g=N,_=c,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=h[1],_=l[1],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,h[1]=N=j&65535|z<<16,l[1]=c=C&65535|T<<16,g=R,_=d,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=h[2],_=l[2],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,h[2]=R=j&65535|z<<16,l[2]=d=C&65535|T<<16,g=B,_=M,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=h[3],_=l[3],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,h[3]=B=j&65535|z<<16,l[3]=M=C&65535|T<<16,g=S,_=H,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=h[4],_=l[4],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,h[4]=S=j&65535|z<<16,l[4]=H=C&65535|T<<16,g=L,_=G,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=h[5],_=l[5],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,h[5]=L=j&65535|z<<16,l[5]=G=C&65535|T<<16,g=y,_=J,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=h[6],_=l[6],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,h[6]=y=j&65535|z<<16,l[6]=J=C&65535|T<<16,g=x,_=X,C=_&65535,T=_>>>16,j=g&65535,z=g>>>16,g=h[7],_=l[7],C+=_&65535,T+=_>>>16,j+=g&65535,z+=g>>>16,T+=C>>>16,j+=T>>>16,z+=j>>>16,h[7]=x=j&65535|z<<16,l[7]=X=C&65535|T<<16,v+=128,m-=128}return v}function o(a){var f=new n;f.update(a);var h=f.digest();return f.clean(),h}t.hash=o})(mo),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=gr,r=mo,n=vt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function i(P){const A=new Float64Array(16);if(P)for(let O=0;O<P.length;O++)A[O]=P[O];return A}const s=new Uint8Array(32);s[0]=9;const o=i(),a=i([1]),f=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),D=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),v=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function m(P,A){for(let O=0;O<16;O++)P[O]=A[O]|0}function w(P){let A=1;for(let O=0;O<16;O++){let u=P[O]+A+65535;A=Math.floor(u/65536),P[O]=u-A*65536}P[0]+=A-1+37*(A-1)}function N(P,A,O){const u=~(O-1);for(let b=0;b<16;b++){const K=u&(P[b]^A[b]);P[b]^=K,A[b]^=K}}function R(P,A){const O=i(),u=i();for(let b=0;b<16;b++)u[b]=A[b];w(u),w(u),w(u);for(let b=0;b<2;b++){O[0]=u[0]-65517;for(let W=1;W<15;W++)O[W]=u[W]-65535-(O[W-1]>>16&1),O[W-1]&=65535;O[15]=u[15]-32767-(O[14]>>16&1);const K=O[15]>>16&1;O[14]&=65535,N(u,O,1-K)}for(let b=0;b<16;b++)P[2*b]=u[b]&255,P[2*b+1]=u[b]>>8}function B(P,A){let O=0;for(let u=0;u<32;u++)O|=P[u]^A[u];return(1&O-1>>>8)-1}function S(P,A){const O=new Uint8Array(32),u=new Uint8Array(32);return R(O,P),R(u,A),B(O,u)}function L(P){const A=new Uint8Array(32);return R(A,P),A[0]&1}function y(P,A){for(let O=0;O<16;O++)P[O]=A[2*O]+(A[2*O+1]<<8);P[15]&=32767}function x(P,A,O){for(let u=0;u<16;u++)P[u]=A[u]+O[u]}function E(P,A,O){for(let u=0;u<16;u++)P[u]=A[u]-O[u]}function c(P,A,O){let u,b,K=0,W=0,he=0,ve=0,de=0,me=0,je=0,Ne=0,ye=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,te=0,fe=0,ge=0,ne=0,_e=0,be=0,Ee=0,De=0,we=0,St=0,Ct=0,Vt=0,bt=0,sr=0,Jr=0,Fn=0,ze=O[0],$e=O[1],He=O[2],qe=O[3],Ke=O[4],Fe=O[5],Ye=O[6],Je=O[7],Xe=O[8],Ze=O[9],Qe=O[10],Ge=O[11],Ve=O[12],Re=O[13],et=O[14],tt=O[15];u=A[0],K+=u*ze,W+=u*$e,he+=u*He,ve+=u*qe,de+=u*Ke,me+=u*Fe,je+=u*Ye,Ne+=u*Je,ye+=u*Xe,pe+=u*Ze,le+=u*Qe,ue+=u*Ge,ce+=u*Ve,oe+=u*Re,se+=u*et,te+=u*tt,u=A[1],W+=u*ze,he+=u*$e,ve+=u*He,de+=u*qe,me+=u*Ke,je+=u*Fe,Ne+=u*Ye,ye+=u*Je,pe+=u*Xe,le+=u*Ze,ue+=u*Qe,ce+=u*Ge,oe+=u*Ve,se+=u*Re,te+=u*et,fe+=u*tt,u=A[2],he+=u*ze,ve+=u*$e,de+=u*He,me+=u*qe,je+=u*Ke,Ne+=u*Fe,ye+=u*Ye,pe+=u*Je,le+=u*Xe,ue+=u*Ze,ce+=u*Qe,oe+=u*Ge,se+=u*Ve,te+=u*Re,fe+=u*et,ge+=u*tt,u=A[3],ve+=u*ze,de+=u*$e,me+=u*He,je+=u*qe,Ne+=u*Ke,ye+=u*Fe,pe+=u*Ye,le+=u*Je,ue+=u*Xe,ce+=u*Ze,oe+=u*Qe,se+=u*Ge,te+=u*Ve,fe+=u*Re,ge+=u*et,ne+=u*tt,u=A[4],de+=u*ze,me+=u*$e,je+=u*He,Ne+=u*qe,ye+=u*Ke,pe+=u*Fe,le+=u*Ye,ue+=u*Je,ce+=u*Xe,oe+=u*Ze,se+=u*Qe,te+=u*Ge,fe+=u*Ve,ge+=u*Re,ne+=u*et,_e+=u*tt,u=A[5],me+=u*ze,je+=u*$e,Ne+=u*He,ye+=u*qe,pe+=u*Ke,le+=u*Fe,ue+=u*Ye,ce+=u*Je,oe+=u*Xe,se+=u*Ze,te+=u*Qe,fe+=u*Ge,ge+=u*Ve,ne+=u*Re,_e+=u*et,be+=u*tt,u=A[6],je+=u*ze,Ne+=u*$e,ye+=u*He,pe+=u*qe,le+=u*Ke,ue+=u*Fe,ce+=u*Ye,oe+=u*Je,se+=u*Xe,te+=u*Ze,fe+=u*Qe,ge+=u*Ge,ne+=u*Ve,_e+=u*Re,be+=u*et,Ee+=u*tt,u=A[7],Ne+=u*ze,ye+=u*$e,pe+=u*He,le+=u*qe,ue+=u*Ke,ce+=u*Fe,oe+=u*Ye,se+=u*Je,te+=u*Xe,fe+=u*Ze,ge+=u*Qe,ne+=u*Ge,_e+=u*Ve,be+=u*Re,Ee+=u*et,De+=u*tt,u=A[8],ye+=u*ze,pe+=u*$e,le+=u*He,ue+=u*qe,ce+=u*Ke,oe+=u*Fe,se+=u*Ye,te+=u*Je,fe+=u*Xe,ge+=u*Ze,ne+=u*Qe,_e+=u*Ge,be+=u*Ve,Ee+=u*Re,De+=u*et,we+=u*tt,u=A[9],pe+=u*ze,le+=u*$e,ue+=u*He,ce+=u*qe,oe+=u*Ke,se+=u*Fe,te+=u*Ye,fe+=u*Je,ge+=u*Xe,ne+=u*Ze,_e+=u*Qe,be+=u*Ge,Ee+=u*Ve,De+=u*Re,we+=u*et,St+=u*tt,u=A[10],le+=u*ze,ue+=u*$e,ce+=u*He,oe+=u*qe,se+=u*Ke,te+=u*Fe,fe+=u*Ye,ge+=u*Je,ne+=u*Xe,_e+=u*Ze,be+=u*Qe,Ee+=u*Ge,De+=u*Ve,we+=u*Re,St+=u*et,Ct+=u*tt,u=A[11],ue+=u*ze,ce+=u*$e,oe+=u*He,se+=u*qe,te+=u*Ke,fe+=u*Fe,ge+=u*Ye,ne+=u*Je,_e+=u*Xe,be+=u*Ze,Ee+=u*Qe,De+=u*Ge,we+=u*Ve,St+=u*Re,Ct+=u*et,Vt+=u*tt,u=A[12],ce+=u*ze,oe+=u*$e,se+=u*He,te+=u*qe,fe+=u*Ke,ge+=u*Fe,ne+=u*Ye,_e+=u*Je,be+=u*Xe,Ee+=u*Ze,De+=u*Qe,we+=u*Ge,St+=u*Ve,Ct+=u*Re,Vt+=u*et,bt+=u*tt,u=A[13],oe+=u*ze,se+=u*$e,te+=u*He,fe+=u*qe,ge+=u*Ke,ne+=u*Fe,_e+=u*Ye,be+=u*Je,Ee+=u*Xe,De+=u*Ze,we+=u*Qe,St+=u*Ge,Ct+=u*Ve,Vt+=u*Re,bt+=u*et,sr+=u*tt,u=A[14],se+=u*ze,te+=u*$e,fe+=u*He,ge+=u*qe,ne+=u*Ke,_e+=u*Fe,be+=u*Ye,Ee+=u*Je,De+=u*Xe,we+=u*Ze,St+=u*Qe,Ct+=u*Ge,Vt+=u*Ve,bt+=u*Re,sr+=u*et,Jr+=u*tt,u=A[15],te+=u*ze,fe+=u*$e,ge+=u*He,ne+=u*qe,_e+=u*Ke,be+=u*Fe,Ee+=u*Ye,De+=u*Je,we+=u*Xe,St+=u*Ze,Ct+=u*Qe,Vt+=u*Ge,bt+=u*Ve,sr+=u*Re,Jr+=u*et,Fn+=u*tt,K+=38*fe,W+=38*ge,he+=38*ne,ve+=38*_e,de+=38*be,me+=38*Ee,je+=38*De,Ne+=38*we,ye+=38*St,pe+=38*Ct,le+=38*Vt,ue+=38*bt,ce+=38*sr,oe+=38*Jr,se+=38*Fn,b=1,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=he+b+65535,b=Math.floor(u/65536),he=u-b*65536,u=ve+b+65535,b=Math.floor(u/65536),ve=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,u=je+b+65535,b=Math.floor(u/65536),je=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,u=ye+b+65535,b=Math.floor(u/65536),ye=u-b*65536,u=pe+b+65535,b=Math.floor(u/65536),pe=u-b*65536,u=le+b+65535,b=Math.floor(u/65536),le=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=se+b+65535,b=Math.floor(u/65536),se=u-b*65536,u=te+b+65535,b=Math.floor(u/65536),te=u-b*65536,K+=b-1+37*(b-1),b=1,u=K+b+65535,b=Math.floor(u/65536),K=u-b*65536,u=W+b+65535,b=Math.floor(u/65536),W=u-b*65536,u=he+b+65535,b=Math.floor(u/65536),he=u-b*65536,u=ve+b+65535,b=Math.floor(u/65536),ve=u-b*65536,u=de+b+65535,b=Math.floor(u/65536),de=u-b*65536,u=me+b+65535,b=Math.floor(u/65536),me=u-b*65536,u=je+b+65535,b=Math.floor(u/65536),je=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,u=ye+b+65535,b=Math.floor(u/65536),ye=u-b*65536,u=pe+b+65535,b=Math.floor(u/65536),pe=u-b*65536,u=le+b+65535,b=Math.floor(u/65536),le=u-b*65536,u=ue+b+65535,b=Math.floor(u/65536),ue=u-b*65536,u=ce+b+65535,b=Math.floor(u/65536),ce=u-b*65536,u=oe+b+65535,b=Math.floor(u/65536),oe=u-b*65536,u=se+b+65535,b=Math.floor(u/65536),se=u-b*65536,u=te+b+65535,b=Math.floor(u/65536),te=u-b*65536,K+=b-1+37*(b-1),P[0]=K,P[1]=W,P[2]=he,P[3]=ve,P[4]=de,P[5]=me,P[6]=je,P[7]=Ne,P[8]=ye,P[9]=pe,P[10]=le,P[11]=ue,P[12]=ce,P[13]=oe,P[14]=se,P[15]=te}function d(P,A){c(P,A,A)}function M(P,A){const O=i();let u;for(u=0;u<16;u++)O[u]=A[u];for(u=253;u>=0;u--)d(O,O),u!==2&&u!==4&&c(O,O,A);for(u=0;u<16;u++)P[u]=O[u]}function H(P,A){const O=i();let u;for(u=0;u<16;u++)O[u]=A[u];for(u=250;u>=0;u--)d(O,O),u!==1&&c(O,O,A);for(u=0;u<16;u++)P[u]=O[u]}function G(P,A){const O=i(),u=i(),b=i(),K=i(),W=i(),he=i(),ve=i(),de=i(),me=i();E(O,P[1],P[0]),E(me,A[1],A[0]),c(O,O,me),x(u,P[0],P[1]),x(me,A[0],A[1]),c(u,u,me),c(b,P[3],A[3]),c(b,b,h),c(K,P[2],A[2]),x(K,K,K),E(W,u,O),E(he,K,b),x(ve,K,b),x(de,u,O),c(P[0],W,he),c(P[1],de,ve),c(P[2],ve,he),c(P[3],W,de)}function J(P,A,O){for(let u=0;u<4;u++)N(P[u],A[u],O)}function X(P,A){const O=i(),u=i(),b=i();M(b,A[2]),c(O,A[0],b),c(u,A[1],b),R(P,u),P[31]^=L(O)<<7}function g(P,A,O){m(P[0],o),m(P[1],a),m(P[2],a),m(P[3],o);for(let u=255;u>=0;--u){const b=O[u/8|0]>>(u&7)&1;J(P,A,b),G(A,P),G(P,P),J(P,A,b)}}function _(P,A){const O=[i(),i(),i(),i()];m(O[0],l),m(O[1],D),m(O[2],a),c(O[3],l,D),g(P,O,A)}function F(P){if(P.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const A=(0,r.hash)(P);A[0]&=248,A[31]&=127,A[31]|=64;const O=new Uint8Array(32),u=[i(),i(),i(),i()];_(u,A),X(O,u);const b=new Uint8Array(64);return b.set(P),b.set(O,32),{publicKey:O,secretKey:b}}t.generateKeyPairFromSeed=F;function U(P){const A=(0,e.randomBytes)(32,P),O=F(A);return(0,n.wipe)(A),O}t.generateKeyPair=U;function C(P){if(P.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(P.subarray(32))}t.extractPublicKeyFromSecretKey=C;const T=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function j(P,A){let O,u,b,K;for(u=63;u>=32;--u){for(O=0,b=u-32,K=u-12;b<K;++b)A[b]+=O-16*A[u]*T[b-(u-32)],O=Math.floor((A[b]+128)/256),A[b]-=O*256;A[b]+=O,A[u]=0}for(O=0,b=0;b<32;b++)A[b]+=O-(A[31]>>4)*T[b],O=A[b]>>8,A[b]&=255;for(b=0;b<32;b++)A[b]-=O*T[b];for(u=0;u<32;u++)A[u+1]+=A[u]>>8,P[u]=A[u]&255}function z(P){const A=new Float64Array(64);for(let O=0;O<64;O++)A[O]=P[O];for(let O=0;O<64;O++)P[O]=0;j(P,A)}function Q(P,A){const O=new Float64Array(64),u=[i(),i(),i(),i()],b=(0,r.hash)(P.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const K=new Uint8Array(64);K.set(b.subarray(32),32);const W=new r.SHA512;W.update(K.subarray(32)),W.update(A);const he=W.digest();W.clean(),z(he),_(u,he),X(K,u),W.reset(),W.update(K.subarray(0,32)),W.update(P.subarray(32)),W.update(A);const ve=W.digest();z(ve);for(let de=0;de<32;de++)O[de]=he[de];for(let de=0;de<32;de++)for(let me=0;me<32;me++)O[de+me]+=ve[de]*b[me];return j(K.subarray(32),O),K}t.sign=Q;function q(P,A){const O=i(),u=i(),b=i(),K=i(),W=i(),he=i(),ve=i();return m(P[2],a),y(P[1],A),d(b,P[1]),c(K,b,f),E(b,b,P[2]),x(K,P[2],K),d(W,K),d(he,W),c(ve,he,W),c(O,ve,b),c(O,O,K),H(O,O),c(O,O,b),c(O,O,K),c(O,O,K),c(P[0],O,K),d(u,P[0]),c(u,u,K),S(u,b)&&c(P[0],P[0],v),d(u,P[0]),c(u,u,K),S(u,b)?-1:(L(P[0])===A[31]>>7&&E(P[0],o,P[0]),c(P[3],P[0],P[1]),0)}function ee(P,A,O){const u=new Uint8Array(32),b=[i(),i(),i(),i()],K=[i(),i(),i(),i()];if(O.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(q(K,P))return!1;const W=new r.SHA512;W.update(O.subarray(0,32)),W.update(P),W.update(A);const he=W.digest();return z(he),g(b,K,he),_(K,O.subarray(32)),G(b,K),X(u,b),!B(O,u)}t.verify=ee;function Y(P){let A=[i(),i(),i(),i()];if(q(A,P))throw new Error("Ed25519: invalid public key");let O=i(),u=i(),b=A[1];x(O,a,b),E(u,a,b),M(u,u),c(O,O,u);let K=new Uint8Array(32);return R(K,O),K}t.convertPublicKeyToX25519=Y;function ae(P){const A=(0,r.hash)(P.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const O=new Uint8Array(A.subarray(0,32));return(0,n.wipe)(A),O}t.convertSecretKeyToX25519=ae}(li);const Nl="EdDSA",$l="JWT",wo=".",Eo="base64url",Fl="utf8",Ul="utf8",Ml=":",jl="did",Bl="key",Do="base58btc",zl="z",Hl="K36",ql=32;function xo(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function vi(t,e){e||(e=t.reduce((i,s)=>i+s.length,0));const r=xo(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function Kl(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,f=t.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function D(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var N=0,R=0,B=0,S=w.length;B!==S&&w[B]===0;)B++,N++;for(var L=(S-B)*l+1>>>0,y=new Uint8Array(L);B!==S;){for(var x=w[B],E=0,c=L-1;(x!==0||E<R)&&c!==-1;c--,E++)x+=256*y[c]>>>0,y[c]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");R=E,B++}for(var d=L-R;d!==L&&y[d]===0;)d++;for(var M=f.repeat(N);d<L;++d)M+=t.charAt(y[d]);return M}function v(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var N=0;if(w[N]!==" "){for(var R=0,B=0;w[N]===f;)R++,N++;for(var S=(w.length-N)*h+1>>>0,L=new Uint8Array(S);w[N];){var y=r[w.charCodeAt(N)];if(y===255)return;for(var x=0,E=S-1;(y!==0||x<B)&&E!==-1;E--,x++)y+=a*L[E]>>>0,L[E]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");B=x,N++}if(w[N]!==" "){for(var c=S-B;c!==S&&L[c]===0;)c++;for(var d=new Uint8Array(R+(S-c)),M=R;c!==S;)d[M++]=L[c++];return d}}}function m(w){var N=v(w);if(N)return N;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:v,decode:m}}var Vl=Kl,Gl=Vl;const So=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Wl=t=>new TextEncoder().encode(t),kl=t=>new TextDecoder().decode(t);class Yl{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Jl{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Oo(this,e)}}class Xl{constructor(e){this.decoders=e}or(e){return Oo(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Oo=(t,e)=>new Xl({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Zl{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Yl(e,r,n),this.decoder=new Jl(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const pn=({name:t,prefix:e,encode:r,decode:n})=>new Zl(t,e,r,n),Br=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=Gl(r,e);return pn({prefix:t,name:e,encode:n,decode:s=>So(i(s))})},Ql=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,f=0,h=0;for(let l=0;l<s;++l){const D=i[t[l]];if(D===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|D,a+=r,a>=8&&(a-=8,o[h++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},ed=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},nt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>pn({prefix:e,name:t,encode(i){return ed(i,n,r)},decode(i){return Ql(i,n,r,t)}}),td=pn({prefix:"\0",name:"identity",encode:t=>kl(t),decode:t=>Wl(t)});var rd=Object.freeze({__proto__:null,identity:td});const nd=nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var id=Object.freeze({__proto__:null,base2:nd});const sd=nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var od=Object.freeze({__proto__:null,base8:sd});const ad=Br({prefix:"9",name:"base10",alphabet:"0123456789"});var cd=Object.freeze({__proto__:null,base10:ad});const ud=nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),fd=nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var hd=Object.freeze({__proto__:null,base16:ud,base16upper:fd});const ld=nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),dd=nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),pd=nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),gd=nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),yd=nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vd=nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),_d=nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),bd=nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),md=nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var wd=Object.freeze({__proto__:null,base32:ld,base32upper:dd,base32pad:pd,base32padupper:gd,base32hex:yd,base32hexupper:vd,base32hexpad:_d,base32hexpadupper:bd,base32z:md});const Ed=Br({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Dd=Br({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var xd=Object.freeze({__proto__:null,base36:Ed,base36upper:Dd});const Sd=Br({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Od=Br({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Id=Object.freeze({__proto__:null,base58btc:Sd,base58flickr:Od});const Ld=nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Ad=nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Pd=nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Td=nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Rd=Object.freeze({__proto__:null,base64:Ld,base64pad:Ad,base64url:Pd,base64urlpad:Td});const Io=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Cd=Io.reduce((t,e,r)=>(t[r]=e,t),[]),Nd=Io.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function $d(t){return t.reduce((e,r)=>(e+=Cd[r],e),"")}function Fd(t){const e=[];for(const r of t){const n=Nd[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Ud=pn({prefix:"\u{1F680}",name:"base256emoji",encode:$d,decode:Fd});var Md=Object.freeze({__proto__:null,base256emoji:Ud}),jd=Ao,Lo=128,Bd=127,zd=~Bd,Hd=Math.pow(2,31);function Ao(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Hd;)e[r++]=t&255|Lo,t/=128;for(;t&zd;)e[r++]=t&255|Lo,t>>>=7;return e[r]=t|0,Ao.bytes=r-n+1,e}var qd=_i,Kd=128,Po=127;function _i(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw _i.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&Po)<<i:(o&Po)*Math.pow(2,i),i+=7}while(o>=Kd);return _i.bytes=s-n,r}var Vd=Math.pow(2,7),Gd=Math.pow(2,14),Wd=Math.pow(2,21),kd=Math.pow(2,28),Yd=Math.pow(2,35),Jd=Math.pow(2,42),Xd=Math.pow(2,49),Zd=Math.pow(2,56),Qd=Math.pow(2,63),ep=function(t){return t<Vd?1:t<Gd?2:t<Wd?3:t<kd?4:t<Yd?5:t<Jd?6:t<Xd?7:t<Zd?8:t<Qd?9:10},tp={encode:jd,decode:qd,encodingLength:ep},To=tp;const Ro=(t,e,r=0)=>(To.encode(t,e,r),e),Co=t=>To.encodingLength(t),bi=(t,e)=>{const r=e.byteLength,n=Co(t),i=n+Co(r),s=new Uint8Array(i+r);return Ro(t,s,0),Ro(r,s,n),s.set(e,i),new rp(t,r,e,s)};class rp{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const No=({name:t,code:e,encode:r})=>new np(t,e,r);class np{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?bi(this.code,r):r.then(n=>bi(this.code,n))}else throw Error("Unknown type, must be binary type")}}const $o=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),ip=No({name:"sha2-256",code:18,encode:$o("SHA-256")}),sp=No({name:"sha2-512",code:19,encode:$o("SHA-512")});var op=Object.freeze({__proto__:null,sha256:ip,sha512:sp});const Fo=0,ap="identity",Uo=So;var cp=Object.freeze({__proto__:null,identity:{code:Fo,name:ap,encode:Uo,digest:t=>bi(Fo,Uo(t))}});new TextEncoder,new TextDecoder;const Mo={...rd,...id,...od,...cd,...hd,...wd,...xd,...Id,...Rd,...Md};({...op,...cp});function jo(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Bo=jo("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),mi=jo("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=xo(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),zo={utf8:Bo,"utf-8":Bo,hex:Mo.base16,latin1:mi,ascii:mi,binary:mi,...Mo};function lt(t,e="utf8"){const r=zo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function dt(t,e="utf8"){const r=zo[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function gn(t){return lt(dt(jr(t),Fl),Eo)}function Ho(t){const e=dt(Hl,Do),r=zl+lt(vi([e,t]),Do);return[jl,Bl,r].join(Ml)}function up(t){return lt(t,Eo)}function fp(t){return dt([gn(t.header),gn(t.payload)].join(wo),Ul)}function hp(t){return[gn(t.header),gn(t.payload),up(t.signature)].join(wo)}function qo(t=gr.randomBytes(ql)){return li.generateKeyPairFromSeed(t)}async function lp(t,e,r,n,i=Z.fromMiliseconds(Date.now())){const s={alg:Nl,typ:$l},o=Ho(n.publicKey),a=i+r,f={iss:o,sub:t,aud:e,iat:i,exp:a},h=fp({header:s,payload:f}),l=li.sign(n.secretKey,h);return hp({header:s,payload:f,signature:l})}var wi={},yn={};Object.defineProperty(yn,"__esModule",{value:!0});var at=re,Ei=vt,dp=20;function pp(t,e,r){for(var n=1634760805,i=857760878,s=2036477234,o=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],h=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],D=r[19]<<24|r[18]<<16|r[17]<<8|r[16],v=r[23]<<24|r[22]<<16|r[21]<<8|r[20],m=r[27]<<24|r[26]<<16|r[25]<<8|r[24],w=r[31]<<24|r[30]<<16|r[29]<<8|r[28],N=e[3]<<24|e[2]<<16|e[1]<<8|e[0],R=e[7]<<24|e[6]<<16|e[5]<<8|e[4],B=e[11]<<24|e[10]<<16|e[9]<<8|e[8],S=e[15]<<24|e[14]<<16|e[13]<<8|e[12],L=n,y=i,x=s,E=o,c=a,d=f,M=h,H=l,G=D,J=v,X=m,g=w,_=N,F=R,U=B,C=S,T=0;T<dp;T+=2)L=L+c|0,_^=L,_=_>>>32-16|_<<16,G=G+_|0,c^=G,c=c>>>32-12|c<<12,y=y+d|0,F^=y,F=F>>>32-16|F<<16,J=J+F|0,d^=J,d=d>>>32-12|d<<12,x=x+M|0,U^=x,U=U>>>32-16|U<<16,X=X+U|0,M^=X,M=M>>>32-12|M<<12,E=E+H|0,C^=E,C=C>>>32-16|C<<16,g=g+C|0,H^=g,H=H>>>32-12|H<<12,x=x+M|0,U^=x,U=U>>>32-8|U<<8,X=X+U|0,M^=X,M=M>>>32-7|M<<7,E=E+H|0,C^=E,C=C>>>32-8|C<<8,g=g+C|0,H^=g,H=H>>>32-7|H<<7,y=y+d|0,F^=y,F=F>>>32-8|F<<8,J=J+F|0,d^=J,d=d>>>32-7|d<<7,L=L+c|0,_^=L,_=_>>>32-8|_<<8,G=G+_|0,c^=G,c=c>>>32-7|c<<7,L=L+d|0,C^=L,C=C>>>32-16|C<<16,X=X+C|0,d^=X,d=d>>>32-12|d<<12,y=y+M|0,_^=y,_=_>>>32-16|_<<16,g=g+_|0,M^=g,M=M>>>32-12|M<<12,x=x+H|0,F^=x,F=F>>>32-16|F<<16,G=G+F|0,H^=G,H=H>>>32-12|H<<12,E=E+c|0,U^=E,U=U>>>32-16|U<<16,J=J+U|0,c^=J,c=c>>>32-12|c<<12,x=x+H|0,F^=x,F=F>>>32-8|F<<8,G=G+F|0,H^=G,H=H>>>32-7|H<<7,E=E+c|0,U^=E,U=U>>>32-8|U<<8,J=J+U|0,c^=J,c=c>>>32-7|c<<7,y=y+M|0,_^=y,_=_>>>32-8|_<<8,g=g+_|0,M^=g,M=M>>>32-7|M<<7,L=L+d|0,C^=L,C=C>>>32-8|C<<8,X=X+C|0,d^=X,d=d>>>32-7|d<<7;at.writeUint32LE(L+n|0,t,0),at.writeUint32LE(y+i|0,t,4),at.writeUint32LE(x+s|0,t,8),at.writeUint32LE(E+o|0,t,12),at.writeUint32LE(c+a|0,t,16),at.writeUint32LE(d+f|0,t,20),at.writeUint32LE(M+h|0,t,24),at.writeUint32LE(H+l|0,t,28),at.writeUint32LE(G+D|0,t,32),at.writeUint32LE(J+v|0,t,36),at.writeUint32LE(X+m|0,t,40),at.writeUint32LE(g+w|0,t,44),at.writeUint32LE(_+N|0,t,48),at.writeUint32LE(F+R|0,t,52),at.writeUint32LE(U+B|0,t,56),at.writeUint32LE(C+S|0,t,60)}function Ko(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-e.length,s.set(e,o)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,o=i}for(var a=new Uint8Array(64),f=0;f<r.length;f+=64){pp(a,s,t);for(var h=f;h<f+64&&h<r.length;h++)n[h]=r[h]^a[h-f];yp(s,0,o)}return Ei.wipe(a),i===0&&Ei.wipe(s),n}yn.streamXOR=Ko;function gp(t,e,r,n){return n===void 0&&(n=0),Ei.wipe(r),Ko(t,e,r,r,n)}yn.stream=gp;function yp(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}var Vo={},Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});function vp(t,e,r){return~(t-1)&e|t-1&r}Ht.select=vp;function _p(t,e){return(t|0)-(e|0)-1>>>31&1}Ht.lessOrEqual=_p;function Go(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}Ht.compare=Go;function bp(t,e){return t.length===0||e.length===0?!1:Go(t,e)!==0}Ht.equal=bp,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Ht,r=vt;t.DIGEST_LENGTH=16;var n=function(){function o(a){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var f=a[0]|a[1]<<8;this._r[0]=f&8191;var h=a[2]|a[3]<<8;this._r[1]=(f>>>13|h<<3)&8191;var l=a[4]|a[5]<<8;this._r[2]=(h>>>10|l<<6)&7939;var D=a[6]|a[7]<<8;this._r[3]=(l>>>7|D<<9)&8191;var v=a[8]|a[9]<<8;this._r[4]=(D>>>4|v<<12)&255,this._r[5]=v>>>1&8190;var m=a[10]|a[11]<<8;this._r[6]=(v>>>14|m<<2)&8191;var w=a[12]|a[13]<<8;this._r[7]=(m>>>11|w<<5)&8065;var N=a[14]|a[15]<<8;this._r[8]=(w>>>8|N<<8)&8191,this._r[9]=N>>>5&127,this._pad[0]=a[16]|a[17]<<8,this._pad[1]=a[18]|a[19]<<8,this._pad[2]=a[20]|a[21]<<8,this._pad[3]=a[22]|a[23]<<8,this._pad[4]=a[24]|a[25]<<8,this._pad[5]=a[26]|a[27]<<8,this._pad[6]=a[28]|a[29]<<8,this._pad[7]=a[30]|a[31]<<8}return o.prototype._blocks=function(a,f,h){for(var l=this._fin?0:2048,D=this._h[0],v=this._h[1],m=this._h[2],w=this._h[3],N=this._h[4],R=this._h[5],B=this._h[6],S=this._h[7],L=this._h[8],y=this._h[9],x=this._r[0],E=this._r[1],c=this._r[2],d=this._r[3],M=this._r[4],H=this._r[5],G=this._r[6],J=this._r[7],X=this._r[8],g=this._r[9];h>=16;){var _=a[f+0]|a[f+1]<<8;D+=_&8191;var F=a[f+2]|a[f+3]<<8;v+=(_>>>13|F<<3)&8191;var U=a[f+4]|a[f+5]<<8;m+=(F>>>10|U<<6)&8191;var C=a[f+6]|a[f+7]<<8;w+=(U>>>7|C<<9)&8191;var T=a[f+8]|a[f+9]<<8;N+=(C>>>4|T<<12)&8191,R+=T>>>1&8191;var j=a[f+10]|a[f+11]<<8;B+=(T>>>14|j<<2)&8191;var z=a[f+12]|a[f+13]<<8;S+=(j>>>11|z<<5)&8191;var Q=a[f+14]|a[f+15]<<8;L+=(z>>>8|Q<<8)&8191,y+=Q>>>5|l;var q=0,ee=q;ee+=D*x,ee+=v*(5*g),ee+=m*(5*X),ee+=w*(5*J),ee+=N*(5*G),q=ee>>>13,ee&=8191,ee+=R*(5*H),ee+=B*(5*M),ee+=S*(5*d),ee+=L*(5*c),ee+=y*(5*E),q+=ee>>>13,ee&=8191;var Y=q;Y+=D*E,Y+=v*x,Y+=m*(5*g),Y+=w*(5*X),Y+=N*(5*J),q=Y>>>13,Y&=8191,Y+=R*(5*G),Y+=B*(5*H),Y+=S*(5*M),Y+=L*(5*d),Y+=y*(5*c),q+=Y>>>13,Y&=8191;var ae=q;ae+=D*c,ae+=v*E,ae+=m*x,ae+=w*(5*g),ae+=N*(5*X),q=ae>>>13,ae&=8191,ae+=R*(5*J),ae+=B*(5*G),ae+=S*(5*H),ae+=L*(5*M),ae+=y*(5*d),q+=ae>>>13,ae&=8191;var P=q;P+=D*d,P+=v*c,P+=m*E,P+=w*x,P+=N*(5*g),q=P>>>13,P&=8191,P+=R*(5*X),P+=B*(5*J),P+=S*(5*G),P+=L*(5*H),P+=y*(5*M),q+=P>>>13,P&=8191;var A=q;A+=D*M,A+=v*d,A+=m*c,A+=w*E,A+=N*x,q=A>>>13,A&=8191,A+=R*(5*g),A+=B*(5*X),A+=S*(5*J),A+=L*(5*G),A+=y*(5*H),q+=A>>>13,A&=8191;var O=q;O+=D*H,O+=v*M,O+=m*d,O+=w*c,O+=N*E,q=O>>>13,O&=8191,O+=R*x,O+=B*(5*g),O+=S*(5*X),O+=L*(5*J),O+=y*(5*G),q+=O>>>13,O&=8191;var u=q;u+=D*G,u+=v*H,u+=m*M,u+=w*d,u+=N*c,q=u>>>13,u&=8191,u+=R*E,u+=B*x,u+=S*(5*g),u+=L*(5*X),u+=y*(5*J),q+=u>>>13,u&=8191;var b=q;b+=D*J,b+=v*G,b+=m*H,b+=w*M,b+=N*d,q=b>>>13,b&=8191,b+=R*c,b+=B*E,b+=S*x,b+=L*(5*g),b+=y*(5*X),q+=b>>>13,b&=8191;var K=q;K+=D*X,K+=v*J,K+=m*G,K+=w*H,K+=N*M,q=K>>>13,K&=8191,K+=R*d,K+=B*c,K+=S*E,K+=L*x,K+=y*(5*g),q+=K>>>13,K&=8191;var W=q;W+=D*g,W+=v*X,W+=m*J,W+=w*G,W+=N*H,q=W>>>13,W&=8191,W+=R*M,W+=B*d,W+=S*c,W+=L*E,W+=y*x,q+=W>>>13,W&=8191,q=(q<<2)+q|0,q=q+ee|0,ee=q&8191,q=q>>>13,Y+=q,D=ee,v=Y,m=ae,w=P,N=A,R=O,B=u,S=b,L=K,y=W,f+=16,h-=16}this._h[0]=D,this._h[1]=v,this._h[2]=m,this._h[3]=w,this._h[4]=N,this._h[5]=R,this._h[6]=B,this._h[7]=S,this._h[8]=L,this._h[9]=y},o.prototype.finish=function(a,f){f===void 0&&(f=0);var h=new Uint16Array(10),l,D,v,m;if(this._leftover){for(m=this._leftover,this._buffer[m++]=1;m<16;m++)this._buffer[m]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,m=2;m<10;m++)this._h[m]+=l,l=this._h[m]>>>13,this._h[m]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,h[0]=this._h[0]+5,l=h[0]>>>13,h[0]&=8191,m=1;m<10;m++)h[m]=this._h[m]+l,l=h[m]>>>13,h[m]&=8191;for(h[9]-=1<<13,D=(l^1)-1,m=0;m<10;m++)h[m]&=D;for(D=~D,m=0;m<10;m++)this._h[m]=this._h[m]&D|h[m];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,v=this._h[0]+this._pad[0],this._h[0]=v&65535,m=1;m<8;m++)v=(this._h[m]+this._pad[m]|0)+(v>>>16)|0,this._h[m]=v&65535;return a[f+0]=this._h[0]>>>0,a[f+1]=this._h[0]>>>8,a[f+2]=this._h[1]>>>0,a[f+3]=this._h[1]>>>8,a[f+4]=this._h[2]>>>0,a[f+5]=this._h[2]>>>8,a[f+6]=this._h[3]>>>0,a[f+7]=this._h[3]>>>8,a[f+8]=this._h[4]>>>0,a[f+9]=this._h[4]>>>8,a[f+10]=this._h[5]>>>0,a[f+11]=this._h[5]>>>8,a[f+12]=this._h[6]>>>0,a[f+13]=this._h[6]>>>8,a[f+14]=this._h[7]>>>0,a[f+15]=this._h[7]>>>8,this._finished=!0,this},o.prototype.update=function(a){var f=0,h=a.length,l;if(this._leftover){l=16-this._leftover,l>h&&(l=h);for(var D=0;D<l;D++)this._buffer[this._leftover+D]=a[f+D];if(h-=l,f+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(h>=16&&(l=h-h%16,this._blocks(a,f,l),f+=l,h-=l),h){for(var D=0;D<h;D++)this._buffer[this._leftover+D]=a[f+D];this._leftover+=h}return this},o.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var a=new Uint8Array(16);return this.finish(a),a},o.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},o}();t.Poly1305=n;function i(o,a){var f=new n(o);f.update(a);var h=f.digest();return f.clean(),h}t.oneTimeAuth=i;function s(o,a){return o.length!==t.DIGEST_LENGTH||a.length!==t.DIGEST_LENGTH?!1:e.equal(o,a)}t.equal=s}(Vo),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=yn,r=Vo,n=vt,i=re,s=Ht;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var o=new Uint8Array(16),a=function(){function f(h){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,h.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(h)}return f.prototype.seal=function(h,l,D,v){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var m=new Uint8Array(16);m.set(h,m.length-h.length);var w=new Uint8Array(32);e.stream(this._key,m,w,4);var N=l.length+this.tagLength,R;if(v){if(v.length!==N)throw new Error("ChaCha20Poly1305: incorrect destination length");R=v}else R=new Uint8Array(N);return e.streamXOR(this._key,m,l,R,4),this._authenticate(R.subarray(R.length-this.tagLength,R.length),w,R.subarray(0,R.length-this.tagLength),D),n.wipe(m),R},f.prototype.open=function(h,l,D,v){if(h.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var m=new Uint8Array(16);m.set(h,m.length-h.length);var w=new Uint8Array(32);e.stream(this._key,m,w,4);var N=new Uint8Array(this.tagLength);if(this._authenticate(N,w,l.subarray(0,l.length-this.tagLength),D),!s.equal(N,l.subarray(l.length-this.tagLength,l.length)))return null;var R=l.length-this.tagLength,B;if(v){if(v.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");B=v}else B=new Uint8Array(R);return e.streamXOR(this._key,m,l.subarray(0,l.length-this.tagLength),B,4),n.wipe(m),B},f.prototype.clean=function(){return n.wipe(this._key),this},f.prototype._authenticate=function(h,l,D,v){var m=new r.Poly1305(l);v&&(m.update(v),v.length%16>0&&m.update(o.subarray(v.length%16))),m.update(D),D.length%16>0&&m.update(o.subarray(D.length%16));var w=new Uint8Array(8);v&&i.writeUint64LE(v.length,w),m.update(w),i.writeUint64LE(D.length,w),m.update(w);for(var N=m.digest(),R=0;R<N.length;R++)h[R]=N[R];m.clean(),n.wipe(N),n.wipe(w)},f}();t.ChaCha20Poly1305=a}(wi);var Wo={},zr={},Di={};Object.defineProperty(Di,"__esModule",{value:!0});function mp(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Di.isSerializableHash=mp,Object.defineProperty(zr,"__esModule",{value:!0});var Lt=Di,wp=Ht,Ep=vt,ko=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),Lt.isSerializableHash(this._inner)&&Lt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Ep.wipe(n)}return t.prototype.reset=function(){if(!Lt.isSerializableHash(this._inner)||!Lt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Lt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Lt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Lt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Lt.isSerializableHash(this._inner)||!Lt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Lt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();zr.HMAC=ko;function Dp(t,e,r){var n=new ko(t,e);n.update(r);var i=n.digest();return n.clean(),i}zr.hmac=Dp,zr.equal=wp.equal,Object.defineProperty(Wo,"__esModule",{value:!0});var Yo=zr,Jo=vt,xp=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=Yo.hmac(this._hash,n,r);this._hmac=new Yo.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),Jo.wipe(this._buffer),Jo.wipe(this._counter),this._bufpos=0},t}(),Sp=Wo.HKDF=xp,vn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=re,r=vt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var n=function(){function a(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return a.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},a.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},a.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},a.prototype.update=function(f,h){if(h===void 0&&(h=f.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=h,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&h>0;)this._buffer[this._bufferLength++]=f[l++],h--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(h>=this.blockSize&&(l=s(this._temp,this._state,f,l,h),h%=this.blockSize);h>0;)this._buffer[this._bufferLength++]=f[l++],h--;return this},a.prototype.finish=function(f){if(!this._finished){var h=this._bytesHashed,l=this._bufferLength,D=h/536870912|0,v=h<<3,m=h%64<56?64:128;this._buffer[l]=128;for(var w=l+1;w<m-8;w++)this._buffer[w]=0;e.writeUint32BE(D,this._buffer,m-8),e.writeUint32BE(v,this._buffer,m-4),s(this._temp,this._state,this._buffer,0,m),this._finished=!0}for(var w=0;w<this.digestLength/4;w++)e.writeUint32BE(this._state[w],f,w*4);return this},a.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},a.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},a.prototype.restoreState=function(f){return this._state.set(f.state),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},a.prototype.cleanSavedState=function(f){r.wipe(f.state),f.buffer&&r.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},a}();t.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(a,f,h,l,D){for(;D>=64;){for(var v=f[0],m=f[1],w=f[2],N=f[3],R=f[4],B=f[5],S=f[6],L=f[7],y=0;y<16;y++){var x=l+y*4;a[y]=e.readUint32BE(h,x)}for(var y=16;y<64;y++){var E=a[y-2],c=(E>>>17|E<<32-17)^(E>>>19|E<<32-19)^E>>>10;E=a[y-15];var d=(E>>>7|E<<32-7)^(E>>>18|E<<32-18)^E>>>3;a[y]=(c+a[y-7]|0)+(d+a[y-16]|0)}for(var y=0;y<64;y++){var c=(((R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7))+(R&B^~R&S)|0)+(L+(i[y]+a[y]|0)|0)|0,d=((v>>>2|v<<32-2)^(v>>>13|v<<32-13)^(v>>>22|v<<32-22))+(v&m^v&w^m&w)|0;L=S,S=B,B=R,R=N+c|0,N=w,w=m,m=v,v=c+d|0}f[0]+=v,f[1]+=m,f[2]+=w,f[3]+=N,f[4]+=R,f[5]+=B,f[6]+=S,f[7]+=L,l+=64,D-=64}return l}function o(a){var f=new n;f.update(a);var h=f.digest();return f.clean(),h}t.hash=o})(vn);var xi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.sharedKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.scalarMultBase=t.scalarMult=t.SHARED_KEY_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=void 0;const e=gr,r=vt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function n(y){const x=new Float64Array(16);if(y)for(let E=0;E<y.length;E++)x[E]=y[E];return x}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function o(y){let x=1;for(let E=0;E<16;E++){let c=y[E]+x+65535;x=Math.floor(c/65536),y[E]=c-x*65536}y[0]+=x-1+37*(x-1)}function a(y,x,E){const c=~(E-1);for(let d=0;d<16;d++){const M=c&(y[d]^x[d]);y[d]^=M,x[d]^=M}}function f(y,x){const E=n(),c=n();for(let d=0;d<16;d++)c[d]=x[d];o(c),o(c),o(c);for(let d=0;d<2;d++){E[0]=c[0]-65517;for(let H=1;H<15;H++)E[H]=c[H]-65535-(E[H-1]>>16&1),E[H-1]&=65535;E[15]=c[15]-32767-(E[14]>>16&1);const M=E[15]>>16&1;E[14]&=65535,a(c,E,1-M)}for(let d=0;d<16;d++)y[2*d]=c[d]&255,y[2*d+1]=c[d]>>8}function h(y,x){for(let E=0;E<16;E++)y[E]=x[2*E]+(x[2*E+1]<<8);y[15]&=32767}function l(y,x,E){for(let c=0;c<16;c++)y[c]=x[c]+E[c]}function D(y,x,E){for(let c=0;c<16;c++)y[c]=x[c]-E[c]}function v(y,x,E){let c,d,M=0,H=0,G=0,J=0,X=0,g=0,_=0,F=0,U=0,C=0,T=0,j=0,z=0,Q=0,q=0,ee=0,Y=0,ae=0,P=0,A=0,O=0,u=0,b=0,K=0,W=0,he=0,ve=0,de=0,me=0,je=0,Ne=0,ye=E[0],pe=E[1],le=E[2],ue=E[3],ce=E[4],oe=E[5],se=E[6],te=E[7],fe=E[8],ge=E[9],ne=E[10],_e=E[11],be=E[12],Ee=E[13],De=E[14],we=E[15];c=x[0],M+=c*ye,H+=c*pe,G+=c*le,J+=c*ue,X+=c*ce,g+=c*oe,_+=c*se,F+=c*te,U+=c*fe,C+=c*ge,T+=c*ne,j+=c*_e,z+=c*be,Q+=c*Ee,q+=c*De,ee+=c*we,c=x[1],H+=c*ye,G+=c*pe,J+=c*le,X+=c*ue,g+=c*ce,_+=c*oe,F+=c*se,U+=c*te,C+=c*fe,T+=c*ge,j+=c*ne,z+=c*_e,Q+=c*be,q+=c*Ee,ee+=c*De,Y+=c*we,c=x[2],G+=c*ye,J+=c*pe,X+=c*le,g+=c*ue,_+=c*ce,F+=c*oe,U+=c*se,C+=c*te,T+=c*fe,j+=c*ge,z+=c*ne,Q+=c*_e,q+=c*be,ee+=c*Ee,Y+=c*De,ae+=c*we,c=x[3],J+=c*ye,X+=c*pe,g+=c*le,_+=c*ue,F+=c*ce,U+=c*oe,C+=c*se,T+=c*te,j+=c*fe,z+=c*ge,Q+=c*ne,q+=c*_e,ee+=c*be,Y+=c*Ee,ae+=c*De,P+=c*we,c=x[4],X+=c*ye,g+=c*pe,_+=c*le,F+=c*ue,U+=c*ce,C+=c*oe,T+=c*se,j+=c*te,z+=c*fe,Q+=c*ge,q+=c*ne,ee+=c*_e,Y+=c*be,ae+=c*Ee,P+=c*De,A+=c*we,c=x[5],g+=c*ye,_+=c*pe,F+=c*le,U+=c*ue,C+=c*ce,T+=c*oe,j+=c*se,z+=c*te,Q+=c*fe,q+=c*ge,ee+=c*ne,Y+=c*_e,ae+=c*be,P+=c*Ee,A+=c*De,O+=c*we,c=x[6],_+=c*ye,F+=c*pe,U+=c*le,C+=c*ue,T+=c*ce,j+=c*oe,z+=c*se,Q+=c*te,q+=c*fe,ee+=c*ge,Y+=c*ne,ae+=c*_e,P+=c*be,A+=c*Ee,O+=c*De,u+=c*we,c=x[7],F+=c*ye,U+=c*pe,C+=c*le,T+=c*ue,j+=c*ce,z+=c*oe,Q+=c*se,q+=c*te,ee+=c*fe,Y+=c*ge,ae+=c*ne,P+=c*_e,A+=c*be,O+=c*Ee,u+=c*De,b+=c*we,c=x[8],U+=c*ye,C+=c*pe,T+=c*le,j+=c*ue,z+=c*ce,Q+=c*oe,q+=c*se,ee+=c*te,Y+=c*fe,ae+=c*ge,P+=c*ne,A+=c*_e,O+=c*be,u+=c*Ee,b+=c*De,K+=c*we,c=x[9],C+=c*ye,T+=c*pe,j+=c*le,z+=c*ue,Q+=c*ce,q+=c*oe,ee+=c*se,Y+=c*te,ae+=c*fe,P+=c*ge,A+=c*ne,O+=c*_e,u+=c*be,b+=c*Ee,K+=c*De,W+=c*we,c=x[10],T+=c*ye,j+=c*pe,z+=c*le,Q+=c*ue,q+=c*ce,ee+=c*oe,Y+=c*se,ae+=c*te,P+=c*fe,A+=c*ge,O+=c*ne,u+=c*_e,b+=c*be,K+=c*Ee,W+=c*De,he+=c*we,c=x[11],j+=c*ye,z+=c*pe,Q+=c*le,q+=c*ue,ee+=c*ce,Y+=c*oe,ae+=c*se,P+=c*te,A+=c*fe,O+=c*ge,u+=c*ne,b+=c*_e,K+=c*be,W+=c*Ee,he+=c*De,ve+=c*we,c=x[12],z+=c*ye,Q+=c*pe,q+=c*le,ee+=c*ue,Y+=c*ce,ae+=c*oe,P+=c*se,A+=c*te,O+=c*fe,u+=c*ge,b+=c*ne,K+=c*_e,W+=c*be,he+=c*Ee,ve+=c*De,de+=c*we,c=x[13],Q+=c*ye,q+=c*pe,ee+=c*le,Y+=c*ue,ae+=c*ce,P+=c*oe,A+=c*se,O+=c*te,u+=c*fe,b+=c*ge,K+=c*ne,W+=c*_e,he+=c*be,ve+=c*Ee,de+=c*De,me+=c*we,c=x[14],q+=c*ye,ee+=c*pe,Y+=c*le,ae+=c*ue,P+=c*ce,A+=c*oe,O+=c*se,u+=c*te,b+=c*fe,K+=c*ge,W+=c*ne,he+=c*_e,ve+=c*be,de+=c*Ee,me+=c*De,je+=c*we,c=x[15],ee+=c*ye,Y+=c*pe,ae+=c*le,P+=c*ue,A+=c*ce,O+=c*oe,u+=c*se,b+=c*te,K+=c*fe,W+=c*ge,he+=c*ne,ve+=c*_e,de+=c*be,me+=c*Ee,je+=c*De,Ne+=c*we,M+=38*Y,H+=38*ae,G+=38*P,J+=38*A,X+=38*O,g+=38*u,_+=38*b,F+=38*K,U+=38*W,C+=38*he,T+=38*ve,j+=38*de,z+=38*me,Q+=38*je,q+=38*Ne,d=1,c=M+d+65535,d=Math.floor(c/65536),M=c-d*65536,c=H+d+65535,d=Math.floor(c/65536),H=c-d*65536,c=G+d+65535,d=Math.floor(c/65536),G=c-d*65536,c=J+d+65535,d=Math.floor(c/65536),J=c-d*65536,c=X+d+65535,d=Math.floor(c/65536),X=c-d*65536,c=g+d+65535,d=Math.floor(c/65536),g=c-d*65536,c=_+d+65535,d=Math.floor(c/65536),_=c-d*65536,c=F+d+65535,d=Math.floor(c/65536),F=c-d*65536,c=U+d+65535,d=Math.floor(c/65536),U=c-d*65536,c=C+d+65535,d=Math.floor(c/65536),C=c-d*65536,c=T+d+65535,d=Math.floor(c/65536),T=c-d*65536,c=j+d+65535,d=Math.floor(c/65536),j=c-d*65536,c=z+d+65535,d=Math.floor(c/65536),z=c-d*65536,c=Q+d+65535,d=Math.floor(c/65536),Q=c-d*65536,c=q+d+65535,d=Math.floor(c/65536),q=c-d*65536,c=ee+d+65535,d=Math.floor(c/65536),ee=c-d*65536,M+=d-1+37*(d-1),d=1,c=M+d+65535,d=Math.floor(c/65536),M=c-d*65536,c=H+d+65535,d=Math.floor(c/65536),H=c-d*65536,c=G+d+65535,d=Math.floor(c/65536),G=c-d*65536,c=J+d+65535,d=Math.floor(c/65536),J=c-d*65536,c=X+d+65535,d=Math.floor(c/65536),X=c-d*65536,c=g+d+65535,d=Math.floor(c/65536),g=c-d*65536,c=_+d+65535,d=Math.floor(c/65536),_=c-d*65536,c=F+d+65535,d=Math.floor(c/65536),F=c-d*65536,c=U+d+65535,d=Math.floor(c/65536),U=c-d*65536,c=C+d+65535,d=Math.floor(c/65536),C=c-d*65536,c=T+d+65535,d=Math.floor(c/65536),T=c-d*65536,c=j+d+65535,d=Math.floor(c/65536),j=c-d*65536,c=z+d+65535,d=Math.floor(c/65536),z=c-d*65536,c=Q+d+65535,d=Math.floor(c/65536),Q=c-d*65536,c=q+d+65535,d=Math.floor(c/65536),q=c-d*65536,c=ee+d+65535,d=Math.floor(c/65536),ee=c-d*65536,M+=d-1+37*(d-1),y[0]=M,y[1]=H,y[2]=G,y[3]=J,y[4]=X,y[5]=g,y[6]=_,y[7]=F,y[8]=U,y[9]=C,y[10]=T,y[11]=j,y[12]=z,y[13]=Q,y[14]=q,y[15]=ee}function m(y,x){v(y,x,x)}function w(y,x){const E=n();for(let c=0;c<16;c++)E[c]=x[c];for(let c=253;c>=0;c--)m(E,E),c!==2&&c!==4&&v(E,E,x);for(let c=0;c<16;c++)y[c]=E[c]}function N(y,x){const E=new Uint8Array(32),c=new Float64Array(80),d=n(),M=n(),H=n(),G=n(),J=n(),X=n();for(let U=0;U<31;U++)E[U]=y[U];E[31]=y[31]&127|64,E[0]&=248,h(c,x);for(let U=0;U<16;U++)M[U]=c[U];d[0]=G[0]=1;for(let U=254;U>=0;--U){const C=E[U>>>3]>>>(U&7)&1;a(d,M,C),a(H,G,C),l(J,d,H),D(d,d,H),l(H,M,G),D(M,M,G),m(G,J),m(X,d),v(d,H,d),v(H,M,J),l(J,d,H),D(d,d,H),m(M,d),D(H,G,X),v(d,H,s),l(d,d,G),v(H,H,d),v(d,G,X),v(G,M,c),m(M,J),a(d,M,C),a(H,G,C)}for(let U=0;U<16;U++)c[U+16]=d[U],c[U+32]=H[U],c[U+48]=M[U],c[U+64]=G[U];const g=c.subarray(32),_=c.subarray(16);w(g,g),v(_,_,g);const F=new Uint8Array(32);return f(F,_),F}t.scalarMult=N;function R(y){return N(y,i)}t.scalarMultBase=R;function B(y){if(y.length!==t.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${t.SECRET_KEY_LENGTH} bytes`);const x=new Uint8Array(y);return{publicKey:R(x),secretKey:x}}t.generateKeyPairFromSeed=B;function S(y){const x=(0,e.randomBytes)(32,y),E=B(x);return(0,r.wipe)(x),E}t.generateKeyPair=S;function L(y,x,E=!1){if(y.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(x.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const c=N(y,x);if(E){let d=0;for(let M=0;M<c.length;M++)d|=c[M];if(d===0)throw new Error("X25519: invalid shared key")}return c}t.sharedKey=L})(xi);var Xo=function(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Op=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),Ip=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),Lp=function(){function t(e,r,n,i){this.name=e,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return t}(),Ap=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),Pp=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),Tp=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Rp=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Zo=3,Cp=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Tp]],Qo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Np(t){return t?ea(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Pp:typeof navigator<"u"?ea(navigator.userAgent):Up()}function $p(t){return t!==""&&Cp.reduce(function(e,r){var n=r[0],i=r[1];if(e)return e;var s=i.exec(t);return!!s&&[n,s]},!1)}function ea(t){var e=$p(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new Ap;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<Zo&&(i=Xo(Xo([],i,!0),Mp(Zo-i.length),!0)):i=[];var s=i.join("."),o=Fp(t),a=Rp.exec(t);return a&&a[1]?new Lp(r,s,o,a[1]):new Op(r,s,o)}function Fp(t){for(var e=0,r=Qo.length;e<r;e++){var n=Qo[e],i=n[0],s=n[1],o=s.exec(t);if(o)return i}return null}function Up(){var t=typeof process<"u"&&process.version;return t?new Ip(process.version.slice(1)):null}function Mp(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.getLocalStorage=Pe.getLocalStorageOrThrow=Pe.getCrypto=Pe.getCryptoOrThrow=ra=Pe.getLocation=Pe.getLocationOrThrow=Si=Pe.getNavigator=Pe.getNavigatorOrThrow=ta=Pe.getDocument=Pe.getDocumentOrThrow=Pe.getFromWindowOrThrow=Pe.getFromWindow=void 0;function rr(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Pe.getFromWindow=rr;function yr(t){const e=rr(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Pe.getFromWindowOrThrow=yr;function jp(){return yr("document")}Pe.getDocumentOrThrow=jp;function Bp(){return rr("document")}var ta=Pe.getDocument=Bp;function zp(){return yr("navigator")}Pe.getNavigatorOrThrow=zp;function Hp(){return rr("navigator")}var Si=Pe.getNavigator=Hp;function qp(){return yr("location")}Pe.getLocationOrThrow=qp;function Kp(){return rr("location")}var ra=Pe.getLocation=Kp;function Vp(){return yr("crypto")}Pe.getCryptoOrThrow=Vp;function Gp(){return rr("crypto")}Pe.getCrypto=Gp;function Wp(){return yr("localStorage")}Pe.getLocalStorageOrThrow=Wp;function kp(){return rr("localStorage")}Pe.getLocalStorage=kp;var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0});var na=Oi.getWindowMetadata=void 0;const ia=Pe;function Yp(){let t,e;try{t=ia.getDocumentOrThrow(),e=ia.getLocationOrThrow()}catch{return null}function r(){const D=t.getElementsByTagName("link"),v=[];for(let m=0;m<D.length;m++){const w=D[m],N=w.getAttribute("rel");if(N&&N.toLowerCase().indexOf("icon")>-1){const R=w.getAttribute("href");if(R)if(R.toLowerCase().indexOf("https:")===-1&&R.toLowerCase().indexOf("http:")===-1&&R.indexOf("//")!==0){let B=e.protocol+"//"+e.host;if(R.indexOf("/")===0)B+=R;else{const S=e.pathname.split("/");S.pop();const L=S.join("/");B+=L+"/"+R}v.push(B)}else if(R.indexOf("//")===0){const B=e.protocol+R;v.push(B)}else v.push(R)}}return v}function n(...D){const v=t.getElementsByTagName("meta");for(let m=0;m<v.length;m++){const w=v[m],N=["itemprop","property","name"].map(R=>w.getAttribute(R)).filter(R=>R?D.includes(R):!1);if(N.length&&N){const R=w.getAttribute("content");if(R)return R}}return""}function i(){let D=n("name","og:site_name","og:title","twitter:title");return D||(D=t.title),D}function s(){return n("description","og:description","twitter:description","keywords")}const o=i(),a=s(),f=e.origin,h=r();return{description:a,url:f,icons:h,name:o}}na=Oi.getWindowMetadata=Yp;var Hr={},Jp=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),sa="%[a-f0-9]{2}",oa=new RegExp(sa,"gi"),aa=new RegExp("("+sa+")+","gi");function Ii(t,e){try{return decodeURIComponent(t.join(""))}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],Ii(r),Ii(n))}function Xp(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(oa),r=1;r<e.length;r++)t=Ii(e,r).join(""),e=t.match(oa);return t}}function Zp(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=aa.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var n=Xp(r[0]);n!==r[0]&&(e[r[0]]=n)}r=aa.exec(t)}e["%C2"]="\uFFFD";for(var i=Object.keys(e),s=0;s<i.length;s++){var o=i[s];t=t.replace(new RegExp(o,"g"),e[o])}return t}var Qp=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Zp(t)}},eg=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]},tg=function(t,e){for(var r={},n=Object.keys(t),i=Array.isArray(e),s=0;s<n.length;s++){var o=n[s],a=t[o];(i?e.indexOf(o)!==-1:e(o,a,t))&&(r[o]=a)}return r};(function(t){const e=Jp,r=Qp,n=eg,i=tg,s=S=>S==null,o=Symbol("encodeFragmentIdentifier");function a(S){switch(S.arrayFormat){case"index":return L=>(y,x)=>{const E=y.length;return x===void 0||S.skipNull&&x===null||S.skipEmptyString&&x===""?y:x===null?[...y,[l(L,S),"[",E,"]"].join("")]:[...y,[l(L,S),"[",l(E,S),"]=",l(x,S)].join("")]};case"bracket":return L=>(y,x)=>x===void 0||S.skipNull&&x===null||S.skipEmptyString&&x===""?y:x===null?[...y,[l(L,S),"[]"].join("")]:[...y,[l(L,S),"[]=",l(x,S)].join("")];case"colon-list-separator":return L=>(y,x)=>x===void 0||S.skipNull&&x===null||S.skipEmptyString&&x===""?y:x===null?[...y,[l(L,S),":list="].join("")]:[...y,[l(L,S),":list=",l(x,S)].join("")];case"comma":case"separator":case"bracket-separator":{const L=S.arrayFormat==="bracket-separator"?"[]=":"=";return y=>(x,E)=>E===void 0||S.skipNull&&E===null||S.skipEmptyString&&E===""?x:(E=E===null?"":E,x.length===0?[[l(y,S),L,l(E,S)].join("")]:[[x,l(E,S)].join(S.arrayFormatSeparator)])}default:return L=>(y,x)=>x===void 0||S.skipNull&&x===null||S.skipEmptyString&&x===""?y:x===null?[...y,l(L,S)]:[...y,[l(L,S),"=",l(x,S)].join("")]}}function f(S){let L;switch(S.arrayFormat){case"index":return(y,x,E)=>{if(L=/\[(\d*)\]$/.exec(y),y=y.replace(/\[\d*\]$/,""),!L){E[y]=x;return}E[y]===void 0&&(E[y]={}),E[y][L[1]]=x};case"bracket":return(y,x,E)=>{if(L=/(\[\])$/.exec(y),y=y.replace(/\[\]$/,""),!L){E[y]=x;return}if(E[y]===void 0){E[y]=[x];return}E[y]=[].concat(E[y],x)};case"colon-list-separator":return(y,x,E)=>{if(L=/(:list)$/.exec(y),y=y.replace(/:list$/,""),!L){E[y]=x;return}if(E[y]===void 0){E[y]=[x];return}E[y]=[].concat(E[y],x)};case"comma":case"separator":return(y,x,E)=>{const c=typeof x=="string"&&x.includes(S.arrayFormatSeparator),d=typeof x=="string"&&!c&&D(x,S).includes(S.arrayFormatSeparator);x=d?D(x,S):x;const M=c||d?x.split(S.arrayFormatSeparator).map(H=>D(H,S)):x===null?x:D(x,S);E[y]=M};case"bracket-separator":return(y,x,E)=>{const c=/(\[\])$/.test(y);if(y=y.replace(/\[\]$/,""),!c){E[y]=x&&D(x,S);return}const d=x===null?[]:x.split(S.arrayFormatSeparator).map(M=>D(M,S));if(E[y]===void 0){E[y]=d;return}E[y]=[].concat(E[y],d)};default:return(y,x,E)=>{if(E[y]===void 0){E[y]=x;return}E[y]=[].concat(E[y],x)}}}function h(S){if(typeof S!="string"||S.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(S,L){return L.encode?L.strict?e(S):encodeURIComponent(S):S}function D(S,L){return L.decode?r(S):S}function v(S){return Array.isArray(S)?S.sort():typeof S=="object"?v(Object.keys(S)).sort((L,y)=>Number(L)-Number(y)).map(L=>S[L]):S}function m(S){const L=S.indexOf("#");return L!==-1&&(S=S.slice(0,L)),S}function w(S){let L="";const y=S.indexOf("#");return y!==-1&&(L=S.slice(y)),L}function N(S){S=m(S);const L=S.indexOf("?");return L===-1?"":S.slice(L+1)}function R(S,L){return L.parseNumbers&&!Number.isNaN(Number(S))&&typeof S=="string"&&S.trim()!==""?S=Number(S):L.parseBooleans&&S!==null&&(S.toLowerCase()==="true"||S.toLowerCase()==="false")&&(S=S.toLowerCase()==="true"),S}function B(S,L){L=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},L),h(L.arrayFormatSeparator);const y=f(L),x=Object.create(null);if(typeof S!="string"||(S=S.trim().replace(/^[?#&]/,""),!S))return x;for(const E of S.split("&")){if(E==="")continue;let[c,d]=n(L.decode?E.replace(/\+/g," "):E,"=");d=d===void 0?null:["comma","separator","bracket-separator"].includes(L.arrayFormat)?d:D(d,L),y(D(c,L),d,x)}for(const E of Object.keys(x)){const c=x[E];if(typeof c=="object"&&c!==null)for(const d of Object.keys(c))c[d]=R(c[d],L);else x[E]=R(c,L)}return L.sort===!1?x:(L.sort===!0?Object.keys(x).sort():Object.keys(x).sort(L.sort)).reduce((E,c)=>{const d=x[c];return Boolean(d)&&typeof d=="object"&&!Array.isArray(d)?E[c]=v(d):E[c]=d,E},Object.create(null))}t.extract=N,t.parse=B,t.stringify=(S,L)=>{if(!S)return"";L=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},L),h(L.arrayFormatSeparator);const y=d=>L.skipNull&&s(S[d])||L.skipEmptyString&&S[d]==="",x=a(L),E={};for(const d of Object.keys(S))y(d)||(E[d]=S[d]);const c=Object.keys(E);return L.sort!==!1&&c.sort(L.sort),c.map(d=>{const M=S[d];return M===void 0?"":M===null?l(d,L):Array.isArray(M)?M.length===0&&L.arrayFormat==="bracket-separator"?l(d,L)+"[]":M.reduce(x(d),[]).join("&"):l(d,L)+"="+l(M,L)}).filter(d=>d.length>0).join("&")},t.parseUrl=(S,L)=>{L=Object.assign({decode:!0},L);const[y,x]=n(S,"#");return Object.assign({url:y.split("?")[0]||"",query:B(N(S),L)},L&&L.parseFragmentIdentifier&&x?{fragmentIdentifier:D(x,L)}:{})},t.stringifyUrl=(S,L)=>{L=Object.assign({encode:!0,strict:!0,[o]:!0},L);const y=m(S.url).split("?")[0]||"",x=t.extract(S.url),E=t.parse(x,{sort:!1}),c=Object.assign(E,S.query);let d=t.stringify(c,L);d&&(d=`?${d}`);let M=w(S.url);return S.fragmentIdentifier&&(M=`#${L[o]?l(S.fragmentIdentifier,L):S.fragmentIdentifier}`),`${y}${d}${M}`},t.pick=(S,L,y)=>{y=Object.assign({parseFragmentIdentifier:!0,[o]:!1},y);const{url:x,query:E,fragmentIdentifier:c}=t.parseUrl(S,y);return t.stringifyUrl({url:x,query:i(E,L),fragmentIdentifier:c},y)},t.exclude=(S,L,y)=>{const x=Array.isArray(L)?E=>!L.includes(E):(E,c)=>!L(E,c);return t.pick(S,x,y)}})(Hr);const rg={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},ca="base10",pt="base16",Li="base64pad",Ai="utf8",ua=0,nr=1,ng=0,fa=1,Pi=12,Ti=32;function ig(){const t=xi.generateKeyPair();return{privateKey:lt(t.secretKey,pt),publicKey:lt(t.publicKey,pt)}}function Ri(){const t=gr.randomBytes(Ti);return lt(t,pt)}function sg(t,e){const r=xi.sharedKey(dt(t,pt),dt(e,pt)),n=new Sp(vn.SHA256,r).expand(Ti);return lt(n,pt)}function og(t){const e=vn.hash(dt(t,pt));return lt(e,pt)}function Ci(t){const e=vn.hash(dt(t,Ai));return lt(e,pt)}function ag(t){return dt(`${t}`,ca)}function qr(t){return Number(lt(t,ca))}function cg(t){const e=ag(typeof t.type<"u"?t.type:ua);if(qr(e)===nr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?dt(t.senderPublicKey,pt):void 0,n=typeof t.iv<"u"?dt(t.iv,pt):gr.randomBytes(Pi),i=new wi.ChaCha20Poly1305(dt(t.symKey,pt)).seal(n,dt(t.message,Ai));return fg({type:e,sealed:i,iv:n,senderPublicKey:r})}function ug(t){const e=new wi.ChaCha20Poly1305(dt(t.symKey,pt)),{sealed:r,iv:n}=Ni(t.encoded),i=e.open(n,r);if(i===null)throw new Error("Failed to decrypt");return lt(i,Ai)}function fg(t){if(qr(t.type)===nr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return lt(vi([t.type,t.senderPublicKey,t.iv,t.sealed]),Li)}return lt(vi([t.type,t.iv,t.sealed]),Li)}function Ni(t){const e=dt(t,Li),r=e.slice(ng,fa),n=fa;if(qr(r)===nr){const a=n+Ti,f=a+Pi,h=e.slice(n,a),l=e.slice(a,f),D=e.slice(f);return{type:r,sealed:D,iv:l,senderPublicKey:h}}const i=n+Pi,s=e.slice(n,i),o=e.slice(i);return{type:r,sealed:o,iv:s}}function hg(t,e){const r=Ni(t);return ha({type:qr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?lt(r.senderPublicKey,pt):void 0,receiverPublicKey:e?.receiverPublicKey})}function ha(t){const e=t?.type||ua;if(e===nr){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function la(t){return t.type===nr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var lg=Object.defineProperty,da=Object.getOwnPropertySymbols,dg=Object.prototype.hasOwnProperty,pg=Object.prototype.propertyIsEnumerable,pa=(t,e,r)=>e in t?lg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ga=(t,e)=>{for(var r in e||(e={}))dg.call(e,r)&&pa(t,r,e[r]);if(da)for(var r of da(e))pg.call(e,r)&&pa(t,r,e[r]);return t};const gg="ReactNative",Kr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},yg="js";function ya(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function vg(){return!ta()&&!!Si()&&navigator.product===gg}function _g(){return!ya()&&!!Si()}function bg(){return vg()?Kr.reactNative:ya()?Kr.node:_g()?Kr.browser:Kr.unknown}function mg(t,e){let r=Hr.parse(t);return r=ga(ga({},r),e),t=Hr.stringify(r),t}function wg(){return na()||{name:"",description:"",url:"",icons:[""]}}function Eg(){const t=Np();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Dg(){var t;const e=bg();return e===Kr.browser?[e,((t=ra())==null?void 0:t.host)||"unknown"].join(":"):e}function xg(t,e,r){const n=Eg(),i=Dg();return[[t,e].join("-"),[yg,r].join("-"),n,i].join("/")}function Sg({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const o=r.split("?"),a=xg(t,e,n),f={auth:i,ua:a,projectId:s},h=mg(o[1]||"",f);return o[0]+"?"+h}function gt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function va(t){return Object.fromEntries(t.entries())}function _a(t){return new Map(Object.entries(t))}function At(t,e){return Z.fromMiliseconds((e||Date.now())+Z.toMiliseconds(t))}function qt(t){return Z.fromMiliseconds(Date.now())>=Z.toMiliseconds(t)}function ir(t){const e=Z.toMiliseconds(t||Z.FIVE_MINUTES);let r,n,i;return{resolve:s=>{i&&r&&(clearTimeout(i),r(s))},reject:s=>{i&&n&&(clearTimeout(i),n(s))},done:()=>new Promise((s,o)=>{i=setTimeout(o,e),r=s,n=o})}}function ba(t,e){return new Promise(async(r,n)=>{const i=setTimeout(()=>n(),e),s=await t;clearTimeout(i),r(s)})}function ma(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function Og(t){return ma("topic",t)}function Ig(t){return ma("id",t)}function wa(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function Me(t,e){return`${t}${e?`:${e}`:""}`}const Lg="irn";function $i(t){return t?.relay||{protocol:Lg}}function Fi(t){const e=rg[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var Ag=Object.defineProperty,Ea=Object.getOwnPropertySymbols,Pg=Object.prototype.hasOwnProperty,Tg=Object.prototype.propertyIsEnumerable,Da=(t,e,r)=>e in t?Ag(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rg=(t,e)=>{for(var r in e||(e={}))Pg.call(e,r)&&Da(t,r,e[r]);if(Ea)for(var r of Ea(e))Tg.call(e,r)&&Da(t,r,e[r]);return t};function Cg(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=t[i];r[s]=o}}),r}function Ng(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),i=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",o=Hr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:o.symKey,relay:Cg(o)}}function $g(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(i=>{const s=r+e+i;t[i]&&(n[s]=t[i])}),n}function Fg(t){return`${t.protocol}:${t.topic}@${t.version}?`+Hr.stringify(Rg({symKey:t.symKey},$g(t.relay)))}function Pt(t){const e=[];return t.forEach(r=>{const[n,i]=r.split(":");e.push(`${n}:${i}`)}),e}function Ug(t){const e=[];return Object.values(t).forEach(r=>{e.push(...Pt(r.accounts)),r.extension&&r.extension.forEach(n=>{e.push(...Pt(n.accounts))})}),e}function Mg(t,e){const r=[];return Object.values(t).forEach(n=>{Pt(n.accounts).includes(e)&&r.push(...n.methods),n.extension&&n.extension.forEach(i=>{Pt(i.accounts).includes(e)&&r.push(...i.methods)})}),r}function jg(t,e){const r=[];return Object.values(t).forEach(n=>{Pt(n.accounts).includes(e)&&r.push(...n.events),n.extension&&n.extension.forEach(i=>{Pt(i.accounts).includes(e)&&r.push(...i.events)})}),r}function Bg(t,e){const r=bn(t,e);if(r)throw new Error(r.message);const n={};for(const[i,s]of Object.entries(t))n[i]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return n}const zg={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Hg={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:n}=Hg[t];return{message:e?`${r} ${e}`:r,code:n}}function Be(t,e){const{message:r,code:n}=zg[t];return{message:e?`${r} ${e}`:r,code:n}}function vr(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function _n(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function _t(t){return typeof t>"u"}function it(t,e){return e&&_t(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function Ui(t,e){return e&&_t(t)?!0:typeof t=="number"&&!isNaN(t)}function qg(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),i=Object.keys(r);let s=!0;return gt(i,n)?(n.forEach(o=>{const{accounts:a,methods:f,events:h,extension:l}=t.namespaces[o],D=Pt(a),v=r[o];(!gt(v.chains,D)||!gt(v.methods,f)||!gt(v.events,h))&&(s=!1),s&&l&&l.forEach(m=>{var w;const{accounts:N,methods:R,events:B}=m,S=Pt(N);(w=v.extension)!=null&&w.find(L=>gt(L.chains,S)&&gt(L.methods,R)&&gt(L.events,B))||(s=!1)})}),s):!1}function Mi(t){return it(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Kg(t){if(it(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&Mi(r)}}return!1}function Vg(t){if(it(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function Gg(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Wg(t){return t?.topic}function kg(t,e){let r=null;return it(t?.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function ji(t,e){let r=null;return _t(t?.extension)||(!vr(t.extension)||!t.extension.length)&&(r=V("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function xa(t){let e=!0;return vr(t)?t.length&&(e=t.every(r=>it(r,!1))):e=!1,e}function Sa(t,e,r){let n=null;return vr(e)?e.forEach(i=>{n||(!Mi(i)||!i.includes(t))&&(n=Be("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Be("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),n}function Yg(t,e){let r=null;return Object.entries(t).forEach(([n,i])=>{if(r)return;const s=Sa(n,i?.chains,`${e} requiredNamespace`),o=ji(i,e);s?r=s:o?r=o:i.extension&&i.extension.forEach(a=>{if(r)return;const f=Sa(n,a.chains,`${e} extension`);f&&(r=f)})}),r}function Oa(t,e){let r=null;return vr(t)?t.forEach(n=>{r||Kg(n)||(r=Be("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Be("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Jg(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Oa(n?.accounts,`${e} namespace`),s=ji(n,e);i?r=i:s?r=s:n.extension&&n.extension.forEach(o=>{if(r)return;const a=Oa(o.accounts,`${e} extension`);a&&(r=a)})}),r}function Ia(t,e){let r=null;return xa(t?.methods)?xa(t?.events)||(r=Be("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Be("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function La(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const i=Ia(n,`${e}, namespace`),s=ji(n,e);i?r=i:s?r=s:n.extension&&n.extension.forEach(o=>{if(r)return;const a=Ia(o,`${e}, extension`);a&&(r=a)})}),r}function Xg(t,e){let r=null;if(t&&_n(t)){const n=La(t,e);n&&(r=n);const i=Yg(t,e);i&&(r=i)}else r=V("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function bn(t,e){let r=null;if(t&&_n(t)){const n=La(t,e);n&&(r=n);const i=Jg(t,e);i&&(r=i)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function Aa(t){return it(t.protocol,!0)}function Zg(t,e){let r=!1;return e&&!t?r=!0:t&&vr(t)&&t.length&&t.forEach(n=>{r=Aa(n)}),r}function Qg(t){return typeof t=="number"}function yt(t){return typeof t<"u"&&typeof t!==null}function ey(t){return!(!t||typeof t!="object"||!t.code||!Ui(t.code,!1)||!t.message||!it(t.message,!1))}function ty(t){return!(_t(t)||!it(t.method,!1))}function ry(t){return!(_t(t)||_t(t.result)&&_t(t.error)||!Ui(t.id,!1)||!it(t.jsonrpc,!1))}function ny(t){return!(_t(t)||!it(t.name,!1))}function Pa(t,e){return!(!Mi(e)||!Ug(t).includes(e))}function iy(t,e,r){return it(r,!1)?Mg(t,e).includes(r):!1}function sy(t,e,r){return it(r,!1)?jg(t,e).includes(r):!1}function Ta(t,e,r){let n=null;const i=Object.keys(t),s=Object.keys(e);return gt(i,s)?i.forEach(o=>{var a;if(n)return;const f=t[o].chains,h=Pt(e[o].accounts);gt(f,h)?gt(t[o].methods,e[o].methods)?gt(t[o].events,e[o].events)?t[o].extension&&!e[o].extension?n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${o}`):t[o].extension&&e[o].extension&&((a=t[o].extension)==null||a.forEach(({methods:l,events:D,chains:v})=>{var m;n||(m=e[o].extension)!=null&&m.find(w=>{const N=Pt(w.accounts);return gt(v,N)&&gt(D,w.events)&&gt(l,w.methods)})||(n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${o}`))})):n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${o}`):n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${o}`):n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${o}`)}):n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),n}function oy(t,e){return Ui(t,!1)&&t<=e.max&&t>=e.min}const ay="PARSE_ERROR",cy="INVALID_REQUEST",uy="METHOD_NOT_FOUND",fy="INVALID_PARAMS",Ra="INTERNAL_ERROR",Bi="SERVER_ERROR",hy=[-32700,-32600,-32601,-32602,-32603],Vr={[ay]:{code:-32700,message:"Parse error"},[cy]:{code:-32600,message:"Invalid Request"},[uy]:{code:-32601,message:"Method not found"},[fy]:{code:-32602,message:"Invalid params"},[Ra]:{code:-32603,message:"Internal error"},[Bi]:{code:-32e3,message:"Server error"}},Ca=Bi;function ly(t){return hy.includes(t)}function Na(t){return Object.keys(Vr).includes(t)?Vr[t]:Vr[Ca]}function dy(t){const e=Object.values(Vr).find(r=>r.code===t);return e||Vr[Ca]}function $a(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Fa={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var zi=function(t,e){return zi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},zi(t,e)};function py(t,e){zi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Hi=function(){return Hi=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Hi.apply(this,arguments)};function gy(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function yy(t,e,r,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(i<3?o(s):i>3?o(e,r,s):o(e,r))||s);return i>3&&s&&Object.defineProperty(e,r,s),s}function vy(t,e){return function(r,n){e(r,n,t)}}function _y(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function by(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(l){try{h(n.next(l))}catch(D){o(D)}}function f(l){try{h(n.throw(l))}catch(D){o(D)}}function h(l){l.done?s(l.value):i(l.value).then(a,f)}h((n=n.apply(t,e||[])).next())})}function my(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(h){return function(l){return f([h,l])}}function f(h){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return r.label++,{value:h[1],done:!1};case 5:r.label++,i=h[1],h=[0];continue;case 7:h=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){r=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){r.label=h[1];break}if(h[0]===6&&r.label<s[1]){r.label=s[1],s=h;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(h);break}s[2]&&r.ops.pop(),r.trys.pop();continue}h=e.call(t,r)}catch(l){h=[6,l],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}function wy(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function Ey(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function qi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ua(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(a){o={error:a}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Dy(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ua(arguments[e]));return t}function xy(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),i=0,e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function Gr(t){return this instanceof Gr?(this.v=t,this):new Gr(t)}function Sy(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(v){n[v]&&(i[v]=function(m){return new Promise(function(w,N){s.push([v,m,w,N])>1||a(v,m)})})}function a(v,m){try{f(n[v](m))}catch(w){D(s[0][3],w)}}function f(v){v.value instanceof Gr?Promise.resolve(v.value.v).then(h,l):D(s[0][2],v)}function h(v){a("next",v)}function l(v){a("throw",v)}function D(v,m){v(m),s.shift(),s.length&&a(s[0][0],s[0][1])}}function Oy(t){var e,r;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=t[i]?function(o){return(r=!r)?{value:Gr(t[i](o)),done:i==="return"}:s?s(o):o}:s}}function Iy(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof qi=="function"?qi(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(a,f){o=t[s](o),i(a,f,o.done,o.value)})}}function i(s,o,a,f){Promise.resolve(f).then(function(h){s({value:h,done:a})},o)}}function Ly(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Ay(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function Py(t){return t&&t.__esModule?t:{default:t}}function Ty(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Ry(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Cy=Object.freeze({__proto__:null,__extends:py,get __assign(){return Hi},__rest:gy,__decorate:yy,__param:vy,__metadata:_y,__awaiter:by,__generator:my,__createBinding:wy,__exportStar:Ey,__values:qi,__read:Ua,__spread:Dy,__spreadArrays:xy,__await:Gr,__asyncGenerator:Sy,__asyncDelegator:Oy,__asyncValues:Iy,__makeTemplateObject:Ly,__importStar:Ay,__importDefault:Py,__classPrivateFieldGet:Ty,__classPrivateFieldSet:Ry}),Ny=Jt(Cy),Ft={},Ma;function $y(){if(Ma)return Ft;Ma=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.isBrowserCryptoAvailable=Ft.getSubtleCrypto=Ft.getBrowerCrypto=void 0;function t(){return We?.crypto||We?.msCrypto||{}}Ft.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}Ft.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return Ft.isBrowserCryptoAvailable=r,Ft}var Ut={},ja;function Fy(){if(ja)return Ut;ja=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.isBrowser=Ut.isNode=Ut.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Ut.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Ut.isNode=e;function r(){return!t()&&!e()}return Ut.isBrowser=r,Ut}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Ny;e.__exportStar($y(),t),e.__exportStar(Fy(),t)})(Fa);function Uy(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function mn(t,e,r){return{id:r||Uy(),jsonrpc:"2.0",method:t,params:e}}function Ki(t,e){return{id:t,jsonrpc:"2.0",result:e}}function wn(t,e,r){return{id:t,jsonrpc:"2.0",error:My(e,r)}}function My(t,e){return typeof t>"u"?Na(Ra):(typeof t=="string"&&(t=Object.assign(Object.assign({},Na(Bi)),{message:t})),typeof e<"u"&&(t.data=e),ly(t.code)&&(t=dy(t.code)),t)}class jy{}class By extends jy{constructor(){super()}}class zy extends By{constructor(e){super()}}const Hy="^https?:",qy="^wss?:";function Ky(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Ba(t,e){const r=Ky(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function za(t){return Ba(t,Hy)}function Ha(t){return Ba(t,qy)}function Vy(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function qa(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Vi(t){return qa(t)&&"method"in t}function Gi(t){return qa(t)&&(Mt(t)||xt(t))}function Mt(t){return"result"in t}function xt(t){return"error"in t}class Wi extends zy{constructor(e){super(e),this.events=new Zn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(mn(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${e.id}`,s=>{xt(s)?i(s.error):n(s.result)});try{await this.connection.send(e,r)}catch(s){i(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Gi(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}var ki={exports:{}},_r=typeof Reflect=="object"?Reflect:null,Ka=_r&&typeof _r.apply=="function"?_r.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},En;_r&&typeof _r.ownKeys=="function"?En=_r.ownKeys:Object.getOwnPropertySymbols?En=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:En=function(e){return Object.getOwnPropertyNames(e)};function Gy(t){console&&console.warn&&console.warn(t)}var Va=Number.isNaN||function(e){return e!==e};function Ie(){Ie.init.call(this)}ki.exports=Ie,ki.exports.once=Jy,Ie.EventEmitter=Ie,Ie.prototype._events=void 0,Ie.prototype._eventsCount=0,Ie.prototype._maxListeners=void 0;var Ga=10;function Dn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ie,"defaultMaxListeners",{enumerable:!0,get:function(){return Ga},set:function(t){if(typeof t!="number"||t<0||Va(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Ga=t}}),Ie.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ie.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Va(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Wa(t){return t._maxListeners===void 0?Ie.defaultMaxListeners:t._maxListeners}Ie.prototype.getMaxListeners=function(){return Wa(this)},Ie.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")Ka(f,this,r);else for(var h=f.length,l=Za(f,h),n=0;n<h;++n)Ka(l[n],this,r);return!0};function ka(t,e,r,n){var i,s,o;if(Dn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Wa(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Gy(a)}return t}Ie.prototype.addListener=function(e,r){return ka(this,e,r,!1)},Ie.prototype.on=Ie.prototype.addListener,Ie.prototype.prependListener=function(e,r){return ka(this,e,r,!0)};function Wy(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Ya(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Wy.bind(n);return i.listener=r,n.wrapFn=i,i}Ie.prototype.once=function(e,r){return Dn(r),this.on(e,Ya(this,e,r)),this},Ie.prototype.prependOnceListener=function(e,r){return Dn(r),this.prependListener(e,Ya(this,e,r)),this},Ie.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Dn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():ky(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Ie.prototype.off=Ie.prototype.removeListener,Ie.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Ja(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?Yy(i):Za(i,i.length)}Ie.prototype.listeners=function(e){return Ja(this,e,!0)},Ie.prototype.rawListeners=function(e){return Ja(this,e,!1)},Ie.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Xa.call(t,e)},Ie.prototype.listenerCount=Xa;function Xa(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ie.prototype.eventNames=function(){return this._eventsCount>0?En(this._events):[]};function Za(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function ky(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Yy(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function Jy(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Qa(t,e,s,{once:!0}),e!=="error"&&Xy(t,i,{once:!0})})}function Xy(t,e,r){typeof t.on=="function"&&Qa(t,"error",e,r)}function Qa(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const ec=10,Zy=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),Qy=()=>typeof window<"u",e0=Zy();class t0{constructor(e){if(this.url=e,this.events=new ki.exports.EventEmitter,this.registering=!1,!Ha(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(jr(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!Ha(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const i=Fa.isReactNative()?void 0:{rejectUnauthorized:!Vy(e)},s=new e0(e,[],i);Qy()?s.onerror=o=>{const a=o;n(this.emitError(a.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?hi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=wn(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return $a(e,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ec&&this.events.setMaxListeners(ec)}emitError(e){const r=this.parseError(new Error(e?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Yi={exports:{}};(function(t,e){var r=200,n="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,a="[object Arguments]",f="[object Array]",h="[object AsyncFunction]",l="[object Boolean]",D="[object Date]",v="[object Error]",m="[object Function]",w="[object GeneratorFunction]",N="[object Map]",R="[object Number]",B="[object Null]",S="[object Object]",L="[object Promise]",y="[object Proxy]",x="[object RegExp]",E="[object Set]",c="[object String]",d="[object Symbol]",M="[object Undefined]",H="[object WeakMap]",G="[object ArrayBuffer]",J="[object DataView]",X="[object Float32Array]",g="[object Float64Array]",_="[object Int8Array]",F="[object Int16Array]",U="[object Int32Array]",C="[object Uint8Array]",T="[object Uint8ClampedArray]",j="[object Uint16Array]",z="[object Uint32Array]",Q=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,ee=/^(?:0|[1-9]\d*)$/,Y={};Y[X]=Y[g]=Y[_]=Y[F]=Y[U]=Y[C]=Y[T]=Y[j]=Y[z]=!0,Y[a]=Y[f]=Y[G]=Y[l]=Y[J]=Y[D]=Y[v]=Y[m]=Y[N]=Y[R]=Y[S]=Y[x]=Y[E]=Y[c]=Y[H]=!1;var ae=typeof We=="object"&&We&&We.Object===Object&&We,P=typeof self=="object"&&self&&self.Object===Object&&self,A=ae||P||Function("return this")(),O=e&&!e.nodeType&&e,u=O&&!0&&t&&!t.nodeType&&t,b=u&&u.exports===O,K=b&&ae.process,W=function(){try{return K&&K.binding&&K.binding("util")}catch{}}(),he=W&&W.isTypedArray;function ve(p,I){for(var $=-1,k=p==null?0:p.length,Te=0,ie=[];++$<k;){var Ue=p[$];I(Ue,$,p)&&(ie[Te++]=Ue)}return ie}function de(p,I){for(var $=-1,k=I.length,Te=p.length;++$<k;)p[Te+$]=I[$];return p}function me(p,I){for(var $=-1,k=p==null?0:p.length;++$<k;)if(I(p[$],$,p))return!0;return!1}function je(p,I){for(var $=-1,k=Array(p);++$<p;)k[$]=I($);return k}function Ne(p){return function(I){return p(I)}}function ye(p,I){return p.has(I)}function pe(p,I){return p?.[I]}function le(p){var I=-1,$=Array(p.size);return p.forEach(function(k,Te){$[++I]=[Te,k]}),$}function ue(p,I){return function($){return p(I($))}}function ce(p){var I=-1,$=Array(p.size);return p.forEach(function(k){$[++I]=k}),$}var oe=Array.prototype,se=Function.prototype,te=Object.prototype,fe=A["__core-js_shared__"],ge=se.toString,ne=te.hasOwnProperty,_e=function(){var p=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),be=te.toString,Ee=RegExp("^"+ge.call(ne).replace(Q,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=b?A.Buffer:void 0,we=A.Symbol,St=A.Uint8Array,Ct=te.propertyIsEnumerable,Vt=oe.splice,bt=we?we.toStringTag:void 0,sr=Object.getOwnPropertySymbols,Jr=De?De.isBuffer:void 0,Fn=ue(Object.keys,Object),ze=wr(A,"DataView"),$e=wr(A,"Map"),He=wr(A,"Promise"),qe=wr(A,"Set"),Ke=wr(A,"WeakMap"),Fe=wr(Object,"create"),Ye=ar(ze),Je=ar($e),Xe=ar(He),Ze=ar(qe),Qe=ar(Ke),Ge=we?we.prototype:void 0,Ve=Ge?Ge.valueOf:void 0;function Re(p){var I=-1,$=p==null?0:p.length;for(this.clear();++I<$;){var k=p[I];this.set(k[0],k[1])}}function et(){this.__data__=Fe?Fe(null):{},this.size=0}function tt(p){var I=this.has(p)&&delete this.__data__[p];return this.size-=I?1:0,I}function hb(p){var I=this.__data__;if(Fe){var $=I[p];return $===n?void 0:$}return ne.call(I,p)?I[p]:void 0}function lb(p){var I=this.__data__;return Fe?I[p]!==void 0:ne.call(I,p)}function db(p,I){var $=this.__data__;return this.size+=this.has(p)?0:1,$[p]=Fe&&I===void 0?n:I,this}Re.prototype.clear=et,Re.prototype.delete=tt,Re.prototype.get=hb,Re.prototype.has=lb,Re.prototype.set=db;function Bt(p){var I=-1,$=p==null?0:p.length;for(this.clear();++I<$;){var k=p[I];this.set(k[0],k[1])}}function pb(){this.__data__=[],this.size=0}function gb(p){var I=this.__data__,$=Mn(I,p);if($<0)return!1;var k=I.length-1;return $==k?I.pop():Vt.call(I,$,1),--this.size,!0}function yb(p){var I=this.__data__,$=Mn(I,p);return $<0?void 0:I[$][1]}function vb(p){return Mn(this.__data__,p)>-1}function _b(p,I){var $=this.__data__,k=Mn($,p);return k<0?(++this.size,$.push([p,I])):$[k][1]=I,this}Bt.prototype.clear=pb,Bt.prototype.delete=gb,Bt.prototype.get=yb,Bt.prototype.has=vb,Bt.prototype.set=_b;function or(p){var I=-1,$=p==null?0:p.length;for(this.clear();++I<$;){var k=p[I];this.set(k[0],k[1])}}function bb(){this.size=0,this.__data__={hash:new Re,map:new($e||Bt),string:new Re}}function mb(p){var I=jn(this,p).delete(p);return this.size-=I?1:0,I}function wb(p){return jn(this,p).get(p)}function Eb(p){return jn(this,p).has(p)}function Db(p,I){var $=jn(this,p),k=$.size;return $.set(p,I),this.size+=$.size==k?0:1,this}or.prototype.clear=bb,or.prototype.delete=mb,or.prototype.get=wb,or.prototype.has=Eb,or.prototype.set=Db;function Un(p){var I=-1,$=p==null?0:p.length;for(this.__data__=new or;++I<$;)this.add(p[I])}function xb(p){return this.__data__.set(p,n),this}function Sb(p){return this.__data__.has(p)}Un.prototype.add=Un.prototype.push=xb,Un.prototype.has=Sb;function Gt(p){var I=this.__data__=new Bt(p);this.size=I.size}function Ob(){this.__data__=new Bt,this.size=0}function Ib(p){var I=this.__data__,$=I.delete(p);return this.size=I.size,$}function Lb(p){return this.__data__.get(p)}function Ab(p){return this.__data__.has(p)}function Pb(p,I){var $=this.__data__;if($ instanceof Bt){var k=$.__data__;if(!$e||k.length<r-1)return k.push([p,I]),this.size=++$.size,this;$=this.__data__=new or(k)}return $.set(p,I),this.size=$.size,this}Gt.prototype.clear=Ob,Gt.prototype.delete=Ib,Gt.prototype.get=Lb,Gt.prototype.has=Ab,Gt.prototype.set=Pb;function Tb(p,I){var $=Bn(p),k=!$&&Gb(p),Te=!$&&!k&&us(p),ie=!$&&!k&&!Te&&wu(p),Ue=$||k||Te||ie,rt=Ue?je(p.length,String):[],ot=rt.length;for(var Ce in p)(I||ne.call(p,Ce))&&!(Ue&&(Ce=="length"||Te&&(Ce=="offset"||Ce=="parent")||ie&&(Ce=="buffer"||Ce=="byteLength"||Ce=="byteOffset")||zb(Ce,ot)))&&rt.push(Ce);return rt}function Mn(p,I){for(var $=p.length;$--;)if(vu(p[$][0],I))return $;return-1}function Rb(p,I,$){var k=I(p);return Bn(p)?k:de(k,$(p))}function Xr(p){return p==null?p===void 0?M:B:bt&&bt in Object(p)?jb(p):Vb(p)}function du(p){return Zr(p)&&Xr(p)==a}function pu(p,I,$,k,Te){return p===I?!0:p==null||I==null||!Zr(p)&&!Zr(I)?p!==p&&I!==I:Cb(p,I,$,k,pu,Te)}function Cb(p,I,$,k,Te,ie){var Ue=Bn(p),rt=Bn(I),ot=Ue?f:Wt(p),Ce=rt?f:Wt(I);ot=ot==a?S:ot,Ce=Ce==a?S:Ce;var mt=ot==S,Ot=Ce==S,ct=ot==Ce;if(ct&&us(p)){if(!us(I))return!1;Ue=!0,mt=!1}if(ct&&!mt)return ie||(ie=new Gt),Ue||wu(p)?gu(p,I,$,k,Te,ie):Ub(p,I,ot,$,k,Te,ie);if(!($&i)){var Et=mt&&ne.call(p,"__wrapped__"),Dt=Ot&&ne.call(I,"__wrapped__");if(Et||Dt){var kt=Et?p.value():p,zt=Dt?I.value():I;return ie||(ie=new Gt),Te(kt,zt,$,k,ie)}}return ct?(ie||(ie=new Gt),Mb(p,I,$,k,Te,ie)):!1}function Nb(p){if(!mu(p)||qb(p))return!1;var I=_u(p)?Ee:q;return I.test(ar(p))}function $b(p){return Zr(p)&&bu(p.length)&&!!Y[Xr(p)]}function Fb(p){if(!Kb(p))return Fn(p);var I=[];for(var $ in Object(p))ne.call(p,$)&&$!="constructor"&&I.push($);return I}function gu(p,I,$,k,Te,ie){var Ue=$&i,rt=p.length,ot=I.length;if(rt!=ot&&!(Ue&&ot>rt))return!1;var Ce=ie.get(p);if(Ce&&ie.get(I))return Ce==I;var mt=-1,Ot=!0,ct=$&s?new Un:void 0;for(ie.set(p,I),ie.set(I,p);++mt<rt;){var Et=p[mt],Dt=I[mt];if(k)var kt=Ue?k(Dt,Et,mt,I,p,ie):k(Et,Dt,mt,p,I,ie);if(kt!==void 0){if(kt)continue;Ot=!1;break}if(ct){if(!me(I,function(zt,cr){if(!ye(ct,cr)&&(Et===zt||Te(Et,zt,$,k,ie)))return ct.push(cr)})){Ot=!1;break}}else if(!(Et===Dt||Te(Et,Dt,$,k,ie))){Ot=!1;break}}return ie.delete(p),ie.delete(I),Ot}function Ub(p,I,$,k,Te,ie,Ue){switch($){case J:if(p.byteLength!=I.byteLength||p.byteOffset!=I.byteOffset)return!1;p=p.buffer,I=I.buffer;case G:return!(p.byteLength!=I.byteLength||!ie(new St(p),new St(I)));case l:case D:case R:return vu(+p,+I);case v:return p.name==I.name&&p.message==I.message;case x:case c:return p==I+"";case N:var rt=le;case E:var ot=k&i;if(rt||(rt=ce),p.size!=I.size&&!ot)return!1;var Ce=Ue.get(p);if(Ce)return Ce==I;k|=s,Ue.set(p,I);var mt=gu(rt(p),rt(I),k,Te,ie,Ue);return Ue.delete(p),mt;case d:if(Ve)return Ve.call(p)==Ve.call(I)}return!1}function Mb(p,I,$,k,Te,ie){var Ue=$&i,rt=yu(p),ot=rt.length,Ce=yu(I),mt=Ce.length;if(ot!=mt&&!Ue)return!1;for(var Ot=ot;Ot--;){var ct=rt[Ot];if(!(Ue?ct in I:ne.call(I,ct)))return!1}var Et=ie.get(p);if(Et&&ie.get(I))return Et==I;var Dt=!0;ie.set(p,I),ie.set(I,p);for(var kt=Ue;++Ot<ot;){ct=rt[Ot];var zt=p[ct],cr=I[ct];if(k)var Eu=Ue?k(cr,zt,ct,I,p,ie):k(zt,cr,ct,p,I,ie);if(!(Eu===void 0?zt===cr||Te(zt,cr,$,k,ie):Eu)){Dt=!1;break}kt||(kt=ct=="constructor")}if(Dt&&!kt){var zn=p.constructor,Hn=I.constructor;zn!=Hn&&"constructor"in p&&"constructor"in I&&!(typeof zn=="function"&&zn instanceof zn&&typeof Hn=="function"&&Hn instanceof Hn)&&(Dt=!1)}return ie.delete(p),ie.delete(I),Dt}function yu(p){return Rb(p,Yb,Bb)}function jn(p,I){var $=p.__data__;return Hb(I)?$[typeof I=="string"?"string":"hash"]:$.map}function wr(p,I){var $=pe(p,I);return Nb($)?$:void 0}function jb(p){var I=ne.call(p,bt),$=p[bt];try{p[bt]=void 0;var k=!0}catch{}var Te=be.call(p);return k&&(I?p[bt]=$:delete p[bt]),Te}var Bb=sr?function(p){return p==null?[]:(p=Object(p),ve(sr(p),function(I){return Ct.call(p,I)}))}:Jb,Wt=Xr;(ze&&Wt(new ze(new ArrayBuffer(1)))!=J||$e&&Wt(new $e)!=N||He&&Wt(He.resolve())!=L||qe&&Wt(new qe)!=E||Ke&&Wt(new Ke)!=H)&&(Wt=function(p){var I=Xr(p),$=I==S?p.constructor:void 0,k=$?ar($):"";if(k)switch(k){case Ye:return J;case Je:return N;case Xe:return L;case Ze:return E;case Qe:return H}return I});function zb(p,I){return I=I??o,!!I&&(typeof p=="number"||ee.test(p))&&p>-1&&p%1==0&&p<I}function Hb(p){var I=typeof p;return I=="string"||I=="number"||I=="symbol"||I=="boolean"?p!=="__proto__":p===null}function qb(p){return!!_e&&_e in p}function Kb(p){var I=p&&p.constructor,$=typeof I=="function"&&I.prototype||te;return p===$}function Vb(p){return be.call(p)}function ar(p){if(p!=null){try{return ge.call(p)}catch{}try{return p+""}catch{}}return""}function vu(p,I){return p===I||p!==p&&I!==I}var Gb=du(function(){return arguments}())?du:function(p){return Zr(p)&&ne.call(p,"callee")&&!Ct.call(p,"callee")},Bn=Array.isArray;function Wb(p){return p!=null&&bu(p.length)&&!_u(p)}var us=Jr||Xb;function kb(p,I){return pu(p,I)}function _u(p){if(!mu(p))return!1;var I=Xr(p);return I==m||I==w||I==h||I==y}function bu(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=o}function mu(p){var I=typeof p;return p!=null&&(I=="object"||I=="function")}function Zr(p){return p!=null&&typeof p=="object"}var wu=he?Ne(he):$b;function Yb(p){return Wb(p)?Tb(p):Fb(p)}function Jb(){return[]}function Xb(){return!1}t.exports=kb})(Yi,Yi.exports);var r0=Yi.exports,n0=Object.defineProperty,tc=Object.getOwnPropertySymbols,i0=Object.prototype.hasOwnProperty,s0=Object.prototype.propertyIsEnumerable,rc=(t,e,r)=>e in t?n0(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ft=(t,e)=>{for(var r in e||(e={}))i0.call(e,r)&&rc(t,r,e[r]);if(tc)for(var r of tc(e))s0.call(e,r)&&rc(t,r,e[r]);return t};function o0(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,f=t.charAt(0),h=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function D(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var N=0,R=0,B=0,S=w.length;B!==S&&w[B]===0;)B++,N++;for(var L=(S-B)*l+1>>>0,y=new Uint8Array(L);B!==S;){for(var x=w[B],E=0,c=L-1;(x!==0||E<R)&&c!==-1;c--,E++)x+=256*y[c]>>>0,y[c]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");R=E,B++}for(var d=L-R;d!==L&&y[d]===0;)d++;for(var M=f.repeat(N);d<L;++d)M+=t.charAt(y[d]);return M}function v(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var N=0;if(w[N]!==" "){for(var R=0,B=0;w[N]===f;)R++,N++;for(var S=(w.length-N)*h+1>>>0,L=new Uint8Array(S);w[N];){var y=r[w.charCodeAt(N)];if(y===255)return;for(var x=0,E=S-1;(y!==0||x<B)&&E!==-1;E--,x++)y+=a*L[E]>>>0,L[E]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");B=x,N++}if(w[N]!==" "){for(var c=S-B;c!==S&&L[c]===0;)c++;for(var d=new Uint8Array(R+(S-c)),M=R;c!==S;)d[M++]=L[c++];return d}}}function m(w){var N=v(w);if(N)return N;throw new Error(`Non-${e} character`)}return{encode:D,decodeUnsafe:v,decode:m}}var a0=o0,c0=a0;const nc=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},u0=t=>new TextEncoder().encode(t),f0=t=>new TextDecoder().decode(t);class h0{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class l0{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ic(this,e)}}class d0{constructor(e){this.decoders=e}or(e){return ic(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ic=(t,e)=>new d0(ft(ft({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class p0{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new h0(e,r,n),this.decoder=new l0(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const xn=({name:t,prefix:e,encode:r,decode:n})=>new p0(t,e,r,n),Wr=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=c0(r,e);return xn({prefix:t,name:e,encode:n,decode:s=>nc(i(s))})},g0=(t,e,r,n)=>{const i={};for(let l=0;l<e.length;++l)i[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let a=0,f=0,h=0;for(let l=0;l<s;++l){const D=i[t[l]];if(D===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|D,a+=r,a>=8&&(a-=8,o[h++]=255&f>>a)}if(a>=r||255&f<<8-a)throw new SyntaxError("Unexpected end of data");return o},y0=(t,e,r)=>{const n=e[e.length-1]==="=",i=(1<<r)-1;let s="",o=0,a=0;for(let f=0;f<t.length;++f)for(a=a<<8|t[f],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s},st=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>xn({prefix:e,name:t,encode(i){return y0(i,n,r)},decode(i){return g0(i,n,r,t)}}),v0=xn({prefix:"\0",name:"identity",encode:t=>f0(t),decode:t=>u0(t)});var _0=Object.freeze({__proto__:null,identity:v0});const b0=st({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var m0=Object.freeze({__proto__:null,base2:b0});const w0=st({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var E0=Object.freeze({__proto__:null,base8:w0});const D0=Wr({prefix:"9",name:"base10",alphabet:"0123456789"});var x0=Object.freeze({__proto__:null,base10:D0});const S0=st({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),O0=st({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var I0=Object.freeze({__proto__:null,base16:S0,base16upper:O0});const L0=st({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),A0=st({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),P0=st({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),T0=st({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),R0=st({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),C0=st({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),N0=st({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$0=st({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),F0=st({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var U0=Object.freeze({__proto__:null,base32:L0,base32upper:A0,base32pad:P0,base32padupper:T0,base32hex:R0,base32hexupper:C0,base32hexpad:N0,base32hexpadupper:$0,base32z:F0});const M0=Wr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),j0=Wr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var B0=Object.freeze({__proto__:null,base36:M0,base36upper:j0});const z0=Wr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),H0=Wr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var q0=Object.freeze({__proto__:null,base58btc:z0,base58flickr:H0});const K0=st({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),V0=st({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),G0=st({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),W0=st({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var k0=Object.freeze({__proto__:null,base64:K0,base64pad:V0,base64url:G0,base64urlpad:W0});const sc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Y0=sc.reduce((t,e,r)=>(t[r]=e,t),[]),J0=sc.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function X0(t){return t.reduce((e,r)=>(e+=Y0[r],e),"")}function Z0(t){const e=[];for(const r of t){const n=J0[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const Q0=xn({prefix:"\u{1F680}",name:"base256emoji",encode:X0,decode:Z0});var ev=Object.freeze({__proto__:null,base256emoji:Q0}),tv=ac,oc=128,rv=127,nv=~rv,iv=Math.pow(2,31);function ac(t,e,r){e=e||[],r=r||0;for(var n=r;t>=iv;)e[r++]=t&255|oc,t/=128;for(;t&nv;)e[r++]=t&255|oc,t>>>=7;return e[r]=t|0,ac.bytes=r-n+1,e}var sv=Ji,ov=128,cc=127;function Ji(t,n){var r=0,n=n||0,i=0,s=n,o,a=t.length;do{if(s>=a)throw Ji.bytes=0,new RangeError("Could not decode varint");o=t[s++],r+=i<28?(o&cc)<<i:(o&cc)*Math.pow(2,i),i+=7}while(o>=ov);return Ji.bytes=s-n,r}var av=Math.pow(2,7),cv=Math.pow(2,14),uv=Math.pow(2,21),fv=Math.pow(2,28),hv=Math.pow(2,35),lv=Math.pow(2,42),dv=Math.pow(2,49),pv=Math.pow(2,56),gv=Math.pow(2,63),yv=function(t){return t<av?1:t<cv?2:t<uv?3:t<fv?4:t<hv?5:t<lv?6:t<dv?7:t<pv?8:t<gv?9:10},vv={encode:tv,decode:sv,encodingLength:yv},uc=vv;const fc=(t,e,r=0)=>(uc.encode(t,e,r),e),hc=t=>uc.encodingLength(t),Xi=(t,e)=>{const r=e.byteLength,n=hc(t),i=n+hc(r),s=new Uint8Array(i+r);return fc(t,s,0),fc(r,s,n),s.set(e,i),new _v(t,r,e,s)};class _v{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}const lc=({name:t,code:e,encode:r})=>new bv(t,e,r);class bv{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Xi(this.code,r):r.then(n=>Xi(this.code,n))}else throw Error("Unknown type, must be binary type")}}const dc=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),mv=lc({name:"sha2-256",code:18,encode:dc("SHA-256")}),wv=lc({name:"sha2-512",code:19,encode:dc("SHA-512")});var Ev=Object.freeze({__proto__:null,sha256:mv,sha512:wv});const pc=0,Dv="identity",gc=nc;var xv=Object.freeze({__proto__:null,identity:{code:pc,name:Dv,encode:gc,digest:t=>Xi(pc,gc(t))}});new TextEncoder,new TextDecoder;const yc=ft(ft(ft(ft(ft(ft(ft(ft(ft(ft({},_0),m0),E0),x0),I0),U0),B0),q0),k0),ev);ft(ft({},Ev),xv);function Sv(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function vc(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const _c=vc("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Zi=vc("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Sv(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ov=ft({utf8:_c,"utf-8":_c,hex:yc.base16,latin1:Zi,ascii:Zi,binary:Zi},yc);function Iv(t,e="utf8"){const r=Ov[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}const bc="wc",Lv=2,Qi="core",Kt=`${bc}@${2}:${Qi}:`,Av={name:Qi,logger:"error"},Pv={database:":memory:"},Tv="crypto",mc="client_ed25519_seed",Rv=Z.ONE_DAY,Cv="keychain",Nv="0.3",$v="messages",Fv="0.3",Uv=Z.SIX_HOURS,Mv="publisher",wc="irn",jv="error",Bv="wss://relay.walletconnect.com",zv="relayer",ht={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Hv="_subscription",Sn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Ec=Z.ONE_SECOND,qv="2.2.1",Kv="0.3",Tt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Vv="subscription",Gv="0.3",Wv=Z.FIVE_SECONDS*1e3,kv="pairing",Yv="0.3",kr={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},Rt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Jv="history",Xv="0.3",Zv="expirer",wt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},Qv="0.3";class e_{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=Cv,this.version=Nv,this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=V("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,va(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_a(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class t_{constructor(e,r,n){this.core=e,this.logger=r,this.name=Tv,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=qo(i);return Ho(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=ig();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),o=qo(s),a=Ri();return await lp(a,i,Rv,o)},this.generateSharedKey=(i,s,o)=>{this.isInitialized();const a=this.getPrivateKey(i),f=sg(a,s);return this.setSymKey(f,o)},this.setSymKey=async(i,s)=>{this.isInitialized();const o=s||og(i);return await this.keychain.set(o,i),o},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,o)=>{this.isInitialized();const a=ha(o),f=jr(s);if(la(a)){const v=a.senderPublicKey,m=a.receiverPublicKey;i=await this.generateSharedKey(v,m)}const h=this.getSymKey(i),{type:l,senderPublicKey:D}=a;return cg({type:l,symKey:h,message:f,senderPublicKey:D})},this.decode=async(i,s,o)=>{this.isInitialized();const a=hg(s,o);if(la(a)){const l=a.receiverPublicKey,D=a.senderPublicKey;i=await this.generateSharedKey(l,D)}const f=this.getSymKey(i),h=ug({symKey:f,encoded:s});return hi(h)},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.keychain=n||new e_(this.core,this.logger)}get context(){return xe.getLoggerContext(this.logger)}getPayloadType(e){const r=Ni(e);return qr(r.type)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(mc)}catch{e=Ri(),await this.keychain.set(mc,e)}return Iv(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class r_ extends Yh{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=$v,this.version=Fv,this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=Ci(i);let o=this.messages.get(n);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=i,this.messages.set(n,o),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),o=Ci(i);return typeof s[o]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=xe.generateChildLogger(e,this.name),this.core=r}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,va(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_a(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class n_ extends Jh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new Nt.exports.EventEmitter,this.name=Mv,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const o=s?.ttl||Uv,a=$i(s),f=s?.prompt||!1,h=s?.tag||0,l={topic:n,message:i,opts:{ttl:o,relay:a,prompt:f,tag:h}},D=Ci(i);this.queue.set(D,l);try{await await ba(this.rpcPublish(n,i,o,a,f,h),this.publishTimeout),this.relayer.events.emit(ht.publish,l)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(ht.connection_stalled);return}this.onPublish(D,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return xe.getLoggerContext(this.logger)}rpcPublish(e,r,n,i,s,o){var a,f,h,l;const D={method:Fi(i.protocol).publish,params:{topic:e,message:r,ttl:n,prompt:s,tag:o}};return _t((a=D.params)==null?void 0:a.prompt)&&((f=D.params)==null||delete f.prompt),_t((h=D.params)==null?void 0:h.tag)&&((l=D.params)==null||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:D}),this.relayer.provider.request(D)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:n,opts:i}=e;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class i_{constructor(){this.map=new Map,this.set=(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(e);return}this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var s_=Object.defineProperty,o_=Object.defineProperties,a_=Object.getOwnPropertyDescriptors,Dc=Object.getOwnPropertySymbols,c_=Object.prototype.hasOwnProperty,u_=Object.prototype.propertyIsEnumerable,xc=(t,e,r)=>e in t?s_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,On=(t,e)=>{for(var r in e||(e={}))c_.call(e,r)&&xc(t,r,e[r]);if(Dc)for(var r of Dc(e))u_.call(e,r)&&xc(t,r,e[r]);return t},es=(t,e)=>o_(t,a_(e));class f_ extends Qh{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new i_,this.events=new Nt.exports.EventEmitter,this.name=Vv,this.version=Gv,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Kt,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=$i(i),o={topic:n,relay:s};this.pending.set(n,o);const a=await this.rpcSubscribe(n,s);return this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),a}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const o=new Z.Watch;o.start(this.pendingSubscriptionWatchLabel);const a=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),i(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=Wv&&(clearInterval(a),o.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async i=>await this.unsubscribeById(e,i,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const i=$i(n);await this.rpcUnsubscribe(e,r,i);const s=Be("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(e,r){const n={method:Fi(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await ba(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(ht.connection_stalled)}return i}rpcUnsubscribe(e,r,n){const i={method:Fi(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(e,r){this.setSubscription(e,es(On({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,es(On({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,On({},r)),this.topicMap.set(r.topic,e),this.events.emit(Tt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(Tt.deleted,es(On({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Tt.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async e=>await this.resubscribe(e))),this.events.emit(Tt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:n}=e,i={topic:r,relay:n};this.pending.set(i.topic,i);const s=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(s,i)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(ht.connect,async()=>{await this.onConnect()}),this.relayer.on(ht.disconnect,()=>{this.onDisconnect()}),this.events.on(Tt.created,async e=>{const r=Tt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Tt.deleted,async e=>{const r=Tt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var h_=Object.defineProperty,Sc=Object.getOwnPropertySymbols,l_=Object.prototype.hasOwnProperty,d_=Object.prototype.propertyIsEnumerable,Oc=(t,e,r)=>e in t?h_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,p_=(t,e)=>{for(var r in e||(e={}))l_.call(e,r)&&Oc(t,r,e[r]);if(Sc)for(var r of Sc(e))d_.call(e,r)&&Oc(t,r,e[r]);return t};class g_ extends Xh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Nt.exports.EventEmitter,this.name=zv,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?xe.generateChildLogger(e.logger,this.name):Er(xe.getDefaultLoggerOptions({level:e.logger||jv})),this.messages=new r_(this.logger,e.core),this.subscriber=new f_(this,this.logger),this.publisher=new n_(this,this.logger),this.relayUrl=e?.relayUrl||Bv,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return xe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(Tt.created,s=>{s.topic===e&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(e,r),i()})]),n}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&await this.provider.disconnect(),this.events.emit(ht.transport_closed)}async transportOpen(e){this.relayUrl=e||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Tt.resubscribed,()=>{r()})}),await Promise.race([this.provider.connect(),new Promise((r,n)=>this.once(ht.transport_closed,()=>{n()}))])])}catch(r){const n=r;if(!/socket hang up/i.test(n.message))throw new Error(n.message);this.logger.error(n),this.events.emit(ht.transport_closed)}}async restartTransport(e){await this.transportClose(),await new Promise(r=>setTimeout(r,Ec)),await this.transportOpen(e)}async createProvider(){const e=await this.core.crypto.signJWT(this.relayUrl);return new Wi(new t0(Sg({sdkVersion:qv,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:n}=e;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Vi(e)){if(!e.method.endsWith(Hv))return;const r=e.params,{topic:n,message:i}=r.data,s={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(p_({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(ht.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=Ki(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(Sn.payload,e=>this.onProviderPayload(e)),this.provider.on(Sn.connect,()=>{this.events.emit(ht.connect)}),this.provider.on(Sn.disconnect,()=>{this.events.emit(ht.disconnect),this.attemptToReconnect()}),this.provider.on(Sn.error,e=>this.events.emit(ht.error,e)),this.events.on(ht.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},Z.toMiliseconds(Ec))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var y_=Object.defineProperty,Ic=Object.getOwnPropertySymbols,v_=Object.prototype.hasOwnProperty,__=Object.prototype.propertyIsEnumerable,Lc=(t,e,r)=>e in t?y_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ac=(t,e)=>{for(var r in e||(e={}))v_.call(e,r)&&Lc(t,r,e[r]);if(Ic)for(var r of Ic(e))__.call(e,r)&&Lc(t,r,e[r]);return t};class In extends Zh{constructor(e,r,n,i=Kt,s=void 0){super(e,r,n,i),this.core=e,this.logger=r,this.name=n,this.map=new Map,this.version=Kv,this.cached=[],this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{Gg(o)?this.map.set(o.id,o):Wg(o)?this.map.set(o.topic,o):this.getKey&&o!==null&&!_t(o)&&this.map.set(this.getKey(o),o)}),this.cached=[],this.initialized=!0)},this.set=async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(f=>r0(a[f],o[f]))):this.values),this.update=async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const f=Ac(Ac({},this.getData(o)),a);this.map.set(o,f),await this.persist()},this.delete=async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),await this.persist())},this.logger=xe.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:n}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class b_{constructor(e,r){this.core=e,this.logger=r,this.name=kv,this.version=Yv,this.events=new Nt.exports,this.initialized=!1,this.storagePrefix=Kt,this.ignoredPayloadTypes=[nr],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Ri(),i=await this.core.crypto.setSymKey(n),s=At(Z.FIVE_MINUTES),o={protocol:wc},a={topic:i,expiry:s,relay:o,active:!1},f=Fg({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:o});return await this.pairings.set(i,a),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:f}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:o}=Ng(n.uri),a=At(Z.FIVE_MINUTES),f={topic:i,relay:o,expiry:a,active:!1};return await this.pairings.set(i,f),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:o}),this.core.expirer.set(i,a),n.activatePairing&&await this.activate({topic:i}),f},this.activate=async({topic:n})=>{this.isInitialized();const i=At(Z.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:a,reject:f}=ir();this.events.once(Me("pairing_ping",s),({error:h})=>{h?f(h):a()}),await o()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Be("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const o=mn(i,s),a=await this.core.crypto.encode(n,o),f=kr[i].req;return this.core.history.set(n,o),await this.core.relayer.publish(n,a,f),o.id},this.sendResult=async(n,i,s)=>{const o=Ki(n,s),a=await this.core.crypto.encode(i,o),f=await this.core.history.get(i,n),h=kr[f.request.method].res;await this.core.relayer.publish(i,a,h),await this.core.history.resolve(o)},this.sendError=async(n,i,s)=>{const o=wn(n,s),a=await this.core.crypto.encode(i,o),f=await this.core.history.get(i,n),h=kr[f.request.method]?kr[f.request.method].res:kr.unregistered_method.res;await this.core.relayer.publish(i,a,h),await this.core.history.resolve(o)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Be("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>qt(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,o=s.method;if(this.pairings.keys.includes(i))switch(o){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{Mt(i)?this.events.emit(Me("pairing_ping",s),{}):xt(i)&&this.events.emit(Me("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.sendResult(s,n,!0),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const a=Be("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,a),this.logger.error(a)}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Be("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!yt(n)){const{message:i}=V("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!Vg(n.uri)){const{message:i}=V("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!yt(n)){const{message:s}=V("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!yt(n)){const{message:s}=V("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!it(n,!1)){const{message:i}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if(qt(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=V("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.pairings=new In(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(ht.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Vi(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Gi(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(wt.expired,async e=>{const{topic:r}=wa(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class m_ extends kh{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new Nt.exports.EventEmitter,this.name=Jv,this.version=Xv,this.cached=[],this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(o.id,o),this.events.emit(Rt.created,o)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=xt(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(Rt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(Rt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:mn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Rt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Rt.created,e=>{const r=Rt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Rt.updated,e=>{const r=Rt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(Rt.deleted,e=>{const r=Rt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}class w_ extends el{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new Nt.exports.EventEmitter,this.name=Zv,this.version=Qv,this.cached=[],this.initialized=!1,this.storagePrefix=Kt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(wt.created,{target:s,expiration:o})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(wt.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return Og(e);if(typeof e=="number")return Ig(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(wt.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;Z.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(wt.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Pr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(wt.created,e=>{const r=wt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(wt.expired,e=>{const r=wt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(wt.deleted,e=>{const r=wt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var E_=Object.defineProperty,Pc=Object.getOwnPropertySymbols,D_=Object.prototype.hasOwnProperty,x_=Object.prototype.propertyIsEnumerable,Tc=(t,e,r)=>e in t?E_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rc=(t,e)=>{for(var r in e||(e={}))D_.call(e,r)&&Tc(t,r,e[r]);if(Pc)for(var r of Pc(e))x_.call(e,r)&&Tc(t,r,e[r]);return t};class ts extends Wh{constructor(e){super(e),this.protocol=bc,this.version=Lv,this.name=Qi,this.events=new Nt.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Er(xe.getDefaultLoggerOptions({level:e?.logger||Av.logger}));this.logger=xe.generateChildLogger(r,this.name),this.heartbeat=new Pr.HeartBeat,this.crypto=new t_(this,this.logger,e?.keychain),this.history=new m_(this,this.logger),this.expirer=new w_(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new _f(Rc(Rc({},Pv),e?.storageOptions)),this.relayer=new g_({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId}),this.pairing=new b_(this,this.logger)}static async init(e){const r=new ts(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const S_=ts;var Ln={exports:{}},br=typeof Reflect=="object"?Reflect:null,Cc=br&&typeof br.apply=="function"?br.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},An;br&&typeof br.ownKeys=="function"?An=br.ownKeys:Object.getOwnPropertySymbols?An=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:An=function(e){return Object.getOwnPropertyNames(e)};function O_(t){console&&console.warn&&console.warn(t)}var Nc=Number.isNaN||function(e){return e!==e};function Le(){Le.init.call(this)}Ln.exports=Le,Ln.exports.once=P_,Le.EventEmitter=Le,Le.prototype._events=void 0,Le.prototype._eventsCount=0,Le.prototype._maxListeners=void 0;var $c=10;function Pn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Le,"defaultMaxListeners",{enumerable:!0,get:function(){return $c},set:function(t){if(typeof t!="number"||t<0||Nc(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");$c=t}}),Le.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Le.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Nc(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Fc(t){return t._maxListeners===void 0?Le.defaultMaxListeners:t._maxListeners}Le.prototype.getMaxListeners=function(){return Fc(this)},Le.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")Cc(f,this,r);else for(var h=f.length,l=zc(f,h),n=0;n<h;++n)Cc(l[n],this,r);return!0};function Uc(t,e,r,n){var i,s,o;if(Pn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Fc(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,O_(a)}return t}Le.prototype.addListener=function(e,r){return Uc(this,e,r,!1)},Le.prototype.on=Le.prototype.addListener,Le.prototype.prependListener=function(e,r){return Uc(this,e,r,!0)};function I_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Mc(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=I_.bind(n);return i.listener=r,n.wrapFn=i,i}Le.prototype.once=function(e,r){return Pn(r),this.on(e,Mc(this,e,r)),this},Le.prototype.prependOnceListener=function(e,r){return Pn(r),this.prependListener(e,Mc(this,e,r)),this},Le.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Pn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():L_(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Le.prototype.off=Le.prototype.removeListener,Le.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function jc(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?A_(i):zc(i,i.length)}Le.prototype.listeners=function(e){return jc(this,e,!0)},Le.prototype.rawListeners=function(e){return jc(this,e,!1)},Le.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Bc.call(t,e)},Le.prototype.listenerCount=Bc;function Bc(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Le.prototype.eventNames=function(){return this._eventsCount>0?An(this._events):[]};function zc(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function L_(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function A_(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function P_(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Hc(t,e,s,{once:!0}),e!=="error"&&T_(t,i,{once:!0})})}function T_(t,e,r){typeof t.on=="function"&&Hc(t,"error",e,r)}function Hc(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const qc="wc",Kc=2,Vc="client",rs=`${qc}@${Kc}:${Vc}:`,ns={name:Vc,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},R_="proposal",C_="session",Tn=Z.SEVEN_DAYS,N_="engine",Yr={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}},is={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},$_="request";var F_=Object.defineProperty,U_=Object.defineProperties,M_=Object.getOwnPropertyDescriptors,Gc=Object.getOwnPropertySymbols,j_=Object.prototype.hasOwnProperty,B_=Object.prototype.propertyIsEnumerable,Wc=(t,e,r)=>e in t?F_(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,jt=(t,e)=>{for(var r in e||(e={}))j_.call(e,r)&&Wc(t,r,e[r]);if(Gc)for(var r of Gc(e))B_.call(e,r)&&Wc(t,r,e[r]);return t},ss=(t,e)=>U_(t,M_(e));class z_ extends rl{constructor(e){super(e),this.name=N_,this.events=new Ln.exports,this.initialized=!1,this.ignoredPayloadTypes=[nr],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Yr)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:n,requiredNamespaces:i,relays:s}=r;let o=n,a,f=!1;if(o&&(f=this.client.core.pairing.pairings.get(o).active),!o||!f){const{topic:R,uri:B}=await this.client.core.pairing.create();o=R,a=B}const h=await this.client.core.crypto.generateKeyPair(),l={requiredNamespaces:i,relays:s??[{protocol:wc}],proposer:{publicKey:h,metadata:this.client.metadata}},{reject:D,resolve:v,done:m}=ir();if(this.events.once(Me("session_connect"),async({error:R,session:B})=>{if(R)D(R);else if(B){B.self.publicKey=h;const S=ss(jt({},B),{requiredNamespaces:B.requiredNamespaces});await this.client.session.set(B.topic,S),await this.setExpiry(B.topic,B.expiry),o&&await this.client.core.pairing.updateMetadata({topic:o,metadata:B.peer.metadata}),v(S)}}),!o){const{message:R}=V("NO_MATCHING_KEY",`connect() pairing topic: ${o}`);throw new Error(R)}const w=await this.sendRequest(o,"wc_sessionPropose",l),N=At(Z.FIVE_MINUTES);return await this.setProposal(w,jt({id:w,expiry:N},l)),{uri:a,approval:m}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:i,namespaces:s}=r,o=this.client.proposal.get(n);let{pairingTopic:a,proposer:f,requiredNamespaces:h}=o;_n(h)||(h=Bg(s,"approve()"),this.client.proposal.set(n,ss(jt({},o),{requiredNamespaces:h})));const l=await this.client.core.crypto.generateKeyPair(),D=f.publicKey,v=await this.client.core.crypto.generateSharedKey(l,D),m={relay:{protocol:i??"irn"},namespaces:s,requiredNamespaces:h,controller:{publicKey:l,metadata:this.client.metadata},expiry:At(Tn)};await this.client.core.relayer.subscribe(v);const w=await this.sendRequest(v,"wc_sessionSettle",m),{done:N,resolve:R,reject:B}=ir();this.events.once(Me("session_approve",w),({error:L})=>{L?B(L):R(this.client.session.get(v))});const S=ss(jt({},m),{topic:v,acknowledged:!1,self:m.controller,peer:{publicKey:f.publicKey,metadata:f.metadata},controller:l});return await this.client.session.set(v,S),await this.setExpiry(v,At(Tn)),a&&await this.client.core.pairing.updateMetadata({topic:a,metadata:S.peer.metadata}),a&&n&&(await this.sendResult(n,a,{relay:{protocol:i??"irn"},responderPublicKey:l}),await this.client.proposal.delete(n,Be("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:a})),{topic:v,acknowledged:N}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:i}=r,{pairingTopic:s}=this.client.proposal.get(n);s&&(await this.sendError(n,s,i),await this.client.proposal.delete(n,Be("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:i}=r,s=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:o,resolve:a,reject:f}=ir();return this.events.once(Me("session_update",s),({error:h})=>{h?f(h):a()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:o}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:s,resolve:o,reject:a}=ir();return this.events.once(Me("session_extend",i),({error:f})=>{f?a(f):o()}),await this.setExpiry(n,At(Tn)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:i,topic:s,expiry:o}=r,a=await this.sendRequest(s,"wc_sessionRequest",{request:i,chainId:n},o),{done:f,resolve:h,reject:l}=ir(o);return this.events.once(Me("session_request",a),({error:D,result:v})=>{D?l(D):h(v)}),await f()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:s}=i;Mt(i)?await this.sendResult(s,n,i.result):xt(i)&&await this.sendError(s,n,i.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:s,resolve:o,reject:a}=ir();this.events.once(Me("session_ping",i),({error:f})=>{f?a(f):o()}),await s()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",Be("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>qg(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,n)=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Be("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Be("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Yr.wc_sessionRequest.req.ttl,{id:i,topic:s,params:o}=r;await this.client.pendingRequest.set(i,{id:i,topic:s,params:o}),n&&this.client.core.expirer.set(i,At(n))},this.sendRequest=async(r,n,i,s)=>{const o=mn(n,i),a=await this.client.core.crypto.encode(r,o),f=Yr[n].req;return s&&(f.ttl=s),this.client.core.history.set(r,o),this.client.core.relayer.publish(r,a,f),o.id},this.sendResult=async(r,n,i)=>{const s=Ki(r,i),o=await this.client.core.crypto.encode(n,s),a=await this.client.core.history.get(n,r),f=Yr[a.request.method].res;this.client.core.relayer.publish(n,o,f),await this.client.core.history.resolve(s)},this.sendError=async(r,n,i)=>{const s=wn(r,i),o=await this.client.core.crypto.encode(n,s),a=await this.client.core.history.get(n,r),f=Yr[a.request.method].res;this.client.core.relayer.publish(n,o,f),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{qt(i.expiry)&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{qt(i.expiry)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=r=>{const{topic:n,payload:i}=r,s=i.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:i}=r,s=(await this.client.core.history.get(n,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidConnect(jt({},n.params));const o=At(Z.FIVE_MINUTES),a=jt({id:s,pairingTopic:r,expiry:o},i);await this.setProposal(s,a),this.client.events.emit("session_proposal",{id:s,params:a})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionProposeResponse=async(r,n)=>{const{id:i}=n;if(Mt(n)){const{result:s}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const o=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const a=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});const f=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:f});const h=await this.client.core.crypto.generateSharedKey(a,f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:h});const l=await this.client.core.relayer.subscribe(h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:r})}else xt(n)&&(await this.client.proposal.delete(i,Be("USER_DISCONNECTED")),this.events.emit(Me("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:a,expiry:f,namespaces:h,requiredNamespaces:l}=n.params,D={topic:r,relay:o,expiry:f,namespaces:h,acknowledged:!0,requiredNamespaces:l,controller:a.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}};await this.sendResult(n.id,r,!0),this.events.emit(Me("session_connect"),{session:D})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,n)=>{const{id:i}=n;Mt(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Me("session_approve",i),{})):xt(n)&&(await this.client.session.delete(r,Be("USER_DISCONNECTED")),this.events.emit(Me("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidUpdate(jt({topic:r},i)),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionUpdateResponse=(r,n)=>{const{id:i}=n;Mt(n)?this.events.emit(Me("session_update",i),{}):xt(n)&&this.events.emit(Me("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,At(Tn)),await this.sendResult(i,r,!0),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,n)=>{const{id:i}=n;Mt(n)?this.events.emit(Me("session_extend",i),{}):xt(n)&&this.events.emit(Me("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,n)=>{const{id:i}=n;setTimeout(()=>{Mt(n)?this.events.emit(Me("session_ping",i),{}):xt(n)&&this.events.emit(Me("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await this.sendResult(i,r,!0),await this.deleteSession(r),this.client.events.emit("session_delete",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidRequest(jt({topic:r},s)),await this.setPendingSessionRequest({id:i,topic:r,params:s}),this.client.events.emit("session_request",{id:i,topic:r,params:s})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.onSessionRequestResponse=(r,n)=>{const{id:i}=n;Mt(n)?this.events.emit(Me("session_request",i),{result:n.result}):xt(n)&&this.events.emit(Me("session_request",i),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidEmit(jt({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.isValidConnect=async r=>{if(!yt(r)){const{message:a}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(a)}const{pairingTopic:n,requiredNamespaces:i,relays:s}=r;if(_t(n)||await this.isValidPairingTopic(n),!_t(i)&&_n(i)===0)return;const o=Xg(i,"connect()");if(o)throw new Error(o.message);if(!Zg(s,!0)){const{message:a}=V("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(a)}},this.isValidApprove=async r=>{if(!yt(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s}=r;await this.isValidProposalId(n);const o=this.client.proposal.get(n),a=bn(i,"approve()");if(a)throw new Error(a.message);const f=Ta(o.requiredNamespaces,i,"update()");if(f)throw new Error(f.message);if(!it(s,!0)){const{message:h}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(h)}},this.isValidReject=async r=>{if(!yt(r)){const{message:s}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(await this.isValidProposalId(n),!ey(i)){const{message:s}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!yt(r)){const{message:h}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(h)}const{relay:n,controller:i,namespaces:s,expiry:o}=r;if(!Aa(n)){const{message:h}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(h)}const a=kg(i,"onSessionSettleRequest()");if(a)throw new Error(a.message);const f=bn(s,"onSessionSettleRequest()");if(f)throw new Error(f.message);if(qt(o)){const{message:h}=V("EXPIRED","onSessionSettleRequest()");throw new Error(h)}},this.isValidUpdate=async r=>{if(!yt(r)){const{message:f}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(f)}const{topic:n,namespaces:i}=r;await this.isValidSessionTopic(n);const s=this.client.session.get(n),o=bn(i,"update()");if(o)throw new Error(o.message);const a=Ta(s.requiredNamespaces,i,"update()");if(a)throw new Error(a.message)},this.isValidExtend=async r=>{if(!yt(r)){const{message:i}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!yt(r)){const{message:f}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(f)}const{topic:n,request:i,chainId:s,expiry:o}=r;await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Pa(a,s)){const{message:f}=V("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(f)}if(!ty(i)){const{message:f}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(f)}if(!iy(a,s,i.method)){const{message:f}=V("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(f)}if(o&&!oy(o,is)){const{message:f}=V("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${is.min} and ${is.max}`);throw new Error(f)}},this.isValidRespond=async r=>{if(!yt(r)){const{message:s}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:n,response:i}=r;if(await this.isValidSessionTopic(n),!ry(i)){const{message:s}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!yt(r)){const{message:i}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!yt(r)){const{message:a}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!Pa(o,s)){const{message:a}=V("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(a)}if(!ny(i)){const{message:a}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}if(!sy(o,s,i.name)){const{message:a}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(a)}},this.isValidDisconnect=async r=>{if(!yt(r)){const{message:i}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(ht.message,async e=>{const{topic:r,message:n}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(r,n);Vi(i)?(this.client.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Gi(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(wt.expired,async e=>{const{topic:r,id:n}=wa(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&await this.deleteProposal(n,!0)})}isValidPairingTopic(e){if(!it(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(qt(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!it(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(qt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(it(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Qg(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(qt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class H_ extends In{constructor(e,r){super(e,r,R_,rs),this.core=e,this.logger=r}}class q_ extends In{constructor(e,r){super(e,r,C_,rs),this.core=e,this.logger=r}}class K_ extends In{constructor(e,r){super(e,r,$_,rs),this.core=e,this.logger=r}}class os extends tl{constructor(e){super(e),this.protocol=qc,this.version=Kc,this.name=ns.name,this.events=new Ln.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=e?.name||ns.name,this.metadata=e?.metadata||wg();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Er(xe.getDefaultLoggerOptions({level:e?.logger||ns.logger}));this.core=e?.core||new S_(e),this.logger=xe.generateChildLogger(r,this.name),this.session=new q_(this.core,this.logger),this.proposal=new H_(this.core,this.logger),this.pendingRequest=new K_(this.core,this.logger),this.engine=new z_(this)}static async init(e){const r=new os(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var as={exports:{}};(function(t,e){var r=typeof self<"u"?self:We,n=function(){function s(){this.fetch=!1,this.DOMException=r.DOMException}return s.prototype=r,new s}();(function(s){(function(o){var a={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function f(g){return g&&DataView.prototype.isPrototypeOf(g)}if(a.arrayBuffer)var h=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(g){return g&&h.indexOf(Object.prototype.toString.call(g))>-1};function D(g){if(typeof g!="string"&&(g=String(g)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(g))throw new TypeError("Invalid character in header field name");return g.toLowerCase()}function v(g){return typeof g!="string"&&(g=String(g)),g}function m(g){var _={next:function(){var F=g.shift();return{done:F===void 0,value:F}}};return a.iterable&&(_[Symbol.iterator]=function(){return _}),_}function w(g){this.map={},g instanceof w?g.forEach(function(_,F){this.append(F,_)},this):Array.isArray(g)?g.forEach(function(_){this.append(_[0],_[1])},this):g&&Object.getOwnPropertyNames(g).forEach(function(_){this.append(_,g[_])},this)}w.prototype.append=function(g,_){g=D(g),_=v(_);var F=this.map[g];this.map[g]=F?F+", "+_:_},w.prototype.delete=function(g){delete this.map[D(g)]},w.prototype.get=function(g){return g=D(g),this.has(g)?this.map[g]:null},w.prototype.has=function(g){return this.map.hasOwnProperty(D(g))},w.prototype.set=function(g,_){this.map[D(g)]=v(_)},w.prototype.forEach=function(g,_){for(var F in this.map)this.map.hasOwnProperty(F)&&g.call(_,this.map[F],F,this)},w.prototype.keys=function(){var g=[];return this.forEach(function(_,F){g.push(F)}),m(g)},w.prototype.values=function(){var g=[];return this.forEach(function(_){g.push(_)}),m(g)},w.prototype.entries=function(){var g=[];return this.forEach(function(_,F){g.push([F,_])}),m(g)},a.iterable&&(w.prototype[Symbol.iterator]=w.prototype.entries);function N(g){if(g.bodyUsed)return Promise.reject(new TypeError("Already read"));g.bodyUsed=!0}function R(g){return new Promise(function(_,F){g.onload=function(){_(g.result)},g.onerror=function(){F(g.error)}})}function B(g){var _=new FileReader,F=R(_);return _.readAsArrayBuffer(g),F}function S(g){var _=new FileReader,F=R(_);return _.readAsText(g),F}function L(g){for(var _=new Uint8Array(g),F=new Array(_.length),U=0;U<_.length;U++)F[U]=String.fromCharCode(_[U]);return F.join("")}function y(g){if(g.slice)return g.slice(0);var _=new Uint8Array(g.byteLength);return _.set(new Uint8Array(g)),_.buffer}function x(){return this.bodyUsed=!1,this._initBody=function(g){this._bodyInit=g,g?typeof g=="string"?this._bodyText=g:a.blob&&Blob.prototype.isPrototypeOf(g)?this._bodyBlob=g:a.formData&&FormData.prototype.isPrototypeOf(g)?this._bodyFormData=g:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(g)?this._bodyText=g.toString():a.arrayBuffer&&a.blob&&f(g)?(this._bodyArrayBuffer=y(g.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(g)||l(g))?this._bodyArrayBuffer=y(g):this._bodyText=g=Object.prototype.toString.call(g):this._bodyText="",this.headers.get("content-type")||(typeof g=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(g)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var g=N(this);if(g)return g;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?N(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(B)}),this.text=function(){var g=N(this);if(g)return g;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(L(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(M)}),this.json=function(){return this.text().then(JSON.parse)},this}var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(g){var _=g.toUpperCase();return E.indexOf(_)>-1?_:g}function d(g,_){_=_||{};var F=_.body;if(g instanceof d){if(g.bodyUsed)throw new TypeError("Already read");this.url=g.url,this.credentials=g.credentials,_.headers||(this.headers=new w(g.headers)),this.method=g.method,this.mode=g.mode,this.signal=g.signal,!F&&g._bodyInit!=null&&(F=g._bodyInit,g.bodyUsed=!0)}else this.url=String(g);if(this.credentials=_.credentials||this.credentials||"same-origin",(_.headers||!this.headers)&&(this.headers=new w(_.headers)),this.method=c(_.method||this.method||"GET"),this.mode=_.mode||this.mode||null,this.signal=_.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&F)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(F)}d.prototype.clone=function(){return new d(this,{body:this._bodyInit})};function M(g){var _=new FormData;return g.trim().split("&").forEach(function(F){if(F){var U=F.split("="),C=U.shift().replace(/\+/g," "),T=U.join("=").replace(/\+/g," ");_.append(decodeURIComponent(C),decodeURIComponent(T))}}),_}function H(g){var _=new w,F=g.replace(/\r?\n[\t ]+/g," ");return F.split(/\r?\n/).forEach(function(U){var C=U.split(":"),T=C.shift().trim();if(T){var j=C.join(":").trim();_.append(T,j)}}),_}x.call(d.prototype);function G(g,_){_||(_={}),this.type="default",this.status=_.status===void 0?200:_.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in _?_.statusText:"OK",this.headers=new w(_.headers),this.url=_.url||"",this._initBody(g)}x.call(G.prototype),G.prototype.clone=function(){return new G(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new w(this.headers),url:this.url})},G.error=function(){var g=new G(null,{status:0,statusText:""});return g.type="error",g};var J=[301,302,303,307,308];G.redirect=function(g,_){if(J.indexOf(_)===-1)throw new RangeError("Invalid status code");return new G(null,{status:_,headers:{location:g}})},o.DOMException=s.DOMException;try{new o.DOMException}catch{o.DOMException=function(_,F){this.message=_,this.name=F;var U=Error(_);this.stack=U.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function X(g,_){return new Promise(function(F,U){var C=new d(g,_);if(C.signal&&C.signal.aborted)return U(new o.DOMException("Aborted","AbortError"));var T=new XMLHttpRequest;function j(){T.abort()}T.onload=function(){var z={status:T.status,statusText:T.statusText,headers:H(T.getAllResponseHeaders()||"")};z.url="responseURL"in T?T.responseURL:z.headers.get("X-Request-URL");var Q="response"in T?T.response:T.responseText;F(new G(Q,z))},T.onerror=function(){U(new TypeError("Network request failed"))},T.ontimeout=function(){U(new TypeError("Network request failed"))},T.onabort=function(){U(new o.DOMException("Aborted","AbortError"))},T.open(C.method,C.url,!0),C.credentials==="include"?T.withCredentials=!0:C.credentials==="omit"&&(T.withCredentials=!1),"responseType"in T&&a.blob&&(T.responseType="blob"),C.headers.forEach(function(z,Q){T.setRequestHeader(Q,z)}),C.signal&&(C.signal.addEventListener("abort",j),T.onreadystatechange=function(){T.readyState===4&&C.signal.removeEventListener("abort",j)}),T.send(typeof C._bodyInit>"u"?null:C._bodyInit)})}return X.polyfill=!0,s.fetch||(s.fetch=X,s.Headers=w,s.Request=d,s.Response=G),o.Headers=w,o.Request=d,o.Response=G,o.fetch=X,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e})(as,as.exports);var kc=Du(as.exports);const Yc={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"},Jc=10;class Xc{constructor(e){if(this.url=e,this.events=new Zn.EventEmitter,this.isAvailable=!1,this.registering=!1,!za(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const n=jr(e),s=await(await kc(this.url,Object.assign(Object.assign({},Yc),{body:n}))).json();this.onPayload({data:s})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!za(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return i(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{const r=jr({id:1,jsonrpc:"2.0",method:"test",params:[]});await kc(e,Object.assign(Object.assign({},Yc),{body:r})),this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?hi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),i=n.message||n.toString(),s=wn(e,i);this.events.emit("payload",s)}parseError(e,r=this.url){return $a(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Jc&&this.events.setMaxListeners(Jc)}}function V_(t){var e;const r=(e=t[Object.keys(t)[0]])==null?void 0:e.chains[0];return[r.split(":")[0],r.split(":")[1]]}function Rn(t,e){let r;return e.rpcMap&&(r=e.rpcMap[G_([t])]),r}function G_(t){return Number(t[0].split(":")[1])}class W_{constructor(e){this.name="eip155",this.namespace=e.namespace,this.client=e.client,this.events=e.events,this.httpProviders=this.createHttpProviders(),this.chainId=this.getDefaultChainId()}async request(e){var r;switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":{const n=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";return this.setDefaultChain(parseInt(n,16).toString()),null}case"eth_chainId":return this.getDefaultChainId()}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){if(this.chainId=parseInt(e),!this.httpProviders[e]){const n=r||Rn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit("chainChanged",this.chainId)}createHttpProvider(e,r){const n=r||Rn(e,this.namespace);return typeof n>"u"?void 0:new Wi(new Xc(n))}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return parseInt(e.split(":")[1])}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}}class k_{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=e.events,this.client=e.client,this.chainId=this.getDefaultChainId(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getDefaultChainId(){if(this.chainId)return this.chainId;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||Rn(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit("chainChanged",this.chainId)}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||Rn(e,this.namespace);return typeof n>"u"?void 0:new Wi(new Xc(n))}}const Zc="error",Y_="wss://relay.walletconnect.com",J_="wc",X_="universal_provider",Qc=`${J_}@${2}:${X_}:`;var cs={exports:{}},mr=typeof Reflect=="object"?Reflect:null,eu=mr&&typeof mr.apply=="function"?mr.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},Cn;mr&&typeof mr.ownKeys=="function"?Cn=mr.ownKeys:Object.getOwnPropertySymbols?Cn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Cn=function(e){return Object.getOwnPropertyNames(e)};function Z_(t){console&&console.warn&&console.warn(t)}var tu=Number.isNaN||function(e){return e!==e};function Ae(){Ae.init.call(this)}cs.exports=Ae,cs.exports.once=rb,Ae.EventEmitter=Ae,Ae.prototype._events=void 0,Ae.prototype._eventsCount=0,Ae.prototype._maxListeners=void 0;var ru=10;function Nn(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ae,"defaultMaxListeners",{enumerable:!0,get:function(){return ru},set:function(t){if(typeof t!="number"||t<0||tu(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ru=t}}),Ae.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ae.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||tu(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function nu(t){return t._maxListeners===void 0?Ae.defaultMaxListeners:t._maxListeners}Ae.prototype.getMaxListeners=function(){return nu(this)},Ae.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var f=s[e];if(f===void 0)return!1;if(typeof f=="function")eu(f,this,r);else for(var h=f.length,l=cu(f,h),n=0;n<h;++n)eu(l[n],this,r);return!0};function iu(t,e,r,n){var i,s,o;if(Nn(r),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),s=t._events),o=s[e]),o===void 0)o=s[e]=r,++t._eventsCount;else if(typeof o=="function"?o=s[e]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=nu(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,Z_(a)}return t}Ae.prototype.addListener=function(e,r){return iu(this,e,r,!1)},Ae.prototype.on=Ae.prototype.addListener,Ae.prototype.prependListener=function(e,r){return iu(this,e,r,!0)};function Q_(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function su(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=Q_.bind(n);return i.listener=r,n.wrapFn=i,i}Ae.prototype.once=function(e,r){return Nn(r),this.on(e,su(this,e,r)),this},Ae.prototype.prependOnceListener=function(e,r){return Nn(r),this.prependListener(e,su(this,e,r)),this},Ae.prototype.removeListener=function(e,r){var n,i,s,o,a;if(Nn(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){a=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():eb(n,s),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this},Ae.prototype.off=Ae.prototype.removeListener,Ae.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function ou(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?tb(i):cu(i,i.length)}Ae.prototype.listeners=function(e){return ou(this,e,!0)},Ae.prototype.rawListeners=function(e){return ou(this,e,!1)},Ae.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):au.call(t,e)},Ae.prototype.listenerCount=au;function au(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Ae.prototype.eventNames=function(){return this._eventsCount>0?Cn(this._events):[]};function cu(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function eb(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function tb(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function rb(t,e){return new Promise(function(r,n){function i(o){t.removeListener(e,s),n(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}uu(t,e,s,{once:!0}),e!=="error"&&nb(t,i,{once:!0})})}function nb(t,e,r){typeof t.on=="function"&&uu(t,"error",e,r)}function uu(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){n.once&&t.removeEventListener(e,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var ib=Object.defineProperty,sb=Object.defineProperties,ob=Object.getOwnPropertyDescriptors,fu=Object.getOwnPropertySymbols,ab=Object.prototype.hasOwnProperty,cb=Object.prototype.propertyIsEnumerable,hu=(t,e,r)=>e in t?ib(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lu=(t,e)=>{for(var r in e||(e={}))ab.call(e,r)&&hu(t,r,e[r]);if(fu)for(var r of fu(e))cb.call(e,r)&&hu(t,r,e[r]);return t},ub=(t,e)=>sb(t,ob(e));class $n{constructor(e){this.events=new cs.exports,this.rpcProviders={},this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:Er(xe.getDefaultLoggerOptions({level:e?.logger||Zc}))}static async init(e){const r=new $n(e);return await r.initialize(),r}async request(e,r){var n;const[i,s]=this.validateChain(r);return await this.getProvider(i).request({request:lu({},e),chainId:`${i}:${s}`,topic:(n=this.session)==null?void 0:n.topic})}sendAsync(e,r,n){this.request(e,n).then(i=>r(null,i)).catch(i=>r(i,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return await this.request({method:"eth_requestAccounts",params:[]})}async disconnect(){if(!this.client)throw new Error("Sign Client not initialized");await this.client.disconnect({topic:this.session.topic,reason:Be("USER_DISCONNECTED")})}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");return this.setNamespaces(e.namespaces),this.createProviders(),await this.cleanupPendingPairings(),e.skipPairing===!0?void 0:await this.pair(e.pairingTopic)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces});return r&&(this.uri=r,this.events.emit("display_uri",r)),this.session=await n(),this.onSessionUpdate(),this.session}setDefaultChain(e,r){try{const[n,i]=this.validateChain(e);this.getProvider(n).setDefaultChain(i,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(){this.logger.info("Cleaning up inactive pairings...");const e=this.client.pairing.getAll({active:!1});!vr(e)||(await Promise.all([e.map(r=>this.client.pairing.delete(r.topic,Be("USER_DISCONNECTED"))),e.map(r=>this.client.core.relayer.unsubscribe(r.topic)),e.map(r=>this.client.core.expirer.del(r.topic))]),this.logger.info(`Inactive pairings cleared: ${e.length}`))}async checkStorage(){if(this.namespaces=await this.client.core.storage.getItem(`${Qc}/namespaces`)||{},this.namespaces&&this.createProviders(),this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.onSessionUpdate()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await os.init({logger:this.providerOpts.logger||Zc,relayUrl:this.providerOpts.relayUrl||Y_,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");Object.keys(this.namespaces).forEach(e=>{switch(e){case"eip155":this.rpcProviders[e]=new W_({client:this.client,namespace:this.namespaces[e],events:this.events});break;case"solana":this.rpcProviders[e]=new k_({client:this.client,namespace:this.namespaces[e],events:this.events});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var n;const{namespaces:i}=r,s=(n=this.client)==null?void 0:n.session.get(e);this.session=ub(lu({},s),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",()=>{this.events.emit("session_delete")})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>this.getProvider(e).updateNamespace(this.session.namespaces[e]))}setNamespaces(e){if(!e||!Object.keys(e).length)throw new Error("Namespaces must be not empty");this.client.core.storage.setItem(`${Qc}/namespaces`,e),this.namespaces=e}validateChain(e){const[r,n]=e?.split(":")||["",""];if(r&&!Object.keys(this.namespaces).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);return!r||!n?V_(this.namespaces):[r,n]}}const fb=$n;Yt.UniversalProvider=fb,Yt.default=$n,Object.defineProperty(Yt,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
